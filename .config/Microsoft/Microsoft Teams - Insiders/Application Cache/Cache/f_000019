(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[27],{"115d528efe62c6643bec":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("0b8514f932f40951d460"),n=i("cc08c169973ba8efeefa"),a=i("cdb9a7d2db44c7a9f4dd"),s=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createBundle=function(e){return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify({name:a.default.generate().toString(),children:e.map(function(e){return{id:e}}),bundle:{}})}).then(function(e){return e})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.createLink=function(e,t,i,r,n,a){var s=this;return 1===e.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(e[0]),type:t,scope:i,preventDownload:r,password:n,expiration:a}):this.createBundle(e).then(function(e){return s.createLinkSingleItem({itemUrl:s.getDrivesPathFromItemId(e.id),type:t,scope:i,preventDownload:r,password:n,expiration:a})})},e.prototype.createLinkFromItemUrl=function(e,t,i,r,n,a){return this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),type:t,scope:i,preventDownload:r,password:n,expiration:a})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.id})},e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(e){var t=""+this.getSharesPathFromItemUrl(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(e){var t=this.getSharesPathFromItemUrl(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.value})},e.prototype.invite=function(e,t,i,r,n,a,s,o){var d=this;return 1===e.length?this.inviteSingleItem(this.getDrivesPathFromItemId(e[0]),t,i,r,n,a,s,o,{prefer:"rich-error-as-message"}):this.createBundle(e).then(function(e){return d.inviteSingleItem(d.getDrivesPathFromItemId(e.id),t,i,r,n,a,s,o,{prefer:"rich-error-as-message"})})},e.prototype.inviteFromItemUrl=function(e,t,i,r,n,a,s,o){return this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,i,r,n,a,s,o,{prefer:"rich-error-as-message"})},e.prototype.getDefaultLink=function(e,t,i){var a={prefer:"getDefaultLink"};return n.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(a.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,"",!0,!1,[],"",void 0,a,i):this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),useMultiPart:i}).then(function(e){return r.default.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,i){var a={prefer:"getDefaultLink"};return n.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(a.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,a,i):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:i}).then(function(e){return r.default.wrap([e])})},e.prototype.updatePermissions=function(e,t,i){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,n={roles:[i]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n)}).then(function(e){return e.value})},e.prototype.updatePermissionsFromItemUrl=function(e,t,i){var r=this.getSharesPathFromItemUrl(e)+"/permissions/"+t,n={roles:[i]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n)}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var i=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:i,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(e,t){var i=this.getSharesPathFromItemUrl(e)+"/permissions/"+t;return this._dataRequestor.send({path:i,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,i=e.itemUrl,r=e.scope,n=e.preventDownload,a=e.password,s=e.useMultiPart,o=e.expiration,d=i+"/createLink",u=t&&r?{type:t,scope:r,preventDownload:n}:void 0;return(a||""===a)&&(u.password=a),o&&(u.expirationDateTime=o),this._dataRequestor.send({path:d,apiName:"createLink",requestType:"POST",useMultiPart:s,useAuthorizationHeaders:!0,postData:JSON.stringify(u||{})}).then(function(e){return e})},e.prototype.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=+$/,"").replace("/","_").replace("+","-")+"/driveItem"},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e},e.prototype.inviteSingleItem=function(e,t,i,r,n,a,s,o,d,u){var l=e+"/invite",c={recipients:t,message:i,requireSignIn:r,sendInvitation:n,roles:a};return s&&(c.password=s),o&&(c.expirationDateTime=o),this._dataRequestor.send({path:l,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(c),useMultiPart:u,headers:d}).then(function(e){return e.value})},e}();t.default=s},"13e40aa9f992db5e9396":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("f89d5af06abf23eb5d7d"),a=i("2231d4b2f5084c1aefe5"),s="eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984",o=function(e){function t(t){var n=this,o=t.userAuthToken,d=o&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(o),u=t.context,l=void 0===u?{}:u,c=t.clientName,p=t.correlationId,h=t.environment,m=void 0===h?t.ariaEnvironment||"prod":h,f=t.language,g=void 0===f?l.Market:f,v=t.scenario,_=void 0===v?"Unknown":v,I=t.version,y=void 0===I?"Unknown":I,b=t.ariaLoader,S=void 0===b?function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){return i("16e0e7de7c7a198c78cc")})];case 1:return[2,e.sent().aria]}})})}:b,w=d&&d.puid?"Business":"Unknown",k=d&&d.app_displayname||"Unknown",P=d&&d.appid||"Unknown",U=d&&d.puid||"Unknown",L=U?1:0,A=d&&d.tid||"Unknown";return n=e.call(this,{ariaLoader:S,context:r.__assign({AccountType:w,AppName:k,AppId:P,ClientName:c,CorrelationId:p,Environment:m,IsAuthenticated:L,Market:g,Scenario:_,Session:a.generate(),SiteSubscriptionId:A,UserId:U,Version:y,Workload:"SharedControls"},l),tenantToken:s})||this}return r.__extends(t,e),t}(n.AriaTelemetryHandler);t.SharedAriaTelemetryHandler=o},"1599ff704a3f1e0ee534":function(e,t,i){"use strict";var r,n,a,s,o,d,u;i.r(t),function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT"}(r||(r={})),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible"}(n||(n={})),function(e){e[e.Network=1]="Network",e[e.Embed=3]="Embed",e[e.App=4]="App",e[e.View=5]="View",e[e.Edit=6]="Edit",e[e.Form=7]="Form",e[e.Direct=8]="Direct",e[e.Organization=9]="Organization",e[e.AppAccess=10]="AppAccess"}(a||(a={})),function(e){e[e.Email=0]="Email",e[e.User=1]="User",e[e.Group=2]="Group",e[e.Link=3]="Link",e[e.Public=4]="Public",e[e.Friends=5]="Friends",e[e.Facebook=6]="Facebook",e[e.Application=7]="Application",e[e.GroupOwned=99]="GroupOwned"}(s||(s={})),function(e){e[e.Owner=0]="Owner",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Submitter=3]="Submitter",e[e.CoOwner=4]="CoOwner",e[e.None=5]="None",e[e.Review=6]="Review",e[e.Custom=7]="Custom"}(o||(o={})),function(e){e[e.none=1]="none",e[e.pending=2]="pending",e[e.hasAccess=3]="hasAccess"}(d||(d={})),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid"}(u||(u={}));var l,c,p=u;!function(e){e[e.authFailure=1]="authFailure",e[e.serverFailure=2]="serverFailure",e[e.invalidItem=3]="invalidItem",e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl",e[e.generic=5]="generic",e[e.objectNotSupported=6]="objectNotSupported",e[e.invalidEmail=7]="invalidEmail",e[e.linkNoLongerAvailable=8]="linkNoLongerAvailable"}(l||(l={})),function(e){e[e.getSharingInformation=1]="getSharingInformation",e[e.shareLink=2]="shareLink",e[e.shareObject=3]="shareObject",e[e.permissions=4]="permissions",e[e.item=5]="item",e[e.me=6]="me",e[e.drive=7]="drive",e[e.invite=8]="invite"}(c||(c={}));var h,m=l;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(h||(h={}));var f,g=h;!function(e){e[e.view=1]="view",e[e.edit=2]="edit"}(f||(f={}));var v,_=f;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(v||(v={}));var I,y,b=v;!function(e){e[e.anyone=0]="anyone",e[e.organization=1]="organization",e[e.specificPeople=2]="specificPeople"}(I||(I={})),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview"}(y||(y={})),i.d(t,"UpdatePermissionsRole",function(){return r}),i.d(t,"SharingLinkKind",function(){return n}),i.d(t,"SharingLinkType",function(){return a}),i.d(t,"SharingInfoType",function(){return s}),i.d(t,"SharingRole",function(){return o}),i.d(t,"AccessStatus",function(){return d}),i.d(t,"ClientId",function(){return p}),i.d(t,"Error",function(){return m}),i.d(t,"Category",function(){return c}),i.d(t,"Mode",function(){return g}),i.d(t,"SharePermission",function(){return _}),i.d(t,"SharingAudience",function(){return b}),i.d(t,"SharingAudienceTemplates",function(){return I}),i.d(t,"SharingRoleV3",function(){return y})},"16e0e7de7c7a198c78cc":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aria=i("5f18827c166f02fc8d18")},"1e9e213928ed89bcb429":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("115d528efe62c6643bec"),a=i("60e0518b24b76347603c"),s=i("0b8514f932f40951d460"),o=i("c1a09d7dd35e11297e15"),d=i("1599ff704a3f1e0ee534"),u=i("e64bb55c7377947459c9"),l=i("bf1fd7836373b186b583"),c=i("9a07fb223dfaa81a8d0c"),p=i("16f7a8beee83cf78aabb"),h=i("8605abf9448f5c554409"),m=i("c1d76209a7f2fe28e159"),f=i("a24d70c7702f13f024d9"),g=i("6f8ae5b6dc470397fb69"),v=function(){function e(e){if(this._iframe=document.createElement("iframe"),this._signal=new o.default,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._manager=p.createManager(),this._sessionQos=new(g.Qos.withManager(this._manager))({name:"SharingSession."+d.Mode[e.context.mode||d.Mode.share]}),!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");switch(new c.WebSharedAriaTelemetryHandler({clientName:this._context.clientId,userAuthToken:this._context.authToken}).attach(this._manager),e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}this._iframeUrl||(this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale),this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe)}return e.prototype.initializeUI=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,i,n,a=this;return r.__generator(this,function(o){return e=this._context.mode===d.Mode.copy&&"teams"===this._context.clientId&&!this._context.shareId,t=e?this._getDefaultLink():Promise.resolve(void 0),i=this._getSharingInformation(),this._isShareReady=!1,Promise.all([this._toTuple(t),this._toTuple(this._getSharingInformation()),this._toTuple(this._signal.getPromise())]).then(function(e){var t=e[0],i=e[1];e[2];try{var n=!1,o=a._props.options.onError;if(a._isError(t)&&(n=!0,o&&o({name:"SharePrefetchError",message:"",error:t.error,resultCode:s.default.isCanceled(t.error)?"Canceled":f.getResultCodeFromError(t.error)})),a._isError(i)){n=!0;var d=i.error,u={code:d.code,status:d.status};o&&o({name:"SharePrefetchError",message:"",error:d,resultCode:s.default.isCanceled(i.error)?"Canceled":"["+u.status.toString()+"] "+(u.code||"Unknown")})}var l=r.__assign({},a._context,{rawInvite:t.value,sharingInformation:i.value}),c=a._iframe.contentWindow;c?c.postMessage(l,a._iframeUrl):n||a._sessionQos.end({resultType:g.ResultTypeEnum.Failure,extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:a._elementWindow.document.body.contains(a._iframe),messagesReceived:Object.keys(a._messagesReceived).join(","),mode:a._context.mode}})}catch(e){a._sessionQos.end({resultType:g.ResultTypeEnum.Failure,extraData:{unhandledError:e.toString()}})}}),this._props.disableIframeDomainCheck||setTimeout(function(){if(!a._scriptsLoadedTime){var e=new Image;e.onerror=function(){var e="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),t=a._props.options&&a._props.options.onError;t&&t({name:"SharePrefetchError",message:e,error:new Error(e),debugErrorMessage:"Unable to reach "+a._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:e}),a._sessionQos.end({resultType:g.ResultTypeEnum.ExpectedFailure,resultCode:e,extraData:{mode:a._context.mode,iframeBaseUrl:a._iframeBaseUrl}}),clearTimeout(a._timeoutId)},e.src=a._iframeUrl+"/favicon.ico?"+Math.random()}},8e3),n=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return r.__awaiter(a,void 0,void 0,function(){var e,a,s,o,d,u,l,c,p,h;return r.__generator(this,function(r){switch(r.label){case 0:a=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i];case 2:return s=r.sent(),a=s&&!!s,[3,4];case 3:return o=r.sent(),e=o,[3,4];case 4:u=!1,r.label=5;case 5:return r.trys.push([5,7,,8]),[4,t];case 6:return l=r.sent(),u=!(!l||!l),[3,8];case 7:return c=r.sent(),d=c,[3,8];case 8:return p={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:a,getSharingError:e,inviteHasData:u,inviteError:d,timeout:n,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime},this._showShareUX(),(h=this._props.options&&this._props.options.onTimeout)&&h(),this._sessionQos.end({resultType:g.ResultTypeEnum.Failure,resultCode:"timeout",extraData:p}),[2]}})})},n),[2]})})},e.prototype.dispose=function(){this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:g.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,i,o=this;return r.__generator(this,function(r){switch(r.label){case 0:return e=new a.default({},{urlDataSource:{getApiBaseUrl:function(){return o._context.webAbsoluteUrl+"/_api/v2.0"}},sessionManagementProvider:{getToken:function(){return s.default.resolve({accessToken:o._context.authToken})}},apiEvent:h.Api.withManager(this._manager)}),t=new n.default({},{dataRequestor:e}),i=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(i=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",i,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",i,!this._props.disableUseMultiPart)];case 1:return[2,{value:r.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._manager,i=new u.SharingDataSource({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(i){function n(r){return i.call(this,r,{pageContext:e,apiEvent:h.Api.withManager(t)})||this}return r.__extends(n,i),n}(m.DataRequestor)}),n=new l.SharingProvider({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:i}),a=this._context.mode===d.Mode.copy||this._context.mode===d.Mode.linkSettings;return n.getSharingInformation({key:"",name:this._context.itemName,properties:{}},a)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},this._iframe.src=this._iframeUrl,this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0",t&&(t.margin&&(this._iframe.style.margin=t.margin),t.minWidth&&(this._iframe.style.minWidth=t.minWidth),t.minHeight&&(this._iframe.style.minHeight=t.minHeight))},e.prototype._showShareUX=function(){this._isShareReady=!0,this._iframe.style.visibility="visible",this._iframe.style.height=(this._iframeHeight||400)+"px",this._iframe.style.width=(this._iframeWidth||320)+"px",clearTimeout(this._timeoutId)},e.prototype._receiveMessage=function(e){var t;try{t=e&&e.data&&JSON.parse(e.data)}catch(e){return}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,void this.dispose()}catch(e){}var i=t.name;switch(this._messagesReceived[i||""]=!0,i){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date,this._signal.complete();break;case"share_resize":var r=this._props.options&&this._props.options.onResize;r&&t.width&&t.height&&r(t.width,t.height),this._iframeWidth=t.width||320,this._iframeHeight=t.height||400,this._isShareReady&&(this._iframe.style.height=this._iframeHeight+"px",this._iframe.style.width=this._iframeWidth+"px");break;case"share_started":var n=this._props.options&&this._props.options.onStarted;n&&n();break;case"share_ready":this._showShareUX();var a={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId};this._sessionQos.end({resultType:g.ResultTypeEnum.Success,extraData:a});var s=this._props.options&&this._props.options.onReady;s&&s();break;case"share_error":this._showShareUX();var o=this._props.options&&this._props.options.onError,d=JSON.parse(t.debugErrorMessage||"{}"),u=d.code||d.status||"ShareError: ["+t.error+"]";this._sessionQos.end({resultType:g.ResultTypeEnum.Failure,resultCode:u}),o&&o({name:"SharePrefetchError",message:t.errorMessage||"",error:t.error,debugErrorMessage:t.debugErrorMessage,errorMessage:t.errorMessage,resultCode:u});case"share_completed":var l=this._props.options&&this._props.options.onCompleted;l&&l({scope:t.scope||""});break;case"share_dismiss":var c=this._props.options&&this._props.options.onDismiss;c&&c();break;case"share_manageAccessClicked":var p=this._props.options&&this._props.options.openManageAccess;p&&p();case"share_linkSettingsCompleted":var h=this._props.options&&this._props.options.onLinkSettingsComplete;h&&h(t)}},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=i.sent(),t)];case 2:return[2,{error:i.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}();t.SharePrefetch=v},"969a82330cafca70aa6d":function(e,t,i){"use strict";var r;i.d(t,"a",function(){return r}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter"}(r||(r={})),t.b=r},"9a07fb223dfaa81a8d0c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("13e40aa9f992db5e9396"),a=i("a918e6b023e78a8f38a9"),s=function(e){function t(t){var i=new a.PlatformDetection,n=t.context,s=void 0===n?{}:n;return e.call(this,r.__assign({language:window.navigator.language},t,{context:r.__assign({BrowserIsMobile:i.isMobile,BrowserMajVer:i.browserMajor,BrowserMinVer:i.browserMinor,BrowserName:i.browserName,BrowserUserAgent:i.userAgent,OSName:i.osName,OSVersion:i.osVersion},s)}))||this}return r.__extends(t,e),t}(n.SharedAriaTelemetryHandler);t.WebSharedAriaTelemetryHandler=s},b5863f12cdaa92efebfb:function(e,t,i){"use strict";var r=i("969a82330cafca70aa6d");i.d(t,"a",function(){return r.b})},bf1fd7836373b186b583:function(e,t,i){"use strict";i.r(t),i.d(t,"SharingProvider",function(){return n});var r=i("e64bb55c7377947459c9"),n=function(){function e(e){this._dataSource=e.sharingDataSource||new r.SharingDataSource({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,i,r){return this._dataSource.getSharingInformation(e,t,i,r)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(i){return t._invalidateItem(e.items[0]),i})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(i){return t._invalidateItem(e.item),i})},e.prototype.updatePermissions2=function(e,t,i){var r=this;return this._dataSource.updatePermissions2(e,t,i).then(function(e){return r._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,i,r,n){var a=this;return this._dataSource.updatePermissionsMultiple(e,t,i,r,n).then(function(e){return a._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,i,r){return this._dataSource.emailWithoutPermissioning(e,t,i,r).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,i){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}()},e64bb55c7377947459c9:function(e,t,i){"use strict";i.r(t);var r=i("64328bb588b46459132d"),n=i("dc89aa5278a9a06d2126"),a=i("1d2727e1b6137177eca9"),s=i("ed82754416f168d14460"),o=i("5e729a564cfb43974b42"),d=i("c2801f66d553d6a165e0"),u=i("cfd15bb212a873934c4b"),l=i("1599ff704a3f1e0ee534"),c=i("5c1e3c3a333c0e96782a"),p=i("f698cfbaff8a2434ab85"),h=i("6e62786e04351f279fc3"),m=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,i){if(this._sharingContextInformation){if(this._sharingContextInformation.uniqueId){var r=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",n={guid:this._sharingContextInformation.uniqueId};return e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(r,n).segment("ListItemAllFields")}return this._sharingContextInformation.listUrl?e.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",h.b(this._sharingContextInformation.itemUrl)).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId)}var a;a=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var s=e.build().webByItemUrl(a).method("Lists",i);return s=t.properties.ID?s.method("GetItemById",t.properties.ID):s.method("GetItemByUniqueId",t.properties.uniqueId)},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId)},e}(),f=i("b5863f12cdaa92efebfb");i.d(t,"EDIT_ROLE",function(){return g}),i.d(t,"VIEW_ROLE",function(){return v}),i.d(t,"UseShareLinkTemplates",function(){return _}),i.d(t,"SharingDataSource",function(){return I}),i.d(t,"parseSharingLinkInfo",function(){return y});var g="role:1073741827",v="role:1073741826",_={ODB:1205},I=function(e){function t(t,i){void 0===i&&(i={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},i)||this;r._getParentListId=t.getParentListId,r._itemUrlHelper=t.itemUrlHelper||new a.a({},{pageContext:t.pageContext}),r._apiUrlHelper=t.apiUrlHelper||new o.a({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper}),r._sharingContextInformation=t.sharingContextInformation||void 0,r._sharingDataSourceHelper=new m({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var n=Object(c.a)(r._pageContext);return r._shareUrl=n+"/_api/SP.Web.ShareObject",r}return r.__extends(t,e),t.parsePeople=function(e){return e.map(function(e){var i={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:i}})},t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}},t.prototype.getSharingInformation=function(e,t,i,r){var n,a=this,s=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation");if(u.a.isFeatureEnabled(_)){var o="pickerSettings";t&&(o+=",permissionsInformation"),i&&(o+=",sharingLinkTemplates"),n=s.oDataParameter("$Expand",o).toString()}else n=t?s.oDataParameter("$Expand","permissionsInformation,pickerSettings").toString():s.oDataParameter("$Expand","pickerSettings").toString();return this.getData(function(){return n},function(t){var i=JSON.parse(t);return a._parseGetSharingInformationResponse(i,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData())},t.prototype.emailWithoutPermissioning=function(e,i,r,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,i,this._getParentListId(i)).segment("ForwardObjectLink").toString();return this.getData(function(){return a},function(e){var r=JSON.parse(e).d,n=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(n=r.UniquelyPermissionedUsers.results);var a=[];r.InvitedUsers&&r.InvitedUsers.results&&(a=r.InvitedUsers.results);var s={};if(s.statusCode=r.StatusCode,s.errorMessage=r.ErrorMessage,s.people=t.parsePeople(n),s.invitedUsers=t.parsePeople(a),s.itemId=i&&i.id,a.length>0&&(s.invitationLink=a[0].InvitationLink),s.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var o=0,d=r.UsersWithInvalidEmails.results;o<d.length;o++){var u=d[o];s.invalidEmails.push(u.User)}return s},"ForwardObjectLink",function(){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(s.rawPersonData)}var o={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:n};return JSON.stringify(o)})},t.prototype.checkPermissions=function(e,t){var i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,i){var r,n=this,a=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(i.items[0]);if(9===i.linkType||6===i.linkType||5===i.linkType)return this._shareLink(e,i);if(a){var s=i.items[0],o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));r=o.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,n=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(n=r.UniquelyPermissionedUsers.results);var a=[];r.InvitedUsers&&r.InvitedUsers.results&&(a=r.InvitedUsers.results);var s={};if(s.statusCode=r.StatusCode,s.errorMessage=r.ErrorMessage,s.people=t.parsePeople(n),s.invitedUsers=t.parsePeople(a),s.itemId=i.items[0]&&i.items[0].id,a.length>0&&(s.invitationLink=a[0].InvitationLink),s.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var o=0,d=r.UsersWithInvalidEmails.results;o<d.length;o++){var u=d[o];s.invalidEmails.push(u.User)}return s},"Share",function(){for(var t=[],r=0;r<e.length;r++){var s=e[r];t.push(s.rawPersonData)}i.roleValue===2..toString()?i.roleValue=g:i.roleValue===1..toString()&&(i.roleValue=v);var o={peoplePickerInput:JSON.stringify(t),roleValue:i.roleValue,sendEmail:i.sendEmail,emailBody:i.message,emailSubject:i.subject,includeAnonymousLinkInEmail:!i.requireSignIn,propagateAcl:i.propagateSharing,useSimplifiedRoles:!0};return a||(o.url=n._sharingDataSourceHelper.getFileUrl(i.items[0])),JSON.stringify(o)})},t.prototype.updatePermissions2=function(e,t,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(i){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.updatePermissionsMultiple=function(e,t,i,r,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(i){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var a={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:n,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=e.settings,i=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(i)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?y(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var i=null;t.expiration&&(i=Object(n.convertDateToISOString)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var a=0,s=e.recipients;a<s.length;a++){var o=s[a];o.rawPersonData&&r.push(o.rawPersonData)}}var d=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){d=[];for(var u=0,l=t.inviteesToRemove;u<l.length;u++){var c=l[u];d.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var p={request:{createLink:!0,settings:{allowAnonymousAccess:t.allowAnonymousAccess,linkKind:t.sharingLinkKind,expiration:i,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId}}};if(d&&(p.request.settings.inviteesToRemove={results:d}),r&&r.length>0){p.request.peoplePickerInput=JSON.stringify(r);var h=e.emailData,m=e.emailSubject;void 0!==h&&void 0===m&&(p.request.emailData={body:e.emailData,subject:""}),void 0===h&&void 0!==m&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==h&&void 0!==m&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var f=e.settings.shareId;return f&&(p.request.settings.shareId=f,p.request.emailData={body:""}),JSON.stringify(p)},"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.getClientId=function(){switch(Number(this._pageContext.webTemplate)){case f.a.teamSite:case f.a.group:case f.a.subgroup:case f.a.sitePagePublishing:return l.ClientId.sharePoint;case f.a.mySite:return l.ClientId.odb;default:return l.ClientId.unknown}},t.prototype._shareLink=function(e,t){var i=this,r=t.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return a},function(i){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],a=0,s=e;a<s.length;a++){var o=s[a];r.push(o.rawPersonData)}var d=null;t.expiration&&(d=Object(n.convertDateToISOString)(t.expiration));var u={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:i._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:d}};return JSON.stringify(u)})},t.prototype._getSharingLinkKind=function(e,t){var i=1;return 6===e?i=5:5===e?i=4:9===e&&(i=t===2..toString()?3:2),i},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var i=e.d,r=!!i.permissionsInformation,n=!!i.sharingLinkTemplates,a=r?this._parseSharingLinks(i.permissionsInformation.links.results,i.directUrl):[],s=n?this._parseSharingLinkTemplates(i.sharingLinkTemplates.templates.results):[],o=r?i.permissionsInformation.siteAdmins.results.concat(i.permissionsInformation.principals.results):[],d=this._parseSharingPrincipals(o),u=this._getDefaultSharingLink(i.defaultLinkKind,a,i.sharingAbilities),c={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0};if(t){var h=t.properties,m=h.ItemChildCount?parseInt(h.ItemChildCount,10):0,f=h.FolderChildCount?parseInt(h.FolderChildCount,10):0,g=t.type===p.a.OneNote?0:m+f,v=this._isPolicyTipFlagSet(t.policyTip,4);c={name:t.name,childCount:g,hasDlpPolicy:v,appmap:t.appMap}}var _=i.canRequestAccessForGrantAccess||i.canAddInternalPrincipal||a.length>1;return{anonymousLinkExpirationRestrictionDays:0===i.anonymousLinkExpirationRestrictionDays?-1:i.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:i.canAddExternalPrincipal,canAddInternalPrincipal:i.canAddInternalPrincipal,canManagePermissions:_,defaultSharingLink:u,isShared:this._computeIsShared(a,d),item:c,sharingLinks:a,sharingPrincipals:d,peoplePickerSettings:i.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:i.blockPeoplePickerAndSharing,requiresAccessApproval:!i.canAddInternalPrincipal&&i.canRequestAccessForGrantAccess,userRole:i.currentRole,defaultShareLinkPermission:i.defaultShareLinkPermission,sharingAbilities:i.sharingAbilities,defaultLinkKind:i.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:l.SharingAudience.existing,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:i.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!i.permissionsInformation,sharingLinkTemplates:s,webTemplateId:i.webTemplateId,itemUniqueId:i.itemUniqueId,customizedExternalSharingServiceUrl:i.customizedExternalSharingServiceUrl||""}},t.prototype._computeIsShared=function(e,t){for(var i=!1,r=0,n=e;r<n.length;r++){var a=n[r];a.isActive&&1!==a.sharingLinkKind&&(i=!0)}return i||(i=t.length>0),i},t.prototype._parseSharingLinks=function(e,t){var i=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,hasPassword:t.RequiresPassword,blockDownload:t.BlocksDownload,audience:b(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:S(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:i._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:i._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:i._parseSharingPrincipal(t.PasswordLastModifiedBy),isCreateOnlyLink:t.IsCreateOnlyLink}});return r.push({allowsAnonymousAccess:!1,audience:l.SharingAudience.specificPeople,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),r},t.prototype._parseSharingLinkTemplates=function(e){var t=this;return e.map(function(e){var i,r=e.linkDetails;return null!==r&&(i={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:b(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:S(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}),{linkDetails:i,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}})},t.prototype._parseLinkInvitees=function(e){var t=this,i=e.Invitations;if(!i)return[];for(var r=[],n=0,a=i.results;n<a.length;n++){var s=a[n];s&&s.invitee&&r.push(s.invitee)}return r.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._getImageUrl(e.email)}})},t.prototype._parseSharingPrincipals=function(e,t){var i=this;return e.map(function(e){var r=e.principal;r||(r=e);var n={id:r.id,isExternal:r.isExternal,loginName:r.loginName,primaryText:r.name,role:e.role,secondaryText:r.jobTitle,type:r.principalType,imageUrl:i._getImageUrl(r.email),email:r.email};return t&&(n.sharingLinkKind=t),n})},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:l.Mode[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;return t||(t=e),{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._getImageUrl(t.email),email:t.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,i){(i.peopleSharingLinkAbilities.canManageEditLink.enabled||i.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;return 5!==r||i.anonymousLinkAbilities.canManageEditLink.enabled||(r=4),4!==r||i.anonymousLinkAbilities.canManageReadLink.enabled||(r=3),3!==r||i.organizationLinkAbilities.canManageEditLink.enabled||(r=2),2!==r||i.organizationLinkAbilities.canManageReadLink.enabled||(r=1),{allowsAnonymousAccess:void 0,audience:void 0,expiration:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._getImageUrl=function(e){if(e&&this._sharingContextInformation){var t=this._sharingContextInformation&&this._sharingContextInformation.clientId;return"word"===t||"powerpoint"===t||"excel"===t?null:e&&this._sharingContextInformation?this._sharingContextInformation.webAbsoluteUrl+Object(s.a)({userLoginName:e}):null}return e&&this._pageContext?Object(c.a)(this._pageContext)+Object(s.a)({userLoginName:e}):null},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(d.a);function y(e){if(e.d){var t=e.d.ShareLink.sharingLinkInfo,i=t.Expiration?new Date(t.Expiration):void 0;return{link:{allowsAnonymousAccess:t.AllowsAnonymousAccess,audience:b(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:i,isActive:t.IsActive,isEdit:S(t.LinkKind)||t.IsEditLink,principals:null,invitees:null,shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:t.PasswordLastModifiedBy}}}}function b(e,t,i){return 5===e||4===e?l.SharingAudience.anyone:3===e||2===e?l.SharingAudience.organization:1===e?l.SharingAudience.specificPeople:6===e?t?l.SharingAudience.anyone:!1===i?l.SharingAudience.organization:l.SharingAudience.specificPeopleFlex:void 0}function S(e){return 5===e||3===e||4!==e&&2!==e&&null}}}]);