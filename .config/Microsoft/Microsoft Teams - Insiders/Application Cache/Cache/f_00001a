(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[22],{"390bac1530ab6cf4e614":function(e,t,r){"use strict";var a=r("64328bb588b46459132d"),i=r("65da65eb66805e3724ff"),n=r("5e76ddf6bb30811ee697"),l=r("fcf654cc44d7ec457fe0"),o=r("5f37f5ec04a007134c18"),s=r("1adfad17f632aad72441"),c=r("680b7ac74280293b48f0"),u=r("4e318b84c4772f9f58b9"),d=r("5fef64b3561abb2ebffa"),b=r("d27387ede93a2620cbf6"),f=r("fdbcb7664c17b5b4e4d9"),m=r("2852e19dad7ee30e33c6"),p=r("9ba97cc998d0be4df04a"),v=r("ee92087a6ec1d0e9ecc9"),h=r("1bdba4333337067e8d37"),g=r("90e9dbb8f74ee9c49c51"),U=r("6578506114fc52cc91d3"),w=r("a3886a89b418632a97c5"),y=r("6631b0451e9f577f414d"),F=r("578e5017557fc66bb247"),_=r("6d69c5cabadd78126515"),I=r("a4060cda3c9c24220a4a"),O=r("022addba5cf25ce091fb"),A=r("809072ae40093b380229"),S=Object(O.d)({operationTypeFacet:A.a}),C=r("5004fc2f3329649ad54d"),j=r("eef09ec91afb2fd77b66");r.d(t,"c",function(){return T}),r.d(t,"b",function(){return N}),r.d(t,"a",function(){return x});var k={ODB:1561},T=Object(c.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,o=e.options,c=o.documentType,O=o.fileName,A=o.newDocumentKey,T=o.templateItemKey,K=o.targetWindow;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,o,R,P,L,E,z,q,V,M,B,G,H,W,J,Q,X,Z,$;return a.__generator(this,function(Y){switch(Y.label){case 0:return o=I.C.deserialize(r),R=o.rootFolder||new l.SimpleUri(o.listFullUrl).path,P=new n.a({context:{webAbsoluteUrl:o.webAbsoluteUrl,listUrl:o.listFullUrl}}),L=P.getUrlParts({path:R}),E=new y.default(null),z=e(Object(F.a)({createDocumentFormDigest:v.zb},_.configurationItemKey)).createDocumentFormDigest,q=void 0,(V=e(Object(F.a)({pageContext:v.Nb},I.T.serialize({webAbsoluteUrl:o.webAbsoluteUrl}))))&&V.pageContext&&(q=V.pageContext),M=new l.SimpleUri(o.webAbsoluteUrl).authority,B=new l.SimpleUri(q&&q.webAbsoluteUrl).authority,G=M!==B,T||!z||G||c!==s.a.Word&&c!==s.a.PowerPoint&&c!==s.a.Bohemia&&c!==s.a.Prague?[3,5]:("_layouts/15",H=c===s.a.Prague?"prague":"doc",W=o.webAbsoluteUrl+"/_layouts/15/"+H+".aspx",e(Object(j.a)(function(e){return Object(C.a)(e,{feature:k})}))?(J=e(Object(F.a)({folderUniqueId:v.Tb},r)).folderUniqueId,[4,w.createDocumentByDocAspxWithItemUrlParts(c,W,o.webAbsoluteUrl,E,K,O,L,void 0,J)]):[3,2]);case 1:return Y.sent(),[3,4];case 2:return[4,w.createDocumentByDocAspxWithItemUrlParts(c,W,o.webAbsoluteUrl,E,K,O,L)];case 3:Y.sent(),Y.label=4;case 4:return e(Object(b.b)({items:(t={},t[r]=[f.b],t)})),[3,7];case 5:return Q="",I.N.matches(T)&&((Z=e(Object(F.a)({documentTemplate:v.ib},T)).documentTemplate)&&Z.url?(X=Z,Q=Z.url):Q=I.N.deserialize(T).templateUrl),$=x({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl,parentFolderPath:L.listRelativeItemUrl||"",docType:c,docName:O,templateUrl:Q}),[4,e(Object(i.c)({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl,url:$,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0})).then(function(t){var n,l,w=N({responseText:t,documentType:c,fileName:O}),y=w.redirectUrl,F=w.originalEditLink;if(F){var _=p.a(p.b(F.toLowerCase())),C=_.sourcedoc,j=C&&Object(h.normalizeLower)(C),k=Object(g.getDocExtension)(c),T=X;if(T&&T.url){var x=function(e){var t=e.listFullUrl,r=e.uniqueId,a=e.webAbsoluteUrl;return Object(U.getListApiUrl)({webAbsoluteUrl:a,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:r}).toString()}({listFullUrl:o.listFullUrl,webAbsoluteUrl:o.webAbsoluteUrl,uniqueId:j});e(Object(i.c)({listFullUrl:o.listFullUrl,webAbsoluteUrl:o.webAbsoluteUrl,url:x,method:"POST",parseResponse:D,qosName:"getItemByUniqueId",noRedirect:!0})).then(function(t){var r;t&&e(S({items:(r={},r[I.C.serialize({itemId:t,listFullUrl:o.listFullUrl,webAbsoluteUrl:o.webAbsoluteUrl})]={formValues:[{FieldName:"ContentTypeId",FieldValue:T.contentTypeId||""}],qosName:"updateTemplateDocContentType"},r)}))})}e(Object(u.a)({items:(n={},n[A]=a.__assign({},y?d.openUrlFacet.pack(y):{},d.fileNameFacet.pack({name:O||"",extension:k}),j?v.Tb.pack(j):{},m.b.pack(c===s.a.OneNote?{}:void 0),f.e.pack({itemKey:r})),n)}))}e(Object(b.b)({items:(l={},l[r]=[f.b],l)}))})];case 6:Y.sent(),Y.label=7;case 7:return[2]}})})}});function N(e){var t=e.responseText,r=e.documentType,a=e.fileName,i="",n="";if(null!=t){var l=JSON.parse(t);if(null!==l&&null!==l.d&&null!==l.d.CreateDocumentAndGetEditLink)n=l.d.CreateDocumentAndGetEditLink,i=Object(o.b)(n,r,a||"",!1);else try{n=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"",i=Object(o.b)(n,r,a||"",!1)}catch(e){}}return{originalEditLink:n,redirectUrl:i}}function x(e){var t=s.a.Visio,r=e.webAbsoluteUrl,a=e.listFullUrl,i=e.parentFolderPath,n=e.templateUrl,l=e.docName,o=e.docType;if(null!==o&&o>=s.a.Word&&o<=t&&o!==s.a.Text){if(o!==s.a.OneNote||l){if(l){l+=Object(g.getDocExtension)(o)}}else l="Notebook"+Math.floor(100*Math.random())+1;return l||(l=""),o===s.a.ExcelForm&&(o=s.a.ExcelSurvey),Object(U.getListApiUrl)({webAbsoluteUrl:r,listFullUrl:a}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:l,folderPath:i,documentTemplateType:o,templateUrl:n||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}function D(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}},"3d92c7f3fb145bfb9378":function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("0b8514f932f40951d460"),i=r("e9d155a6651c0bf6c9b0");function n(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var r=o(e);try{return JSON.parse(r),!0}catch(e){return!1}}return!1}function l(e,t){var r=o(e);try{var n=JSON.parse(r);return function(e){var t=e.pageContext,r=e.appInstanceId,a=e.appOAuthId,n=e.launchUrl,l=e.isTenantApp,o=i.default.escapeUrlForCallback(t.webAbsoluteUrl),s=i.default.escapeUrlForCallback(t.layoutsUrl),c=o+"/"+s+"/appredirect.aspx";if(a&&n)c+="?client_id="+i.default.encodeURIComponent(a)+"&redirect_uri="+i.default.encodeURIComponent(n);else{if(!r)throw"appOAuthId, launchUrl, appInstanceId are null";c+="?instance_id="+i.default.encodeURIComponent(r)}l&&(c+="&tsapp=1");window.location.href=c}({pageContext:t,appInstanceId:n[0],appOAuthId:n[1],launchUrl:n[2],isTenantApp:n[4]}),a.default.wrap()}catch(e){return a.default.wrapError(e)}}function o(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},"5730cedeedcb5640bb56":function(e,t,r){"use strict";var a,i,n=r("64328bb588b46459132d");!function(e){e[e.ContextMenu=0]="ContextMenu",e[e.RibbonDocuments=1]="RibbonDocuments",e[e.RibbonList=2]="RibbonList"}(a||(a={})),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(i||(i={}));var l={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},o=r("0565c735921892f98831"),s=r("c4e199bc4bcd0fb7cb54"),c=r("3d92c7f3fb145bfb9378"),u=r("00620f24248a4f158ff6"),d=r("cdb9a7d2db44c7a9f4dd"),b=r("0a3e1b609e40999fd831"),f=r("e9d155a6651c0bf6c9b0");function m(e,t){var r=[],a=[],o=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var c=new DOMParser,f=function(e){var f=e.Location,m=e.RegistrationType;if(f&&0===f.lastIndexOf(l.CommandSet,0)){if(!m||m!==i.List)return"continue";var p=f===l.CommandSet,v=f===l.ContextMenu||p,h=f===l.CommandBar||p,F={text:e.Title,isEnabled:function(){return I({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};v&&o.push(F),h&&(Object(u.isDocumentLibrary)(t.listTemplate)?r.push(n.__assign({},F)):a.push(n.__assign({},F)))}else{if(!g(e.UrlAction))return"continue";if(e.CommandUIExtension&&b.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var O=U(e,t,!0),A=U(e,t,!1),S=void 0;try{S=c.parseFromString(e.CommandUIExtension,s.b.doctype)}catch(e){}if(!S)return"continue";var C=S.getElementsByTagName("Tab");if(C&&0!==C.length||(C=S.getElementsByTagName("Group")),C&&C.length>0){var j=w(C,!0),k=w(C,!1),T={};if(j||k)for(var N=0,x=S.getElementsByTagName("CommandUIHandlers");N<x.length;N++)for(var D=x[N].firstElementChild;D;)T[D.getAttribute("Command")]=D.getAttribute("CommandAction"),D=D.nextElementSibling;if(j){var K=y(j,T,e,O);r.push(K)}if(k){K=y(k,T,e,A);a.push(K)}}else{var R=S.getElementsByTagName("Button"),P=_(R,!0,e,O);P&&r.push(P);var L=_(R,!1,e,A);L&&a.push(L)}}else if("EditControlBlock"===e.Location&&e.Title){var E={text:e.Title,isEnabled:U(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""};o.push(E)}}},m=0,p=e;m<p.length;m++){f(p[m])}return{"Ribbon.Documents":r,"Ribbon.List":a,ContextMenu:o}}function p(e,t){var r=[];return e.forEach(function(e,a){var n={registrationId:e.registrationId,registrationType:i[e.registrationType],requireSiteAdministrator:!1,rights:{High:Number(e.rightsHigh),Low:Number(e.rightsLow)}};g(e.action)&&r.push({text:e.title,iconUrl:e.imageUrl,isEnabled:I(n,t),action:e.action})}),r}function v(e){return"children"in e}function h(e,t,r){var a=r.webAbsoluteUrl+"/",i=r.layoutsUrl+"/",n=""+a+i,l=r.siteAbsoluteUrl+"/",o=""+l+i,s="",c=r.listId,u=r.listUrl;if(0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(c=c.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D")),s=e.replace(/{SiteUrl}/g,a).replace(/~site\//g,a).replace(/~layouts\//g,i).replace(/~siteLayouts\//g,n).replace(/~siteCollection\//g,l).replace(/~siteCollectionLayouts\//g,o).replace(/{ListId}/g,c).replace(/{SelectedListId}/g,c).replace(/{ListUrlDir}/g,u).replace(/{Source}/g,f.default.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true"),t.length>0){var d=t.map(function(e){return e.id}).join(","),b=t[0].id,m=t[0].url;s=s.replace(/{ItemUrl}/g,f.default.encodeURIComponent(m)).replace(/{ItemId}/g,b).replace(/{SelectedItemId}/g,d)}else s=s.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return s}function g(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||Object(c.b)(e,!1))}function U(e,t,r){var a=void 0===r||r===Object(u.isDocumentLibrary)(t.listTemplate);if(e.CommandUIExtension&&e.EnabledScript)return a||!0;var i=I({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!i&&("function"==typeof i?"function"==typeof a?function(e){return i(e)&&a}:i:a)}function w(e,t){for(var r=0,a=e.length;r<a;r++){var i=e[r],n=i.getAttribute("Id");if(!n)return i;if((t||!b.doesStringStartWith(n,"Ribbon.Documents"))&&!(t&&b.doesStringStartWith(n,"Ribbon.List")||b.doesStringStartWith(n,"Ribbon.Calendar")))return i}return null}function y(e,t,r,a){for(var i=[],n=e.getElementsByTagName("Button"),l=0,o=n.length;l<o;l++){var s=n[l],c=s.getAttribute("Command"),u=c&&t[c]||r.UrlAction;if(g(u)){var b={text:s.getAttribute("LabelText"),iconUrl:F(s),isEnabled:a,allowMultiSelect:!r.EnabledScript,action:u,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""};i.push(b)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:i}}function F(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function _(e,t,r,a){var i;if(("boolean"!=typeof a||a)&&(e&&e.length>0&&(i=w(e,t)),i)){var n=i.getAttribute("LabelText")||r.Title;if(n){var l={text:n,allowMultiSelect:!r.EnabledScript,action:r.UrlAction,isEnabled:a,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""},o=F(e[0]);return o&&(l.iconUrl=o),l}}}function I(e,t){var r=function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return o.PermissionMask.hasItemPermission(t,e.rights)}}(e,t),a=function(e,t){var r=e.registrationType,a=e.registrationId;if(!a)return r===i.List;switch(r){case i.List:var n=parseInt(a,10);return n===t.listTemplate||a===t.listId;case i.FileType:var l="."+a;return function(e){return b.equalsCaseInsensitive(e.extension,l)};case i.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&b.doesStringStartWith(t,a)};case i.ProgId:return function(e){var t="progId"in e&&e.progId||"properties"in e&&e.properties.ProgId;return t===a}}return!1}(e,t);return!(!r||!a)&&function(e){return!!e&&(!("function"==typeof r&&!r({permissions:e.permissions}))&&!("function"==typeof a&&!a(e)))}}r.d(t,"b",function(){return m}),r.d(t,"c",function(){return p}),r.d(t,"a",function(){return v}),r.d(t,"d",function(){return h})},"5abe0a4e18e69c009f41":function(e,t,r){"use strict";function a(e,t,r,a){var i="",n=0;if(!e)return"";var l=e.length;for(n=0;n<l;n++){var o=e.charCodeAt(n),s=e.charAt(n);if(t&&("#"===s||"?"===s)){i+=e.substr(n);break}if(r&&"&"===s)i+=s;else if(o<=127)a?i+=s:o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||t&&o>=32&&o<=95&&" \"%<>'&".indexOf(s)<0?i+=s:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047)i+="%"+(192|o>>6).toString(16).toUpperCase(),i+="%"+(128|63&o).toString(16).toUpperCase();else if(55296!=(64512&o))i+="%"+(224|o>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase(),i+="%"+(128|63&o).toString(16).toUpperCase();else if(n<e.length-1){o=(1023&o)<<10,n++,o|=1023&e.charCodeAt(n),i+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&o)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase(),i+="%"+(128|63&o).toString(16).toUpperCase()}}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeURIComponent=a,t.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(t>0&&(-1===r||t<r)){var i=e.substr(0,t);r>0&&(i+=e.substr(r)),e=i}return a(e,!0,!1,!0)},t.encodeRestUriStringToken=function(e){return e&&(e=a(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),e}},"661b65dcf8351e92fe44":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("fileHandlerActionControl")},"664990b3cc9463570172":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("getDefaultShareLinkActionControl")},"6946c0f0887243183999":function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),i=r("022addba5cf25ce091fb"),n=new a.a("modifyView"),l=Object(i.d)({operationTypeFacet:n})},"766d9e7109808f01029d":function(e,t,r){"use strict";var a,i,n=r("64328bb588b46459132d"),l=r("a4060cda3c9c24220a4a"),o=r("0b8514f932f40951d460"),s=r("6631b0451e9f577f414d"),c=r("c1a09d7dd35e11297e15"),u=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new c.default(function(){r.canceled=!0,o.default.is(r.result)&&r.result.cancel()}),this._queue.push(r),t=r.signal.getPromise()}return o.default.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(r){t.signal.complete(r),e._promiseComplete()},function(r){t.signal.error(r),e._promiseComplete()}))}},e}(),d=r("cdb9a7d2db44c7a9f4dd"),b=r("e9d155a6651c0bf6c9b0"),f=r("f698cfbaff8a2434ab85"),m=r("62a856fb51e24a703bd6");!function(e){e[e.queued=0]="queued",e[e.started=1]="started",e[e.completed=2]="completed",e[e.aborted=3]="aborted",e[e.failed=4]="failed",e[e.none=5]="none"}(a||(a={})),function(e){e[e.none=0]="none",e[e.other=1]="other",e[e.general=2]="general",e[e.conflict=3]="conflict",e[e.invalidName=4]="invalidName",e[e.fileSize=5]="fileSize",e[e.emptyFileOrFolder=6]="emptyFileOrFolder",e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib",e[e.overQuota=8]="overQuota",e[e.accessDenied=9]="accessDenied",e[e.lockMismatch=10]="lockMismatch",e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder",e[e.folderUploadNotSupported=12]="folderUploadNotSupported",e[e.versionMismatch=13]="versionMismatch",e[e.authFailure=14]="authFailure",e[e.targetFolderMissing=15]="targetFolderMissing",e[e.itemNotFound=16]="itemNotFound",e[e.malwareDetected=17]="malwareDetected",e[e.throttled=18]="throttled",e[e.pathTooLong=19]="pathTooLong",e[e.disconnected=20]="disconnected",e[e.unlockRequired=21]="unlockRequired",e[e.insufficientVaultQuota=22]="insufficientVaultQuota"}(i||(i={}));var p=r("c1d76209a7f2fe28e159"),v=r("00620f24248a4f158ff6"),h=(r("9ba97cc998d0be4df04a"),r("b32a03546c11ac251a10"));var g=function(e){function t(t){var r=this,a=n.__assign({},t,{isExpected:U(t.errorType)});return(r=e.call(this,a)||this).message=t.message,r.errorType=t.errorType||i.other,r.maxSizeInBytes=t.maxSizeInBytes,r.allowRename=t.allowRename||!1,r.allowMerge=t.allowMerge||!1,r.extraData=t.extraData,r.libraryName=t.libraryName,r.isFolder=t.isFolder,r.fixItUrl=t.fixItUrl,r}return n.__extends(t,e),t}(r("c0864826ef536ba1020d").ApiError);function U(e){switch(e){case i.conflict:case i.emptyFileOrFolder:case i.emptyFileOrFolderForDocLib:case i.fileSize:case i.folderUploadNotSupported:case i.insufficientVaultQuota:case i.invalidName:case i.lockMismatch:case i.malwareDetected:case i.overQuota:case i.overQuotaSharedFolder:case i.pathTooLong:case i.targetFolderMissing:case i.throttled:case i.unlockRequired:case i.versionMismatch:return!0;case i.accessDenied:case i.itemNotFound:case i.disconnected:case i.authFailure:case i.general:return!1;case i.none:case i.other:return}}var w=r("8e315e7d1c81f1fe46e0"),y=r("256c2b1df06b9b785912"),F=function(){function e(){var e=this.scope=new y.default;this._events=e.attach(new w.default(this))}return e.prototype.start=function(){},e.prototype.abort=function(){},e.prototype.dispose=function(){this.scope.dispose()},e.prototype.updateState=function(e){e!==this.state&&(this.state=e,this._events.raise("upload_state_change",e))},e}(),_=8388608,I=262144e3,O=new u(3),A=function(e){function t(t){var r=this,a=t.fileUpload;return(r=e.call(this)||this)._fileUpload=a,r._authToken=t.authToken,r._uploadId=null,r._chunkNumber=0,r._streamingChunkNumber=0,r._currentChunkSize=_,r._currentStreamingChunkSize=I,r._onProgress=t.onProgress,r._dataRequestor=t.dataRequestor,r._async=r.scope.attach(new s.default(r)),r.totalBytes=a.size,r.uploadedBytes=0,r.fileName=a.name,r.iconName=t.iconName,r.state=0,r.error=null,r.nameConflictBehavior=0,r.allowRename=!1,r._expandAllItemFields=t.expandAllItemFields,r._uniqueId=t.uniqueId,r._parentItemKey=t.parentItemKey,r._targetItemKey=t.targetItemKey,r._serverRelativeItemUrl=t.serverRelativeItemUrl,r._webApiUrl=t.webApiUrl,r}return n.__extends(t,e),t.prototype.start=function(){var e=this;this.updateState(0);var t=O.enqueue(function(){return e.error=void 0,e.updateState(1),e._upload().then(function(){e.updateState(2)},function(t){var r;return r=t instanceof g?t:new g({message:t&&t.message||"",errorType:i.general}),e.error=r,e.updateState(4),o.default.reject(t)})});return this._uploadPromise=t,t},t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null,this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0,t&&(t.cancel(),t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()}))}},t.prototype.restart=function(){var e,t=this,r=this._uploadPromise;this._uploadPromise=void 0,r?(r.cancel(),e=r.catch(function(){return t._cancelChunkUpload().catch(function(){})})):e=o.default.resolve(),e.done(function(){t.start()})},t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var r=this._fileUpload.size;return r<=25165824?e=this._sendSingleRequestUpload():(this._maxUploadRequestDuration=15e4,e=this._sendStreamingUpload()),e.then(function(e){t.uploadedBytes=r,t.item=e})},t.prototype._createUploadError=function(e){var t,r,a,n;switch("string"==typeof e?a=String(e):(t=this._getErrorCode(e),r=e.status,a="string"==typeof e.message?String(e.message):e.message.value),t){case-2130575257:n=i.conflict;break;case-1:n=i.disconnected;break;case-2130575245:n=i.invalidName;break;case-2130246326:n=i.versionMismatch;break;case-2147023080:case-2130575282:n=i.overQuota;break;default:switch(r){case 401:n=i.authFailure;break;case 404:n=i.targetFolderMissing;break;case 403:case 429:n=i.accessDenied;break;case 409:n=i.conflict;break;case 412:n=i.versionMismatch;break;case 415:n=i.emptyFileOrFolder;break;case 423:n=i.lockMismatch;break;case 507:n=i.overQuota;break;default:a?n||(n=i.other):n=i.general}}return new g({message:a,errorType:n,allowRename:this.allowRename})},t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]},t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,r=this._webApiUrl;r=e?r.method("GetFolderById",e):S(r,{serverRelativeItemUrl:t,isFolder:!0});var a=this._fileUpload.name,i=1===this.nameConflictBehavior;r=(r=r.segment("Files")).methodWithAliases("AddUsingPath",{DecodedUrl:a,overwrite:i});var n=null;return this._expandAllItemFields&&(n=(n||"ListItemAllFields")+"/ContentType/Fields"),n&&r.oDataParameter("$Expand",n),r.toString()},t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return o.default.resolve(!1);var t=this._serverRelativeItemUrl,r=this._webApiUrl;return r=(r=S(r,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+b.default.encodeRestUriStringToken(this._fileUpload.name)+"'"),this._dataRequestor.getData({url:r.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var r=JSON.parse(t);return!!(r&&r.d&&r.d.results&&r.d.results.length>0)&&!(r.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!o.default.isCanceled(e)&&o.default.reject(e)})},t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)},t.prototype._getItemFromResponse=function(e){var t;try{var r=JSON.parse(e).d,a=this._targetItemKey,i=void 0;r.ListItemAllFields&&r.ListItemAllFields.Id&&(i=String(r.ListItemAllFields.Id));var n=!1;if(r.ListItemAllFields&&r.ListItemAllFields.ContentType&&r.ListItemAllFields.ContentType.Fields&&r.ListItemAllFields.ContentType.Fields.results){var l=r.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(l.length>0)for(var o=0,s=l;o<s.length;o++){var c=s[o];if(!r.ListItemAllFields[c.InternalName]){n=!0;break}}}var u=void 0;r.UniqueId&&(u=d.default.normalizeLower(r.UniqueId));var b=r.Name,p=m.b(b);t={key:a,parentKey:this._parentItemKey,type:f.a.File,id:r.ServerRelativeUrl,name:b,displayName:b,extension:p,properties:{ID:i,uniqueId:u},itemFromServer:r,hasMissingMetadata:n}}catch(e){}return t},t.prototype._generateChunkPostUrl=function(e,t){var r,a=this._fileUpload,i=this._uniqueId,l=a.size<=t,o=this._serverRelativeItemUrl,s=this._webApiUrl,c={uploadId:{guid:this._uploadId}};return 0===this._chunkNumber&&0===this._streamingChunkNumber?(r="StartUpload",s=(s=i?s.method("GetFolderById",i):S(s,{serverRelativeItemUrl:o,isFolder:!0})).segment("Files"),s=1===this.nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:a.name}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:a.name})):(r=l?"FinishUpload":"ContinueUpload",s=S(s,{serverRelativeItemUrl:o+"/"+a.name,isFolder:!1}),c=n.__assign({},c,{fileOffset:e})),(s=s.methodWithAliases(r,c)).toString()},t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=a.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:r+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){return e.d&&e.d.ExpectedContentRange?parseInt(e.d.ExpectedContentRange.split("-")[0],10):o.default.reject(new Error("No expected range from server response."))})},t.prototype._uploadFragment=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3);var a=this._fileUpload.size,i=Math.min(this._currentChunkSize+e,a);this._uploadId||(this._uploadId=d.default.generate());var n=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,i),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,i),offset:e,length:i-e}).then(function(e){return r.uploadedBytes=i,i<a?(r._chunkNumber++,Date.now()-n<6e4&&(r._currentChunkSize=Math.min(Math.floor(r._currentChunkSize*Math.pow(2,.25)),62914560)),r._uploadFragment(i)):r._processUploadCompleteResponse(e)},function(a){if(o.default.isCanceled(a))return o.default.reject(a);if(-2===r._getErrorCode(a)){if(r._currentChunkSize>262144){r._currentChunkSize=Math.max(Math.floor(r._currentChunkSize/2),262144);var i=void 0;return 0===r._chunkNumber&&(i=r._cancelChunkUpload()),o.default.resolve(i).then(function(){return r._uploadFragment(e)})}}else if(t>0&&r._canRetry(a)){var n,l=new c.default(function(){n&&r._async.clearTimeout(n)});return n=r._async.setTimeout(function(){return l.complete()},1e3),l.getPromise().then(function(){return r._uploadFragment(e,t-1)})}return o.default.reject(r._createUploadError(a))})},t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var r=new g({message:"",errorType:i.conflict});return o.default.reject(r)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){return o.default.isCanceled(t)?o.default.reject(t):-2===e._getErrorCode(t)?(e.nameConflictBehavior=1,e._uploadFragment()):o.default.reject(e._createUploadError(t))})})},t.prototype._sendStreamingUpload=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3),this._uploadId||(this._uploadId=d.default.generate());var a=this._fileUpload.size,n=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,a):0;return this._isConflictFile().then(function(t){if(t){var a=new g({message:"",errorType:i.conflict});return o.default.reject(a)}return r._fileUpload.slice(e,n)}).then(function(i){return r._sendFileData({url:r._generateChunkPostUrl(e,n),qosName:"SingleFileUploader.SendFileRequest",data:i,offset:e,length:i.size}).then(function(e){return r.uploadedBytes=n,n<a?(r._streamingChunkNumber++,r._sendStreamingUpload(n,t)):r._processUploadCompleteResponse(e)},function(e){if(o.default.isCanceled(e))return o.default.reject(e);if(-2===r._getErrorCode(e)){if(r._currentStreamingChunkSize<=1048576)return o.default.reject(r._createUploadError(e));r._currentStreamingChunkSize=r._currentStreamingChunkSize/2}return r._getUploadStatus().then(function(e){return r._sendStreamingUpload(e,3)},function(a){if(t>0&&r._canRetry(e)){var i,n=new c.default(function(){i&&r._async.clearTimeout(i)});return i=r._async.setTimeout(function(){return n.complete()},1e3),n.getPromise().then(function(){return r._sendStreamingUpload(0,t-1)})}return o.default.reject(r._createUploadError(e))})})})},t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t},t.prototype._cancelChunkUpload=function(){var e=this._uploadId;if(this._uploadId=void 0,this._chunkNumber=0,e){var t=this._fileUpload,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=(a=S(a,{serverRelativeItemUrl:r+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return o.default.resolve()},t.prototype._sendFileData=function(e){var t,r,a,i=this,n=e.url,l=e.qosName,o=e.data,s=e.offset,u=e.length,d=new c.default(function(){t.cancel()}),b=function(e){var t=i._chunkNumber>0&&s+u>=i._fileUpload.size?3e5:1e4,a=Math.max(.08*e,t);r&&i._async.clearTimeout(r),e&&(r=i._async.setTimeout(function(){d.error({code:"-1",message:""})},a))},f=Date.now(),m=Date.now(),p=0,v=0,h=0,g=this._async.debounce(function(e){e>i.uploadedBytes&&(i.uploadedBytes=e,i._onProgress&&i._onProgress(e))},100,{leading:!1});t=this._dataRequestor.getData({url:n,authToken:this._authToken,qosName:l,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:o,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();v+=(e.loaded-p)/(t-m),h++,a=e.loaded/(t-f),m=t,p=e.loaded,g(s+e.loaded),b(u-e.loaded)}}}),b(u);var U=this._async.setInterval(function(){h&&(Date.now()-f+(u-p)/((v+a)/(h+1))>i._maxUploadRequestDuration&&p<u&&d.error({code:"-2",message:""}))},1e4);return t.done(function(e){d.complete(e)},function(e){d.error(e)}),d.getPromise().done(function(){r&&i._async.clearTimeout(r),U&&i._async.clearInterval(U)},function(){t.cancel(),r&&i._async.clearTimeout(r),U&&i._async.clearInterval(U)}),d.getPromise()},t}(F);!function(e){function t(t,r){var a=t.parentItem,i=t.fileUpload,n=r.listContext,l=r.itemUrlHelper,o=r.apiUrlHelper,s=n&&n.contentTypesEnabled&&n.listTemplateType!==v.default.mySiteDocumentLibrary,c=l.getItemUrlParts(a.key),u=a.properties&&a.properties.uniqueId,d=a.key,b=function(e,t,r){var a=e.getItemUrlParts(t),i=a.serverRelativeItemUrl,n=a.normalizedListUrl;return l=i+"/"+r,o=n,s=l,0!==s.indexOf("id")&&(s=Object(h.a)({id:l,listurl:o})),s;var l,o,s}(l,d,i.name),f=c.serverRelativeItemUrl,m=o.build().webByItemUrl(c),g=new p.default({pageContext:r.pageContext,qosName:"SingleFileUploader"});return e.call(this,{uniqueId:u,expandAllItemFields:s,dataRequestor:g,parentItemKey:d,targetItemKey:b,serverRelativeItemUrl:f,webApiUrl:m,iconName:i.iconName,fileUpload:i})||this}n.__extends(t,e)}(A);function S(e,t){var r=t.serverRelativeItemUrl,a=t.isFolder;return e=e.methodWithAliases(a?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:r})}var C=r("65da65eb66805e3724ff"),j=r("ee92087a6ec1d0e9ecc9"),k=r("2be4cdf0880f45f00879"),T=r("6187b1a01125644c0b13"),N=r("578e5017557fc66bb247"),x=r("c21819129ba64362c121"),D=r("4e318b84c4772f9f58b9"),K=r("447964f318fe44ff3682"),R=r("3da5d317c00adfe8f79c"),P=r("6578506114fc52cc91d3"),L=r("eef09ec91afb2fd77b66"),E=r("a5db57338f8274c3300c"),z=r("a9dd204dd0bee7467912");function q(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,i=l.C.deserialize(r),s=i.webAbsoluteUrl,c=i.listFullUrl,u=Object.keys(a)[0],d=a[u],b=d.progressItemKey,f=d.conflictResolution;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,l,d,m,p,v,h,U,w,y,F,_,I,O,S;return n.__generator(this,function(q){switch(q.label){case 0:return a=e(Object(C.d)({webAbsoluteUrl:s,listFullUrl:c})),l=a.dataRequestor,d=a.hasDigest,[4,e(Object(C.b)({url:s||c,disallowCookies:!d}))];case 1:if(m=q.sent(),p=e(Object(N.a)({sourceFile:x.b},u)).sourceFile,v=e(Object(N.a)({folderPath:j.G},r)).folderPath,h=void 0===v?i.rootFolder:v,!p)throw new Error("No source file for upload.");if(!h)throw new Error("No path information for target folder.");U=Object(P.getWebApiUrl)({webAbsoluteUrl:s,listOrItemFullUrl:c}),w=new k.a(void 0),y=w.debounce(function(t){var r;b&&e(Object(D.a)({items:(r={},r[b]=Object(K.d)({progressSize:R.p},{progressSize:{current:t}}),r)}))},300,{leading:!1}),(F=new A({authToken:m,dataRequestor:l,parentItemKey:"",targetItemKey:"",fileUpload:p,iconName:"",serverRelativeItemUrl:h,webApiUrl:U,onProgress:y})).nameConflictBehavior="replace"===f?1:0,b&&e(Object(D.a)({items:(t={},t[b]=n.__assign({},R.p.pack({total:p.size,current:0})),t)})),_=F.start(),I=e(Object(L.a)(function(e){return e.demandItemFacet(R.e,b)})),O=I?I.token.subscribe(function(){F.abort()}):void 0,q.label=2;case 2:return q.trys.push([2,4,5,6]),[4,_];case 3:return q.sent(),[3,6];case 4:if(S=q.sent(),F.abort(),o.default.isCanceled(S))throw new E.CancelError;if(S instanceof g)throw new T.a({facets:V(S),innerError:S});if((B=S)&&("status"in B||B.message&&"object"==typeof B.message))throw new T.a({facets:n.__assign({},"-2130575257"===S.code?n.__assign({},z.c.pack({supportsRename:!1})):n.__assign({},z.m.pack({})),j.Bb.pack(S)),message:(M=S,M&&M.message&&("object"==typeof M.message?M.message.value:M.message.toString())||"")});throw S;case 5:return O&&O(),F.dispose(),[7];case 6:return[2,F.item]}var M,B})})}}function V(e){switch(e.errorType){case i.conflict:return n.__assign({},z.c.pack({supportsRename:!1}));case i.accessDenied:return n.__assign({},z.a.pack({}));case i.disconnected:return n.__assign({},z.k.pack({}));case i.emptyFileOrFolder:case i.emptyFileOrFolderForDocLib:return n.__assign({},z.d.pack({}));case i.folderUploadNotSupported:return n.__assign({},z.f.pack({}));case i.invalidName:return n.__assign({},z.g.pack({}));case i.lockMismatch:return n.__assign({},z.i.pack({}));case i.malwareDetected:return n.__assign({},z.j.pack({}));case i.overQuota:return n.__assign({},z.l.pack({}));case i.targetFolderMissing:return n.__assign({},z.n.pack({}));case i.throttled:return n.__assign({},z.o.pack({}));case i.versionMismatch:return n.__assign({},z.p.pack({}))}return n.__assign({},z.m.pack({}))}r.d(t,"a",function(){return q})},"7a458e85783b71176e85":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("permissionInviteActionControl")},"7fa9594be33133790955":function(e,t,r){"use strict";r.d(t,"b",function(){return U}),r.d(t,"a",function(){return w});var a=r("64328bb588b46459132d"),i=r("fcf654cc44d7ec457fe0"),n=r("a4060cda3c9c24220a4a"),l=r("ee92087a6ec1d0e9ecc9"),o=r("65da65eb66805e3724ff"),s=r("56aac858adc5742217b8"),c=r("578e5017557fc66bb247"),u=r("4e318b84c4772f9f58b9"),d=r("d27387ede93a2620cbf6"),b=r("680b7ac74280293b48f0"),f=r("3da5d317c00adfe8f79c"),m=r("fdbcb7664c17b5b4e4d9"),p=r("6578506114fc52cc91d3"),v=r("a9dd204dd0bee7467912"),h=-2147023080,g=-2130575282,U=Object(b.e)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,b=e.options.folders;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,p,v,h,g,U,F,_,I,O,A;return a.__generator(this,function(S){switch(S.label){case 0:return v=Object.keys(b)[0],h=n.C.deserialize(r),g=h.rootFolder||new i.SimpleUri(h.listFullUrl).path,U=n.J.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}),F=e(Object(c.a)({list:l.Z},U)),_=w({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,parentFolderPath:g,isDocLib:!!F&&!!F.list&&F.list.isDocumentLibrary,folderName:v,needItemDetails:!1}),[4,e(Object(o.c)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,url:_,method:"POST",qosName:"createFolder"})).catch(function(e){if(e instanceof o.a&&e.message&&g){var t=g;"/"===t[0]&&(t=t.substr(1)),"/"!==t[t.length-1]&&(t+="/"),e.message=e.message.replace(t,"")}throw new s.a({innerError:e,facets:y(e)})})];case 1:return S.sent(),(I=b[v].progressItemKey)&&(O=g+"/"+v,A=n.C.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,rootFolder:O}),e(Object(u.a)({items:(t={},t[I]=a.__assign({},f.f.pack({itemKey:A})),t[A]=a.__assign({},l.G.pack(O)),t)}))),e(Object(d.b)({items:(p={},p[r]=[m.b],p)})),[2]}})})}});function w(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.parentFolderPath,i=e.isDocLib,n=void 0===i||i,l=e.needItemDetails,o=void 0!==l&&l,s=e.folderName,c=Object(p.getWebApiUrl)({webAbsoluteUrl:t,listOrItemFullUrl:r});return n?(c=(c=c.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:a+"/"+s,overwrite:!1}),o&&(c=c.oDataParameter("$Expand","ListItemAllFields"))):c=c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:s||"Folder"+(Math.floor(100*Math.random())+1)}),c.toString()}function y(e){if(e instanceof o.a)switch(function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]}(e)){case h:case g:return v.l.pack({})}}},"809072ae40093b380229":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("447964f318fe44ff3682").a)("updateItem")},"83f2d47bcced97f0a85c":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("getDriveItemFullUrlControl")},"85bfca0cd3bb87373c39":function(e,t,r){"use strict";r.d(t,"a",function(){return o});var a=r("65da65eb66805e3724ff"),i=r("6578506114fc52cc91d3"),n=r("00620f24248a4f158ff6"),l=r("dafd9db62310f1337c17");function o(e){return function(t){return t(Object(a.e)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:u(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:s(t,!1,e.listTemplate)}})},noRedirect:!0}))}}function s(e,t,r){if(e.ViewType&&e.Id){var a=l.a.isAppView(e),i=e.Hidden&&!a,o=r===n.ListTemplateType.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!o){var s=new l.a(e);if(s.viewType)return s}}}var c=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function u(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.viewId,n=Object(i.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r});return(n=a?n.method("Views",a):n.segment("Views")).oDataParameter("$select",c).toString()}},a083584f8eeab8771a10:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),i=r("022addba5cf25ce091fb"),n=new a.a("saveViewCore"),l=Object(i.d)({operationTypeFacet:n})},aa420188fc5b81d114ba:function(e,t,r){"use strict";r.d(t,"a",function(){return v});var a=r("64328bb588b46459132d"),i=r("a4060cda3c9c24220a4a"),n=r("766d9e7109808f01029d"),l=r("680b7ac74280293b48f0"),o=r("578e5017557fc66bb247"),s=r("c21819129ba64362c121"),c=r("447964f318fe44ff3682"),u=r("3da5d317c00adfe8f79c"),d=r("fdbcb7664c17b5b4e4d9"),b=r("5f6c4af8cb56376acb4d"),f=r("bb1d3dd843cb19bcdb5a"),m=r("5fef64b3561abb2ebffa"),p=r("fcf654cc44d7ec457fe0"),v=Object(l.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,l=e.options.sourceEntries,v=i.C.deserialize(r),h=v.webAbsoluteUrl,g=v.listFullUrl,U=Object.keys(l)[0],w=l[U].progressItemKey;return function(l){return a.__awaiter(t,void 0,void 0,function(){var t,y,F,_,I,O,A,S,C,j,k;return a.__generator(this,function(T){switch(T.label){case 0:return _=l(Object(o.a)({sourceFile:s.b},U)).sourceFile,[4,l(Object(n.a)(e))];case 1:return I=T.sent(),O=I.properties,A=O&&O.ID||I.id,S=new b.a,w&&_&&(C=i.C.serialize({webAbsoluteUrl:h,listFullUrl:g,itemId:A}),S.resolveItems({items:(t={},t[w]=a.__assign({},u.f.pack({itemKey:C}),Object(c.d)({progressSize:u.p},{progressSize:{current:_.size}})),t[C]=a.__assign({},m.displayNameFacet.pack(I.displayName),i.C.pack({itemId:I.id,webAbsoluteUrl:h,listFullUrl:g})),t)})),S.invalidateItems({items:(y={},y[r]=[d.b],y)}),C&&I&&v.listFullUrl&&(j=new p.SimpleUri(v.listFullUrl+"/Forms").path,v.rootFolder&&(v.rootFolder+"/").slice(0,j.length+1)===j+"/"&&(k=i.J.serialize({webAbsoluteUrl:h,listFullUrl:g}),l(Object(f.a)({items:(F={},F[k]={childItemKey:C},F)})))),l(S.execute()),[2]}})})}})},b32a03546c11ac251a10:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var a=r("64328bb588b46459132d"),i=r("e9d155a6651c0bf6c9b0");function n(e,t,r){var n="",l=!0;for(var o in t&&(e=a.__assign({},t,e)),e){var s=e[o];if(!r||"object"!=typeof s&&s||"object"==typeof s&&s&&s.uriValue||"number"==typeof s||"boolean"==typeof s){l?l=!1:n+="&";n+=o+"="+("object"==typeof s&&s&&s.uriValue?s.uriValue:i.default.encodeURIComponent(""+s))}}return n}},bb1d3dd843cb19bcdb5a:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),i=r("022addba5cf25ce091fb"),n=new a.a("saveUploadedTemplateToView"),l=Object(i.d)({operationTypeFacet:n})},bbd7d74e386f4574607d:function(e,t,r){"use strict";var a=r("64328bb588b46459132d"),i=r("680b7ac74280293b48f0"),n=r("4e318b84c4772f9f58b9"),l=r("be9ddcf0ec56bc42b1b1"),o=r("a4060cda3c9c24220a4a"),s=r("5fef64b3561abb2ebffa"),c=r("fdbcb7664c17b5b4e4d9"),u=r("ee92087a6ec1d0e9ecc9"),d=r("51544a23f67b5dfbf4ba"),b=r("5f6c4af8cb56376acb4d");function f(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l;return a.__generator(this,function(s){switch(s.label){case 0:return i=o.z.deserialize(e.itemKey).tenantRootUrl,n=new b.a,[4,r(Object(d.b)({tenantRootUrl:i}))];case 1:return l=s.sent(),n.resolveItems({items:(t={},t[e.itemKey]=a.__assign({},u.Ib.pack(l.resource),u.Hb.pack(l.payloadHeader)),t)}),r(n.execute()),[2]}})})}}var m=r("52ea8189ec1bd7bba704"),p=r("4986dedaa57d766e48bb")._mbDabxjGbDpso2fDZQAQog;function v(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l,d,f;return a.__generator(this,function(v){return i=o.k.deserialize(e.itemKey).tenantRootUrl,n=new b.a,l=o.x.serialize({tenantRootUrl:i}),d=o.w.serialize({tenantRootUrl:i}),f=[l,d],n.resolveItems({items:(t={},t[l]=a.__assign({},m.g.pack(!0),s.displayNameFacet.pack(p.frequent),u.nb.pack({itemKey:e.itemKey})),t[d]=a.__assign({},m.g.pack(!0),s.displayNameFacet.pack(p.followed),u.nb.pack({itemKey:e.itemKey})),t[e.itemKey]=a.__assign({},s.displayNameFacet.pack(p.sites),m.g.pack(!0),c.a.pack({itemKeys:f})),t)}),r(n.execute()),[2]})})}}function h(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l,f,m,v,h,g,U,w,y;return a.__generator(this,function(F){switch(F.label){case 0:return n=o.x.deserialize(e.itemKey).tenantRootUrl,l=new b.a,[4,r(Object(d.b)({tenantRootUrl:n}))];case 1:return f=F.sent(),[4,r(Object(d.d)(f))];case 2:for(m=F.sent(),v=[],h=0,g=m.Items;h<g.length;h++)U=g[h],w=o.bb.serialize({webAbsoluteUrl:U.Url}),y=o.H.serialize({webAbsoluteUrl:U.Url}),l.resolveItems({items:(t={},t[w]=a.__assign({},s.displayNameFacet.pack(U.Title),u.a.pack(U.Acronym),u.c.pack(U.BannerColor),u.d.pack(U.BannerImageUrl),u.V.pack(!0),s.folderFacet.pack({}),o.bb.pack({webAbsoluteUrl:U.Url}),c.b.pack({itemKey:y})),t[y]=a.__assign({},c.e.pack({itemKey:w})),t)}),v.push(w);return l.resolveItems({items:(i={},i[e.itemKey]=a.__assign({},s.displayNameFacet.pack(p.frequent),c.a.pack({itemKeys:v}),u.nb.pack({itemKey:o.k.serialize({tenantRootUrl:n})})),i)}),r(l.execute()),[2]}})})}}function g(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l,f,m,v,h,g,U,w,y;return a.__generator(this,function(F){switch(F.label){case 0:return n=o.w.deserialize(e.itemKey).tenantRootUrl,l=new b.a,[4,r(Object(d.b)({tenantRootUrl:n}))];case 1:return f=F.sent(),[4,r(Object(d.c)(f))];case 2:for(m=F.sent(),v=[],h=0,g=m.Items;h<g.length;h++)U=g[h],w=o.bb.serialize({webAbsoluteUrl:U.Url}),y=o.H.serialize({webAbsoluteUrl:U.Url}),l.resolveItems({items:(t={},t[w]=a.__assign({},s.displayNameFacet.pack(U.Title),u.a.pack(U.Acronym),u.c.pack(U.BannerColor),u.d.pack(U.BannerImageUrl),u.V.pack(!0),s.folderFacet.pack({}),o.bb.pack({webAbsoluteUrl:U.Url}),c.b.pack({itemKey:y})),t[y]=a.__assign({},c.e.pack({itemKey:w})),t)}),v.push(w);return l.resolveItems({items:(i={},i[e.itemKey]=a.__assign({},s.displayNameFacet.pack(p.followed),c.a.pack({itemKeys:v}),u.nb.pack({itemKey:o.k.serialize({tenantRootUrl:n})})),i)}),r(l.execute()),[2]}})})}}function U(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l;return a.__generator(this,function(s){return i=o.bb.deserialize(e.itemKey).webAbsoluteUrl,n=new b.a,l=o.H.serialize({webAbsoluteUrl:i}),n.resolveItems({items:(t={},t[e.itemKey]=a.__assign({},c.b.pack({itemKey:l})),t)}),r(n.execute()),[2]})})}}var w=r("5e76ddf6bb30811ee697"),y=r("8bcc52c340fdae8e02d4"),F=r("d27387ede93a2620cbf6"),_=r("7f44f3b6edbad81cb558");function I(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,i,n,l,f,m,p,v,h,g,U,I,O,A,S;return a.__generator(this,function(C){switch(C.label){case 0:return n=o.H.deserialize(e.itemKey).webAbsoluteUrl,l=o.bb.serialize({webAbsoluteUrl:n}),f=new b.a,[4,r(Object(d.e)({webAbsoluteUrl:n}))];case 1:for(m=C.sent(),p=[],v=0,h=m.d.GetDocumentLibraries.results;v<h.length;v++)g=h[v],U=new w.a({context:{webAbsoluteUrl:n}}),I=U.getUrlParts({webUrl:n,listUrl:g.AbsoluteUrl,path:g.AbsoluteUrl}),O={webAbsoluteUrl:n,listFullUrl:I.fullListUrl||"",rootFolder:""},A=o.C.serialize(O),S=o.r.serialize({webAbsoluteUrl:n,listFullUrl:I.fullListUrl||"",rootFolder:""}),f.resolveItems({items:(t={},t[A]=a.__assign({},s.displayNameFacet.pack(g.Title),o.C.pack(O),s.folderFacet.pack({}),s.fileNameFacet.pack({name:new y.default(I.fullListUrl).segments.slice(-1)[0],extension:""}),u.G.pack(I.serverRelativeItemUrl),c.b.pack({itemKey:S}),s.parentFolderItemFacet.pack(void 0)),t[S]=a.__assign({},c.e.pack({itemKey:A})),t)}),p.push(A);return f.resolveItems({items:(i={},i[e.itemKey]=a.__assign({},c.a.pack({itemKeys:p}),Object(F.a)().forFacet(c.a).thenInvalidate(_.a).pack(),o.bb.pack({webAbsoluteUrl:n}),c.e.pack({itemKey:l})),i)}),r(f.execute()),[2]}})})}}r.d(t,"a",function(){return O});var O=Object(i.b)(function(){return function(e){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(t){return e(Object(n.c)({keyFacet:o.bb,facets:[s.displayNameFacet,c.b]})),e(Object(n.c)({keyFacet:o.w,facets:[o.w,c.a]})),e(Object(n.c)({keyFacet:o.x,facets:[o.x,c.a]})),e(Object(n.c)({keyFacet:o.H,facets:[o.H,c.a,c.b]})),e(Object(i.f)(o.z,l.a)(Object(i.e)({maxParallelOperationCount:4})(f))),e(Object(i.f)(o.k,l.a)(Object(i.e)()(v))),e(Object(i.f)(o.x,l.a)(Object(i.e)()(h))),e(Object(i.f)(o.w,l.a)(Object(i.e)()(g))),e(Object(i.f)(o.bb,l.a)(Object(i.e)({maxParallelOperationCount:4})(U))),e(Object(i.f)(o.H,l.a)(Object(i.e)({maxParallelOperationCount:8})(I))),[2]})})}})},bd2835d22f85a2b6d99d:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),i=r("022addba5cf25ce091fb"),n=new a.a("createView"),l=Object(i.d)({operationTypeFacet:n})},c21819129ba64362c121:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return n});var a=r("447964f318fe44ff3682"),i=new a.a("entryBatch"),n=new a.a("sourceFile")},c317bf72559990179c22:function(e,t,r){"use strict";r.r(t);var a,i=r("64328bb588b46459132d"),n=r("680b7ac74280293b48f0"),l=r("e87bb409a9007bb8123c"),o=r("63aeb04d7e4744f15272"),s=r("6187b1a01125644c0b13"),c=r("be9ddcf0ec56bc42b1b1"),u=r("c8af1cc43f0b61ba9a17"),d=r("a4060cda3c9c24220a4a"),b=r("0be8895c37c7580fa8d6"),f=r("c89079fccee5039e5e63"),m=r("01e9cd72f63f0c70ab1c"),p=r("2abad5c842761f84fba3"),v=r("447964f318fe44ff3682"),h=r("f5df325953ebb7f1143d"),g=new v.a("assignItemToGroup"),U=new h.a("assignToGroup"),w=r("6946c0f0887243183999"),y=r("a083584f8eeab8771a10"),F=r("bd2835d22f85a2b6d99d"),_=r("95da7825c4969f34e250"),I=r("e008263a4c0e246e4f4f"),O=r("c88e7380c3f2d1910abe"),A=r("2c440e638bb16e83d44e"),S=r("64b1e6e25051aaaf0681"),C=r("022addba5cf25ce091fb");!function(e){e[e.preview=0]="preview",e[e.save=1]="save"}(a||(a={}));var j=new v.a("updateColumnFormatter"),k=(Object(C.d)({operationTypeFacet:j}),r("bbd7d74e386f4574607d")),T=r("d8fd33afeefeaaa9ec9d"),N=r("ee92087a6ec1d0e9ecc9"),x=r("65da65eb66805e3724ff"),D=r("5f6c4af8cb56376acb4d"),K=r("c70c28d41140929c0281"),R=r("6d69c5cabadd78126515"),P=r("eef09ec91afb2fd77b66"),L=r("b32a03546c11ac251a10"),E=r("6578506114fc52cc91d3"),z=Object(n.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=d.Z.deserialize(r).tenantRootUrl;return function(r){return i.__awaiter(t,void 0,void 0,function(){var t,n,l,o,s,c,u,b,f,m,p,v;return i.__generator(this,function(h){switch(h.label){case 0:return n=d.cb.serialize({webAbsoluteUrl:a}),[4,r(Object(K.a)(function(e){return e.demandItemFacet(N.Mb,n)}))];case 1:return l=h.sent(),o=r(Object(P.a)(function(e){return e.demandItemFacet(R.localeFacet,R.configurationItemKey)})),s=l&&l.isSPO,u=o&&o.language||"en-US",b=Object(L.a)({Locale:u,v:2,msajax:1,cv:2}),c=s?a+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+b:Object(E.getStaticApiUrl)({webAbsoluteUrl:a}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:u}),[4,r(Object(x.c)({url:c.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:a,noRedirect:!0}))];case 2:return f=h.sent(),m=s?f:JSON.parse(f.d.GetSuiteNavData),p=!(!m.NavBarData||!m.NavBarData.AdminLink)||!1,(v=new D.a).resolveItems({items:(t={},t[e.itemKey]=i.__assign({},d.Z.pack({tenantRootUrl:a}),N.Rb.pack(p)),t)}),r(v.execute()),[2]}})})}});var q,V=Object(n.b)(function(){return function(e){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(t){return e(Object(n.f)(d.Z,c.a)(z)),[2]})})}}),M=r("a2564481e9dba5f9a8bd");!function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter",e[e.saveColumnFormatter=1]="saveColumnFormatter",e[e.previewViewFormatter=2]="previewViewFormatter",e[e.saveViewFormatter=3]="saveViewFormatter"}(q||(q={}));var B=new v.a("updateFormatter"),G=(Object(C.d)({operationTypeFacet:B}),r("4e318b84c4772f9f58b9")),H=r("3752b592d50f9c3fa6b5"),W=r("e45a813de720285432ba"),J=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.formatterMap;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u;return i.__generator(this,function(d){switch(d.label){case 0:return l=Object.keys(r)[0],o=r[l],s=o.updateType,c=o.formatter,0!==s?[3,1]:[2,e(Object(G.a)({items:(a={},a[l]=i.__assign({},N.k.pack(c)),a)}))];case 1:return 2!==s?[3,3]:(u=Object(H.b)(c),[4,e(Object(K.a)(function(e){e.demandItemFacet(W.a,W.b.serialize({}))}))]);case 2:return d.sent(),[2,e(Object(G.a)({items:(n={},n[t]=i.__assign({},N.Vb.pack(u)),n)}))];case 3:return[2]}})})}}),Q=new v.a("modifyFieldProperties"),X=(Object(C.d)({operationTypeFacet:Q}),r("578e5017557fc66bb247")),Z=r("08bf0219777f111bb2c9"),$=r("5fef64b3561abb2ebffa"),Y=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.fields;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b,f;return i.__generator(this,function(m){return a=Object.keys(r)[0],n=r[a],l=n.displayName,o=n.fieldDescription,s=n.showInFiltersPane,(c=e(Object(X.a)({setKey:d.r},t)).setKey)&&a&&(u=e(Object(X.a)({id:N.D},a)).id)?(b={__metadata:{type:"SP.Field"},Title:l,SchemaXml:o,ShowInFiltersPane:s},f=Object(E.getListApiUrl)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}).method("Fields",u).toString(),[2,e(Object(x.c)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:f,qosName:"modifyFieldProperties",body:JSON.stringify(b),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(G.a)({items:(t={},t[a]=i.__assign({},void 0!==s?Z.c.pack(s):{},void 0!==l?$.displayNameFacet.pack(l):{}),t)}))})]):[2]})})}}),ee=r("dea1b9d7d476fd78f2d7"),te=r("5e2d26706bb97efeb013"),re=Object(n.e)()(function(e){var t=this,r=e.itemKey,a=d.M.deserialize(r),n={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,rootFolder:"",viewKey:{viewId:d.i}};return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,a,l;return i.__generator(this,function(i){switch(i.label){case 0:return t=e(Object(ee.c)({itemSetKey:n})),[4,e(Object(ee.b)({itemSetKey:n,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:a=i.sent(),i.label=2;case 2:return i.trys.push([2,5,,7]),[4,e(Object(te.a)(a))];case 3:return l=i.sent(),[4,e(ae(l,r))];case 4:return i.sent(),[3,7];case 5:return i.sent(),[4,e(ae(void 0,r))];case 6:return i.sent(),[3,7];case 7:return[2]}})})}});function ae(e,t){var r=this;return function(a){return i.__awaiter(r,void 0,void 0,function(){var r,n,l,o;return i.__generator(this,function(s){return n=!1,(l=e&&e.ListData&&e.ListData.Row)&&l.length>0&&l[0]&&(n=!0),(o=new D.a).resolveItems({items:(r={},r[t]=i.__assign({},$.missingMetadataFacet.pack(n)),r)}),a(o.execute()),[2]})})}}var ie,ne=r("5abe0a4e18e69c009f41"),le=r("ba9b9c401d4d91d63e29");function oe(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.fieldInternalName,i=e.viewId,n=e.rootFolder,l=e.excludeFieldFilteringHtml,o=e.filterParams,s=Object(E.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).segment("RenderListFilterData").parameter("FieldInternalName",a||"");if(i&&(s=s.parameter("ViewId",i)),n&&(s=s.parameter("RootFolder",{raw:Object(ne.encodeURIComponent)(n)})),l&&(s=s.parameter("ExcludeFieldFilteringHtml",!0)),o){var c=le.a.getFilterParams(o,!0);s=s.rawParameter(c)}return s.toString()}!function(e){e.getFilterData=function(e,t,a){var i=[];e=e.split("<br>")[0];var n=document.createElement("DIV");n.innerHTML=e;var l=n.querySelector("#diidFilter"+t);if(null!=l)for(var o=l.childNodes.length,s=l.childNodes,c=1;c<o;c++){var u=le.a.getText(s[c]),d=s[c].value.toString(),b={display:u,value:d};if(a){var f=r(d);f.filterType&&(b.value=f.value,b.calculatedFieldOriginFilterValue=d,b.calculatedFieldFilterType=f.filterType,i.push(b))}else i.push(b)}for(var m={},p=0,v=i;p<v.length;p++)(U=v[p]).display in m?m[U.display]++:m[U.display]=1;for(var h=0,g=i;h<g.length;h++){var U;m[(U=g[h]).display]>1&&(U.display=U.value)}return i};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function r(e){var r=e.indexOf("_"),a=e,i=void 0;if(r>0){a=e.substring(r+1);var n=Number(e.substring(0,r));!isNaN(n)&&n<t.length&&(i=t[n])}return{value:a,filterType:i}}e.getCalculatedFieldFilterValueAndType=r}(ie||(ie={}));var se=ie,ce=r("291bfd7ca3e0ca52b70d"),ue=r("3d240143e32215cc23a5"),de=Object(n.e)({maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,a=d.p.deserialize(r);return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,n,l,o,s;return i.__generator(this,function(c){switch(c.label){case 0:return n=e(function(e){var t=e.itemSetKey,r=e.fieldKey;return function(e){var a=e(Object(ue.a)({spDataSourceConfiguration:N.Ab})).spDataSourceConfiguration,i=a&&a.ensureAuthToken,n=d.C.serialize(t),l=e(Object(X.a)({folderPath:N.G},n)),o=e(Object(X.a)({internalName:N.Q,mappedColumnFieldType:N.db},d.o.serialize(r))),s=l&&l.folderPath,c=o&&o.internalName&&o.internalName,u=o&&o.mappedColumnFieldType===ce.a.Taxonomy;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:s,ensureAuthToken:i,fieldInternalName:c,filterParams:t.filterParams,excludeFieldFilteringHtml:u,viewId:t.viewKey&&t.viewKey.viewId}}}({itemSetKey:a.itemSetKey,fieldKey:a.fieldKey})),[4,e((u=n,function(e){return e(Object(x.c)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,method:"POST",url:oe(u),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:return l=c.sent(),o=se.getFilterData(l,n.fieldInternalName||""),(s=new D.a).resolveItems({items:(t={},t[r]=i.__assign({},N.F.pack(o)),t)}),e(s.execute()),[2]}var u})})}});var be=r("56aac858adc5742217b8"),fe=r("06bd4399cef6e6b5593c"),me=r("cdb9a7d2db44c7a9f4dd"),pe=r("c0ec8ed08a9b4b107886"),ve=r("8bcc52c340fdae8e02d4"),he=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new pe.ApiUrlHelperBasic({webAbsoluteUrl:!e&&t?new ve.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var r={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),n=e.message.value;r.error={code:i,message:n}}return{items:[r]}},e.getBatchResponseText=function(e){var t,r,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){r=(e=e.replace(t.trim()+"--","")).split(t);for(var n=1;n<r.length;n++)(a=r[n].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,r){var a,i,n,l,o=[],s=!1;if(e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var c=1;c<i.length;c++)if((n=i[c].split("\n\r")).length>2){try{l=JSON.parse(n[2])}catch(e){l=n[2]}var u=t&&t[c-1],d=u?{key:u.key,id:u.id,newId:r?r+"/"+u.name:null}:{};if((l=l.error?l.error:l)&&l.code){var b=l.code?l.code.split(","):l.error.code.split(","),f=Number(b[0]),m=l.message.value;d.error={code:f,message:m},s=!0}o.push(d)}}return{items:o,hasError:s}},e.getBatchContent=function(e,t,r,a){for(var i=[],n=0;n<t.length;n++){for(var l=t[n],o=me.default.generate(),s=[],c=0;c<l.length;c++){var u=l[c];s.push("--changeset_"+o),s.push("Content-Type: application/http"),s.push("Content-Transfer-Encoding: binary"),s.push(""),s.push(r+" "+u+" HTTP/1.1"),s.push(a),s.push("")}s.push("--changeset_"+o+"--");var d=s.join("\r\n");i.push("--batch_"+e),i.push('Content-Type: multipart/mixed; boundary="changeset_'+o+'"'),i.push("Content-Length: "+d.length),i.push("Content-Transfer-Encoding: binary"),i.push(""),i.push(d),i.push("")}return i.push("--batch_"+e+"--"),i.join("\r\n")},e.getBatchContentExtended=function(e,t,r,a,i,n,l){var o=me.default.generate(),s=[];i&&i.length!==t.length&&(i=null);for(var c=0;c<t.length;c++){var u=t[c];s.push("--changeset_"+o),s.push("Content-Type: application/http"),s.push("Content-Transfer-Encoding: binary"),s.push(""),l?s.push(l[c]+" "+u+" HTTP/1.1"):s.push(r+" "+u+" HTTP/1.1"),s.push(a),n&&s.push(n),i&&(s.push(""),s.push(i[c])),s.push("")}s.push("--changeset_"+o+"--");var d=s.join("\r\n");return(s=[]).push("--batch_"+e),s.push('Content-Type: multipart/mixed; boundary="changeset_'+o+'"'),s.push("Content-Length: "+d.length),s.push("Content-Transfer-Encoding: binary"),s.push(""),s.push(d),s.push(""),s.push("--batch_"+e+"--"),s.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}(),ge=he,Ue=Object(n.c)()(function(e){var t=e.items;return function(r){return i.__awaiter(void 0,void 0,void 0,function(){var a,l,o,s,c,u,b,f,m,p,v,h,g,U,w,y,F,_,I,O,A,S,C,j,k;return i.__generator(this,function(T){switch(T.label){case 0:for(o=void 0,s=void 0,c=0,u=Object.keys(t);c<u.length;c++)g=u[c],b=r(Object(X.a)({key:d.C,folderPath:N.G},g)),f=e.items[g],b&&b.key&&b.folderPath&&(o||(s=b.key.listFullUrl,o={webAbsoluteUrl:b.key.webAbsoluteUrl,items:[],checkInOutType:f.checkInOutType,checkInText:f.checkInText},s=b.key.listFullUrl),o.items.push({key:g,itemFullUrl:b.folderPath}));return(m=o)&&m.items.length?(p=m.items.length>1,v=void 0,v=1===m.checkInOutType?p?"batchCheckInItems":"CheckInItem":0===m.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem",h=0===m.checkInOutType,p?[3,2]:(g=m.items[0].key,U=we(m.webAbsoluteUrl,m.items[0].itemFullUrl,m.checkInOutType,m.checkInText),[4,r(Object(x.c)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:s,url:U,method:"POST",qosName:v}))])):[3,4];case 1:return T.sent(),r(Object(G.a)({items:(a={},a[g]=i.__assign({},$.isCheckedOutFacet.pack({byYou:!!h,byOther:void 0})),a)})),[3,4];case 2:return w=me.default.generate(),y="multipart/mixed; boundary=batch_"+w,[4,r(Object(x.c)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:s,url:ge.getBatchOperationUrl(m.webAbsoluteUrl),body:ye(m,w),method:"POST",additionalHeaders:void 0,contentType:y,parseResponse:function(e){return ge.processBatchResponse(e,m.items)},qosName:"batch",successQosHandler:function(e){return{resultType:e.hasError?fe.b.failure:fe.b.success}}}))];case 3:if((F=T.sent()).hasError){for(S={items:{}},C=0,j=F.items;C<j.length;C++)(k=j[C]).error&&k.key&&(S.items[k.key]=new be.a({message:k.error.message}));throw new n.a(S)}for(_=new D.a,I=0,O=m.items;I<O.length;I++)A=O[I],_.resolveItems({items:(l={},l[A.key]=i.__assign({},$.isCheckedOutFacet.pack({byYou:!!h,byOther:void 0})),l)});r(_.execute()),T.label=4;case 4:return[2]}})})}});function we(e,t,r,a){var i;i=1===r?"CheckIn":2===r?"UndoCheckOut":"CheckOut";var n=Object(E.getWebApiUrl)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(n=1===r?n.methodWithAliases("CheckIn",{comment:a,checkintype:0}):n.segment(i)).toString()}function ye(e,t){var r=e.items,a=ge.defaultBatchRequestPostData,i=r.map(function(t){return we(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText)});return ge.getBatchContentExtended(t,i,"POST",a)}var Fe,_e=r("d27387ede93a2620cbf6"),Ie=r("31c533de2caeaf8e942c"),Oe=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b;return i.__generator(this,function(i){switch(i.label){case 0:return[4,e(Object(Ie.a)(t))];case 1:return n=i.sent(),l=n.key,o=n.itemId,s=l.webAbsoluteUrl,c=l.listFullUrl,u=d.J.serialize({webAbsoluteUrl:s,listFullUrl:c}),(b=e(Object(P.a)(function(e){return e.demandItemFacet(N.Z,u)})))&&b.id&&o?[4,e(Object(x.c)({webAbsoluteUrl:s,listFullUrl:c,url:Object(E.getStaticApiUrl)({webAbsoluteUrl:s}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:b.id,itemID:o,rating:r.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent(),e(Object(_e.b)({items:(a={},a[t]=[$.displayNameFacet],a)})),i.label=3;case 3:return[2]}})})}}),Ae=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b;return i.__generator(this,function(i){switch(i.label){case 0:return[4,e(Object(Ie.a)(t))];case 1:return n=i.sent(),l=n.key,o=n.itemId,s=l.webAbsoluteUrl,c=l.listFullUrl,u=d.J.serialize({webAbsoluteUrl:s,listFullUrl:c}),(b=e(Object(P.a)(function(e){return e.demandItemFacet(N.Z,u)})))&&b.id&&o?[4,e(Object(x.c)({webAbsoluteUrl:s,listFullUrl:c,url:Object(E.getStaticApiUrl)({webAbsoluteUrl:s}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:b.id,itemID:o,like:r.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent(),e(Object(_e.b)({items:(a={},a[t]=[$.displayNameFacet],a)})),i.label=3;case 3:return[2]}})})}});!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(Fe||(Fe={}));var Se=Fe,Ce=r("a9dd204dd0bee7467912"),je=r("2852e19dad7ee30e33c6"),ke=Object(n.c)()(function(e){var t=e.items;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,a,l,o,s,c,u,b,f,m,p,v,h,g,U,w,y,F;return i.__generator(this,function(_){switch(_.label){case 0:for(l=void 0,o=void 0,s=void 0,c=function(t){var r=e(Object(P.a)(function(e){return e.demandItem({key:d.C,folder:$.folderFacet,uniqueId:N.Tb,folderPath:N.G,oneNote:je.b,itemId:N.bb},t)}));if(r&&r.key&&r.folderPath){if(o=r.key.webAbsoluteUrl,s=r.key.listFullUrl,!l){var a=d.J.serialize({webAbsoluteUrl:o,listFullUrl:s}),i=e(Object(P.a)(function(e){return e.demandItemFacet(N.Z,a)}));l={webAbsoluteUrl:o,listFullUrl:s,items:[],deletionType:Se.Recycle,listId:i&&i.id}}l.items.push({key:t,serverRelativeItemUrl:r.folderPath,id:r.itemId,uniqueId:r.uniqueId,isFolder:!!r.folder||!!r.oneNote})}},u=0,b=Object.keys(t);u<b.length;u++)f=b[u],c(f);return(m=l)&&m.items.length?1!==m.items.length?[3,2]:(p=m.items[0],v=Te({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,deletionType:m.deletionType,listId:m.listId,serverRelativeItemUrl:p.serverRelativeItemUrl,uniqueId:p.uniqueId,isFolder:!!p.isFolder,itemId:p.id}),[4,e(Object(x.c)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:s||"",url:v,body:void 0,method:"POST",additionalHeaders:m.deletionType===Se.PermanantDelete?{"X-HTTP-Method":"DELETE"}:void 0,qosName:"deleteSingleItem",qosHandler:function(e){return e.status===be.b?{resultType:fe.b.expectedFailure}:{resultType:fe.b.failure}}})).catch(function(e){if(e instanceof x.a&&e.errorData.status===be.b)throw new be.a({innerError:e,facets:i.__assign({},Ce.k.pack({}))});throw e})]):[3,5];case 1:return _.sent(),[3,4];case 2:return m.items.length>1?(h=me.default.generate(),g="multipart/mixed; boundary=batch_"+h,[4,e(Object(x.c)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:s||"",url:he.getBatchOperationUrl(m.webAbsoluteUrl),body:Ne(m,h),method:"POST",additionalHeaders:void 0,contentType:g,parseResponse:function(e){return he.processBatchResponse(e,m.items)},qosName:"deleteMultipleItems"})).then(function(e){if(e.hasError){for(var t={items:{}},r=0,a=e.items;r<a.length;r++){var i=a[r];i.error&&i.key&&(t.items[i.key]=new be.a({message:i.error.message}))}throw new n.a(t)}return Promise.resolve({data:e})})]):[3,4];case 3:_.sent(),_.label=4;case 4:for(U=new D.a,w=0,y=m.items;w<y.length;w++)F=y[w],U.invalidateItems({items:(r={},r[F.key]=[$.deletedFacet],r)}),U.resolveItems({items:(a={},a[F.key]=$.deletedFacet.pack({}),a)});e(U.execute()),_.label=5;case 5:return[2]}})})}});function Te(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.serverRelativeItemUrl,i=e.deletionType,n=e.uniqueId,l=e.isFolder,o=e.listId,s=e.itemId,c=Object(E.getWebApiUrl)({webAbsoluteUrl:t,listOrItemFullUrl:r});return c=l?n?c.method("GetFolderById",n):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}):o&&s?c.method("Lists",o).method("GetItemById",s):c.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a}),i===Se.Recycle&&(c=c.segment("recycle")),c.toString()}function Ne(e,t){var r=e.items,a=e.deletionType===Se.PermanantDelete?"DELETE":"POST",i=e.deletionType===Se.PermanantDelete?"If-Match: *":he.defaultBatchRequestPostData,n=r.map(function(t){return Te({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.itemId})});return he.getBatchContentExtended(t,n,a,i)}var xe=r("5e76ddf6bb30811ee697"),De=r("fcf654cc44d7ec457fe0"),Ke=r("ec569ac9f2e5cb113534"),Re=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.names;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b,f,m,p,v,h,g,U,w,y,F,_,I,O;return i.__generator(this,function(A){switch(A.label){case 0:if(l=Object.keys(r)[0],o=r[l].newName,s=e(Object(P.a)(function(e){return e.demandItem({existingFileName:$.fileNameFacet,spItemKey:d.C,listItemId:N.bb},t)})),c=s.existingFileName,u=s.spItemKey,b=s.listItemId,f=u||d.C.deserialize(t),!(m=b||f.itemId))throw new Error("Cannot find itemId for itemKey: "+t);return p=f.rootFolder||new De.SimpleUri(f.listFullUrl).path,v=new xe.a({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}),h=v.getUrlParts({path:p}),g=v.getUrlParts({path:f.webAbsoluteUrl}),U=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(E.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).toString()}({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,itemId:m}),w={},(y=g.serverRelativeItemUrl)?[3,2]:[4,e(Object(x.c)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:(S={webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl},C=S.webAbsoluteUrl,j=S.listFullUrl,k=Object(E.getListApiUrl)({webAbsoluteUrl:C,listFullUrl:j}).segment("ParentWeb").segment("ServerRelativeUrl"),k.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){y=e.d.ServerRelativeUrl})];case 1:A.sent(),A.label=2;case 2:return!y&&h.serverRelativeListUrl&&((F=h.serverRelativeListUrl.indexOf("/lists/"))<0&&(F=h.serverRelativeListUrl.lastIndexOf("/")),F>=0&&(y=h.serverRelativeListUrl.substring(0,F))),(_=h.serverRelativeListUrl)&&(w.__metadata={type:Object(Ke.b)(_,y)}),I=c&&c.extension?o+c.extension:o,w.FileLeafRef=I,(O={})["X-HTTP-Method"]="MERGE",O["If-Match"]="*",[4,e(Object(x.c)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:U,method:"POST",body:JSON.stringify(w),additionalHeaders:O,qosName:"renameItem",qosHandler:function(e){return e.status===be.b?{resultType:fe.b.expectedFailure}:e.code&&e.code.indexOf("-2130575257")>-1?{resultType:fe.b.expectedFailure}:{resultType:fe.b.failure}}})).catch(function(e){if(e instanceof x.a&&e.errorData.status===be.b)throw new be.a({facets:i.__assign({},Ce.k.pack({})),innerError:e});throw e})];case 3:return A.sent(),e(Object(_e.b)({items:(a={},a[t]=[$.displayNameFacet],a)})),e(Object(G.a)({items:(n={},n[t]=i.__assign({},$.displayNameFacet.pack(c&&c.extension?o+c.extension:o),$.fileNameFacet.pack({name:o,extension:c&&c.extension||""})),n)})),[2]}var S,C,j,k})})}});var Pe=r("3c88ca8e24c9c99ad593"),Le=r("4986dedaa57d766e48bb")._dyjnt3SdKkvQeou8Lavmyg,Ee=r("cfef2ab49d0d7bc1e869"),ze=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({key:d.C,permissions:N.ob,isCheckedOut:$.isCheckedOutFacet,rowData:N.tb},r),n=a.key,l=a.permissions,o=a.isCheckedOut,s=a.rowData,c=n&&e.demandItemFacet(N.Mb,d.U.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})),u=!(!c||c.isAnonymousGuestUser||!Pe.a.hasItemPermission({permissions:l},Pe.a.editListItems)||!Pe.a.hasItemPermission({permissions:l},Pe.a.deleteListItems)),b=s&&c&&o&&!!o.byOther,f=Ee.a;return!c||c.supportPoundStorePath&&c.supportPercentStorePath||(f=Ee.b),i.__assign({isAvailable:u,validator:f},b?{lockedWarningMessage:Le.FileCheckedoutOrLockedWarning,title:Le.FileCheckedoutOrLockedWarningTitle}:{})}}});var qe=r("fdbcb7664c17b5b4e4d9"),Ve=Object(n.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=e.options,n=a.newDocumentKey,l=a.extension;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,a,o,s,c;return i.__generator(this,function(u){switch(u.label){case 0:return t=d.C.deserialize(r),a=t.rootFolder||new De.SimpleUri(t.listFullUrl).path,o=new xe.a({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}}),s=o.getUrlParts({path:a}),c=s.fullItemUrl,[4,e(Object(x.c)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Me({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:s.listRelativeItemUrl||"",extension:l}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var a,l,o=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!o)throw"Fail to create custom document";var s=c+"/"+o;e(Object(G.a)({items:(a={},a[n]=i.__assign({},$.displayNameFacet.pack(o),$.canonicalUrlFacet.pack(s)),a)})),e(Object(_e.b)({items:(l={},l[r]=[qe.b],l)}))})];case 1:return u.sent(),[2]}})})}});function Me(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.extension,i=e.parentFolderPath;if(!a)throw new Error("document extension is not valid");return Object(E.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:a}).toString()}var Be=r("ea854ccf8505a6610cbf"),Ge=r("dafd9db62310f1337c17"),He=r("0515cc2a21866a8c8924"),We=(r("c4e199bc4bcd0fb7cb54"),r("973c205c4a5eb301c7ad"),r("909f685fd22f763fd12f"));var Je=r("74f05cfae7f0304885c9");function Qe(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var r=Je.a(t);if(!r)throw new Error("Filter could not be serialized");var a=Xe(e,t.id);if(a){var i=void 0;try{i=We.i(r).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}a.parentNode.replaceChild(i,a),e.setIsDirty(!0,He.a.filters)}else e.addFilters([r])}function Xe(e,t){var r=e.getDomParts();if(r&&r.where){var a=r.where.querySelectorAll('[id="'+t+'"]');if(a.length>1)throw new Error("More than one filter found with id "+t);return a[0]}}var Ze=r("3e9477666d09125bf1bf");function $e(e){var t=e.sourceView,r=e.deserializedItemSetKey,a=e.appliedFilters,i=new Ge.a(t.getEffectiveViewXml());if(r.sortFieldKey&&i.updateSort({fieldName:r.sortFieldKey,isAscending:r.sortAscending},{overwriteAll:!0}),r.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:r.groupByFieldKey,isAscending:!0}}),a)for(var n in a){if(a.hasOwnProperty(n))Qe(i,a[n])}try{var l=Object(Ze.a)(t.id,!0);l&&(i.updateColumnWidths(l),Object(Ze.b)(t.id))}catch(e){}return i}var Ye=Object(n.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,r=e.options.views;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b,f,m,p,v,h,g,U,y,F,_,I;return i.__generator(this,function(O){return a=d.K.deserialize(t),n=Object.keys(r)[0],l=r[n],o=l.sourceView,s=l.isPublic,c=l.itemSetKey,u=l.progressItemKey,o&&a?(b=e(Object(X.a)({deserializedItemSetKey:d.r,filterableSet:N.Db,childItems:qe.a,parentItem:qe.e,schema:qe.f},c)),f=b.deserializedItemSetKey,m=b.filterableSet,p=b.childItems,v=b.parentItem,h=b.schema,(g=f?$e({sourceView:o,deserializedItemSetKey:f,appliedFilters:m&&m.appliedFilters}):o).prepareForSaving(),U=Object(E.getListApiUrl)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).segment("Views").segment("Add"),I=o.getEffectiveAggregatesFieldXml(),[2,e(Object(x.c)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:U.toString(),method:"POST",body:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:o.getEffectiveFieldNames()},Query:g.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!s,RowLimit:o.rowLimit}}),qosName:"addView",noRedirect:!0})).then(function(t){var r,a,n;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var l=t.d;F={viewId:me.default.normalizeLower(l.Id,!1)},y=new Ge.a(t.d),Object(Ze.c)(y);var o=new D.a;return o.resolveItems({items:(r={},r[d.ab.serialize(F)]=i.__assign({},d.ab.pack(F),N.ub.pack(l),N.j.pack(y),N.vb.pack(!1)),r)}),f&&(_=d.r.serialize(i.__assign({},f,{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:F})),o.resolveItems({items:(a={},a[_]=i.__assign({},p?qe.a.pack(p):{},v?qe.e.pack(v):{},h?qe.f.pack(h):{}),a)})),u&&o.resolveItems({items:(n={},n[u]=i.__assign({},d.ab.pack(F)),n)}),e(o.execute())}).then(function(){var r,a;if(o.scope||I){var n={};return o.scope&&(n.scope=o.scope),e(Object(ue.a)({enableModernColumnTotalsSettings:N.w})).enableModernColumnTotalsSettings&&I&&(n.aggregations=I),e(Object(w.a)({items:(r={},r[t]={views:(a={},a[y.id]=i.__assign({},n),a)},r)}))}}).then(function(){var r,a;return e(Object(_e.b)({items:i.__assign((r={},r[t]=[qe.a],r),I?(a={},a[d.ab.serialize(F)]=[N.wb],a):{})}))})]):[2]})})}}),et=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.views;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s;return i.__generator(this,function(c){return a=d.K.matches(t)&&d.K.deserialize(t),n=Object.keys(r)[0],a&&n?(l=r[n],o=Object(E.getListApiUrl)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).method("Views",n),s={__metadata:{type:"SP.View"},DefaultView:l.isDefault,Title:l.title},"number"==typeof l.scope&&(s.Scope=l.scope),l.aggregations&&(s.Aggregations=l.aggregations,s.AggregationsStatus="On"),[2,e(Object(x.c)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:o.toString(),method:"POST",body:JSON.stringify(s),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var r,a,o=e(Object(X.a)({childItems:qe.a},t)).childItems;if(o){for(var s=new D.a,c=d.ab.serialize({viewId:n}),u=void 0,b=void 0,f=void 0,m=0,p=o.itemKeys;m<p.length;m++){var v=p[m],h=e(Object(X.a)({view:N.j},v)).view;h&&(h.isDefault&&(u=h,b=v),v===c&&(f=h))}return"boolean"==typeof l.isDefault&&(l.isDefault&&u&&b&&(u.isDefault=!1,s.resolveItems({items:(r={},r[b]=i.__assign({},N.j.pack(u)),r)})),f&&c&&(f.isDefault=l.isDefault,s.resolveItems({items:(a={},a[c]=i.__assign({},N.j.pack(f)),a)}))),e(s.execute())}})]):[2]})})}}),tt=r("98da34addf7164483ddc"),rt={key:d.W,displayName:$.displayNameFacet,email:tt.emailFacet,picture:tt.pictureFacet},at=Object(n.e)()(function(e){var t=this,r=e.itemKey,a=d.h.deserialize(r),n=a&&a.spItem,l=n.webAbsoluteUrl,o=n.listFullUrl,s=n.itemId;return function(e,a,n){return i.__awaiter(t,void 0,void 0,function(){var t,a,n,c,u,b,f;return i.__generator(this,function(m){switch(m.label){case 0:return a=s&&Object(E.getListApiUrl)({webAbsoluteUrl:l,listFullUrl:o}).method("GetItemById",s).segment("likedByInformation"),n=new D.a,(u=a)?[4,e(Object(x.e)({url:a.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:l,listFullUrl:o}))]:[3,2];case 1:u=m.sent(),m.label=2;case 2:return b=[],(f=(c=u)&&c.d&&c.d.likedBy&&c.d.likedBy.results)&&f.forEach(function(e){var t,r=e.email,a=d.W.serialize({id:String(r)});n.resolveItems({items:(t={},t[a]=Object(v.d)(rt,{key:{id:String(r)},displayName:e.name,email:r,picture:r}),t)}),b.push(a)}),n.resolveItems({items:(t={},t[r]=i.__assign({},$.likedByPeopleFacet.pack({personKeys:b})),t)}),e(n.execute()),[2]}})})}});var it,nt=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.views,n=r.qosName;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,l,o,s,c,u,b,f,m,p,v,h,g,U,w,y;return i.__generator(this,function(i){return r=d.K.deserialize(t),l=Object.keys(a)[0],r&&l&&(o=a[l],s=o.itemSetKey,c=o.shouldSaveViewFieldsOnly,u=o.newDocumentTemplatesJsonString,b=o.shouldSaveAggregationsOnly,f=e(Object(X.a)({deserializedViewKey:d.ab,currentDerivedView:N.j},l)),m=f.deserializedViewKey,p=f.currentDerivedView,v=m&&m.viewId,p&&v&&(h=void 0,c||u||b?p.baseViewXml&&(h=new Ge.a(p.baseViewXml),c?h.replaceFields(p.getEffectiveFieldNames()):u?h.updateNewDocumentTemplates(u):b&&h.replaceAggregates(p.getEffectiveAggregatesData())):(g=e(Object(X.a)({deserializedItemSetKey:d.r,filterableSet:N.Db},s)),U=g.deserializedItemSetKey,w=g.filterableSet,U&&(h=$e({sourceView:p,deserializedItemSetKey:U,appliedFilters:w&&w.appliedFilters}))),h&&(h.prepareForSaving(),p.isDirty()||h.isDirty())))?(y=Object(E.getListApiUrl)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",v).method("SetViewXml"),[2,e(Object(x.c)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:y.toString(),method:"POST",body:JSON.stringify({viewXml:h.getEffectiveViewXml()}),qosName:n||"saveView"}))]):[2]})})}}),lt=r("5004fc2f3329649ad54d"),ot=r("87e95cd1ff4b249d307f"),st=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.columnModifyTypeMap;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b,f,m,p,v,h,g,U,w,F,_,I,O;return i.__generator(this,function(A){switch(A.label){case 0:if(!(s=e(Object(X.a)({setKey:d.r},t)).setKey))return[3,3];if(c=Object.keys(r)[0],u=r[c],b=u.modifyType,f=u.targetIndex,!(m=s.viewKey?d.ab.serialize(s.viewKey):void 0))return[3,3];if(!(p=e(Object(X.a)({currentDerivedView:N.j},m)).currentDerivedView))return[3,3];if(v=p.getEffectiveFieldNames(),!(h=e(Object(X.a)({internalName:N.Q},c)).internalName))return[3,3];if((g=v.indexOf(h))<0||1===b&&0===g||2===b&&g===v.length-1)return[2];switch(U=p.isDirty(),b){case 0:p.updateField(h);break;case 1:p.updateField(h,g-1);break;case 2:p.updateField(h,g+1);break;case 3:p.updateField(h,f)}return w={ODB:1318},F=e(Object(P.a)(function(e){return e.demandItemFacet(N.Mb,d.U.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))})),_=e(Object(P.a)(function(e){return Object(lt.a)(e,{feature:w,pageContext:F})})),I=!1,_?[4,e(Object(y.a)({items:(a={},a[d.K.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})]={views:(n={},n[m]={shouldSaveViewFieldsOnly:!0},n),qosName:"autoSaveModifyColumn"},a)})).then(function(){U||(p.baseViewXml=p.getEffectiveViewXml()),I=!0},function(e){throw ot.default.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:h,modifyType:b,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),e})]:[3,2];case 1:A.sent(),A.label=2;case 2:O=new D.a,_&&I||O.resolveItems({items:(l={},l[m]=i.__assign({},N.vb.pack(!0)),l)}),O.invalidateItems({items:(o={},o[t]=[qe.a],o[m]=[N.j],o)}),e(O.execute()),A.label=3;case 3:return[2]}})})}}),ct=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,a,n,l,o;return i.__generator(this,function(s){return a=Object.keys(t)[0],n=t[a],l=n.updateType,o=n.formatter,0===l?[2,e(Object(G.a)({items:(r={},r[a]=i.__assign({},N.k.pack(o)),r)}))]:[2]})})}}),ut=r("d6e6a1e726db94fe6759"),dt=r("4986dedaa57d766e48bb")["_5CoIJg/6Hl4qwvkQ8ev5+w"],bt=r("9c98f89a0e31dc353072"),ft=r("3da5d317c00adfe8f79c"),mt=((it={})[ft.d.started]=function(e,t){return Object(ut.format)(Object(ut.getLocalizedCountValue)(dt.assignToGroupStartedItemsTitle,dt.assignToGroupTitleIntervals,e)||"",e,t)},it[ft.d.completed]=function(e,t){return Object(ut.format)(Object(ut.getLocalizedCountValue)(dt.assignToGroupCompletedItemsTitle,dt.assignToGroupTitleIntervals,e)||"",e,t)},it[ft.d.failed]=function(e,t){return Object(ut.format)(Object(ut.getLocalizedCountValue)(dt.assignToGroupFailedItemsTitle,dt.assignToGroupTitleIntervals,e)||"",e,t)},it[ft.d.canceled]=function(e,t){return Object(ut.format)(Object(ut.getLocalizedCountValue)(dt.assignToGroupFailedItemsTitle,dt.assignToGroupTitleIntervals,e)||"",e,t)},it),pt=Object(n.b)(function(){return function(e){e(Object(_.d)(U,bt.a)(Object(_.a)()(vt)))}});function vt(){return function(e){return ht}}function ht(e,t){var r=t.itemKey,a=Object(h.f)(e,t),n=a.phase,l=a.count,o=mt,s=e.demandItemFacet(qe.a,r),c=s&&s.itemKeys,u="",d="";if(c&&c.length>0){var b=e.demandItemFacet(g,c[0]),f=b&&b.groupKey;f&&(u=e.demandItemFacet($.displayNameFacet,f)||""),d=o[n](l,u)}else{var m=e.demandItemFacet(U,r);if(m){var p=m.taskKey,v=p&&e.demandItemFacet($.displayNameFacet,p);v&&(d=v)}}return i.__assign({},d?{title:d}:{})}var gt=Object(C.d)({operationTypeFacet:g}),Ut=(Object(h.g)({operationTypeFacet:g,progressKeyFacet:U,initializeBatch:function(){return pt}}),r("766d9e7109808f01029d")),wt=r("c21819129ba64362c121"),yt=Object(n.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,n=d.B.deserialize(r),l=n&&n.itemSetKey,o=l.webAbsoluteUrl,s=l.listFullUrl,c=l.rootFolder,u=d.C.serialize({webAbsoluteUrl:o,listFullUrl:s,rootFolder:c}),b=Object.keys(a)[0],f=a[b].progressItemKey;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,n,l,c;return i.__generator(this,function(m){switch(m.label){case 0:return t=e(Object(X.a)({sourceFile:wt.b},b)).sourceFile,[4,e(Object(Ut.a)({itemKey:u,options:{sourceEntries:a}}))];case 1:return n=m.sent(),l=n.itemFromServer.ListItemAllFields.__deferred.uri,c=function(r){var a,n;e(Object(_e.b)({items:(a={},a[u]=[qe.b],a)})),f&&t&&e(Object(G.a)({items:(n={},n[f]=i.__assign({},ft.f.pack({itemKey:r}),Object(v.d)({progressSize:ft.p},{progressSize:{current:t.size}})),n)}))},[4,e(Object(x.c)({webAbsoluteUrl:o,listFullUrl:s,url:l,method:"POST",qosName:"getUploadItem",noRedirect:!0})).then(function(t){var a,i=t.d.ID,n=d.C.serialize({webAbsoluteUrl:o,listFullUrl:s,itemId:i});e(gt({items:(a={},a[n]={groupKey:r},a)})).then(function(){c(n)},function(e){c(n)})},function(e){var t=n.properties&&n.properties.ID,r=d.C.serialize({webAbsoluteUrl:o,listFullUrl:s,itemId:t});c(r)})];case 2:return m.sent(),[2]}})})}});var Ft=r("85bfca0cd3bb87373c39"),_t=Object(n.e)({maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,a=d.K.deserialize(r),n=a.webAbsoluteUrl,l=a.listFullUrl;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,o,s,c,u,b,f,m,p,v,h,g,U;return i.__generator(this,function(w){switch(w.label){case 0:return c=[],u=new D.a,b=e(Object(X.a)({pageContext:N.Mb},d.U.serialize({webAbsoluteUrl:n,listFullUrl:l}))),f=d.J.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),m=e(Object(X.a)({list:N.Z},f)),p=e(Object(ue.a)({localeConfiguration:R.localeFacet})).localeConfiguration,[4,e(Object(Ft.a)({webAbsoluteUrl:n,listFullUrl:l,listTemplate:m.list&&m.list.templateType,preferredLanguage:p&&p.language}))];case 1:return v=w.sent(),h={},g=void 0,U=[],v.filter(function(e){return!!e.view}).map(function(e){var t,r,a,o=e.serverView,s=e.view,f=s.id,p={viewId:f},v=d.ab.serialize(p);if(b&&b.pageContext&&m&&m.list&&m.list.id&&(a=function(e){var t=e.webAbsoluteUrl,r=e.layoutsUrl,a=e.viewId,i=e.listId,n=e.sourceUrl;return t+"/"+r+"/ViewEdit.aspx?"+Object(L.a)({View:me.default.normalizeUpper(a,!0),List:me.default.normalizeUpper(i,!0),Source:n})}({webAbsoluteUrl:n,layoutsUrl:b.pageContext.layoutsUrl,viewId:f,listId:m.list.id,sourceUrl:o.ServerRelativeUrl})),s.isDefault){g=v;var w=s.getDomParts().newDocumentTemplates;if(w&&w.textContent)try{if((U=JSON.parse(w.textContent)).length)for(var y=0,F=U;y<F.length;y++){var _=F[y];if(_.url){var I=d.N.serialize({templateUrl:_.url,listKey:{webAbsoluteUrl:n,listFullUrl:l}});u.resolveItems({items:(t={},t[I]=i.__assign({},N.ib.pack(_)),t)})}_.templateId||(_.isUpload?_.templateId=_.title:_.isContentType&&_.contentTypeId&&(_.templateId=_.contentTypeId))}}catch(e){}}h[v]=s,Object(Ze.c)(s),u.resolveItems({items:(r={},r[v]=i.__assign({},d.ab.pack(p),N.ub.pack(o),N.j.pack(s),N.vb.pack(!1),a?$.openUrlFacet.pack(a):{}),r)}),c.push(v)}),u.resolveItems({items:(t={},t[f]=i.__assign({},N.jb.pack(U)),t)}),c.sort(function(e,t){return h[e].compareTo(h[t])}),u.resolveItems({items:(o={},o[r]=i.__assign({},d.K.pack(a),qe.a.pack({itemKeys:c})),o)}),g&&u.resolveItems({items:(s={},s[f]=i.__assign({},N.n.pack({viewKey:g})),s)}),e(u.execute()),[2]}})})}});var It=r("5f5048d493ea2dbbba13"),Ot=r("f553bf0f97ddfedc1f32"),At=r("4d934992108cb28aa92f"),St=r("52ea8189ec1bd7bba704"),Ct=r("5730cedeedcb5640bb56"),jt=r("843110fa06f12b102717");function kt(e,t,r){var a=Object(E.getListApiUrl)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(i){return i(Object(x.e)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:a.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return function(e,t){return Object(Ct.b)(e,t)}(e.d.CustomActionElements.Items.results,r)})}}function Tt(e,t){var r=ne.escapeUrlForCallback(e)+"/_layouts/15/tenantappinfo.ashx?etag=0&lcid="+jt.Locale.lcid;return function(a){return a(Object(x.c)({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:r,qosName:"getTenantAppCustomAction",noRedirect:!0})).then(function(e){return e.apps?function(e,t){var r=[];return e.forEach(function(e,a){e.customActions&&(r=r.concat(Object(Ct.c)(e.customActions,t)))}),r}(e.apps,t):[]})}}var Nt=r("00620f24248a4f158ff6"),xt=r("bffb0e7cd108ce57e381"),Dt=r("982f2ce1b1e042585250"),Kt={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},Rt=Object(n.e)()(function(e){var t=this,r=e.itemKey,a=d.g.deserialize(r),n=a.webAbsoluteUrl,l=a.listFullUrl,o=a.spfxLoaded,s=a.itemsScopeItemKey,c=d.c.serialize({webAbsoluteUrl:n,listFullUrl:l});return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,a,u,b,f,m,p,v,h,g,U,w,y;return i.__generator(this,function(F){switch(F.label){case 0:return a=qt(e,n,l),u=d.J.serialize({webAbsoluteUrl:n,listFullUrl:l}),[4,e(Object(K.a)(function(e){return{listViewAdapter:e.demandItemFacet(At.g,u)}}))];case 1:return b=F.sent().listViewAdapter,f=new D.a,!b&&o&&s?(m=e(Object(P.a)(xt.a)))?[4,m()]:[3,5]:[3,5];case 2:return p=F.sent(),v=!1,p?(b=p.createListViewAdapter(),f.resolveItems({items:(t={},t[u]=i.__assign({},b?At.g.pack(b):{}),t)}),[4,e(Object(K.a)(function(e){var t=e.demandItemFacet(Dt.c,s),r=t&&t.itemKey;if(r&&b){var a=e.demandItemFacet(qe.a,r),n=a&&a.itemKeys,l=function(t){var r,a=e.isItemFacetResolved(N.tb,t)?e.demandItemFacet(N.tb,t):void 0;if(a&&b){var n=b.createRowAdapter({values:a});f.resolveItems({items:(r={},r[t]=i.__assign({},n?At.h.pack(n):{}),r)})}else if(d.B.matches(t)){var o=e.isItemFacetResolved(qe.a,t)?e.demandItemFacet(qe.a,t):void 0;if(o)for(var s=0,c=o.itemKeys;s<c.length;s++){var u=c[s];l(u)}}};if(n)for(var o=0,c=n;o<c.length;o++){var u=c[o];l(u)}var m=e.demandItemFacet(qe.f,r),p=m&&m.columnKeys||[];if(p&&b)for(var h=function(t){var r,a=e.demandItem({fieldId:N.D,internalName:N.Q,realFieldName:N.sb,fieldType:N.C,isRequired:It.d,displayName:$.displayNameFacet,clientSideComponentId:At.a,clientSideComponentProperties:At.b},t),i=a.fieldId,n=a.internalName,l=a.realFieldName,o=a.fieldType,s=a.isRequired,c=a.displayName,u=a.clientSideComponentId,m=a.clientSideComponentProperties;if(u&&u!==me.default.Empty&&i&&n){v=!0;var p={internalName:n},h={id:i,internalName:l||n,fieldType:o||"Text",isRequired:s||!1,isVisible:!0,displayName:c||"",clientSideComponentId:u||me.default.Empty,clientSideComponentProperties:m||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+n+",\n                        componentId: "+u+", error: "+e.message)}},g=d.l.serialize(p),U=b.addColumnAdapter(h);f.resolveItems({items:(r={},r[g]=At.c.pack(U),r[t]=At.d.pack(g),r)})}},g=0,U=p;g<U.length;g++){var w=U[g];h(w)}}}))]):[3,5];case 3:return F.sent(),v?[4,b.loadFieldCustomizers()]:[3,5];case 4:F.sent(),F.label=5;case 5:return[4,e(kt(n,l,a))];case 6:return h=F.sent(),[4,e(Object(K.a)(function(e){return{enableDebugClientSideExtensions:e.demandItemFacet(N.q,R.configurationItemKey)}}))];case 7:return(g=F.sent().enableDebugClientSideExtensions)&&g.customActions&&function(e,t){if(!t)return;var r=e.ContextMenu||[],a=e["Ribbon.Documents"]||[],n=e["Ribbon.List"]||[],l={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var o=JSON.parse(t);if(o)for(var s=0,c=Object.keys(o);s<c.length;s++){var u=c[s];try{var d=o[u],b=d.location,f=d.properties,m={text:l[b],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:u,clientSideComponentProperties:"object"==typeof f?JSON.stringify(f):""},p=b===Kt.CommandSet,v=b===Kt.ContextMenu||p,h=b===Kt.CommandBar||p;v&&r.push(m),h&&(a.push(i.__assign({},m)),n.push(i.__assign({},m)))}catch(e){console.log("Error processing query parameter for "+u)}}}catch(e){console.log("error in parsing query parameter for custom actions")}}(h,g.customActions),U=a.isDocumentLibrary,[4,Et({setKey:r,actions:h[U?"Ribbon.Documents":"Ribbon.List"],listViewAdapter:b})];case 8:return w=F.sent().itemResolver,[4,Et({setKey:c,actions:h.ContextMenu,listViewAdapter:b})];case 9:return y=F.sent().itemResolver,f.merge(y),f.merge(w),e(f.execute()),[2]}})})}}),Pt=Object(n.e)()(function(e){var t=this,r=e.itemKey,a=d.db.deserialize(r),n=a.webAbsoluteUrl,l=a.listFullUrl;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:return t=qt(e,n,l),[4,e(Tt(n,t))];case 1:return a=i.sent(),[4,Et({setKey:r,actions:a})];case 2:return o=i.sent().itemResolver,e(o.execute()),[2]}})})}}),Lt=Object(n.e)()(function(e){var t=this,r=e.itemKey,a=d.e.deserialize(r);return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,n,l,o;return i.__generator(this,function(s){return n=new D.a,l=d.g.serialize(a),o=d.db.serialize(a),n.resolveItems({items:(t={},t[r]=i.__assign({},St.g.pack(!0),qe.a.pack({itemKeys:[l,o]})),t)}),e(n.execute()),[2]})})}});function Et(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,a,n,l,o,s,c,u,b,f;return i.__generator(this,function(m){switch(m.label){case 0:r=e.setKey,a=e.actions,n=e.listViewAdapter,l=new D.a,o=[],s=0,c=function(e){var t,r,a,c,u,b,f,m,p,v,h,g,U,w,y,F;return i.__generator(this,function(_){switch(_.label){case 0:if(a=[],!Object(Ct.a)(e))return[3,6];c=e.children,u=0,b=0,f=c,_.label=1;case 1:return b<f.length?(m=f[b],p=m.id?m.id:m.text+s+"."+u,v=d.d.serialize({actionId:p}),Vt(m)?[3,2]:(l.resolveItems({items:(t={},t[v]=i.__assign({},$.displayNameFacet.pack(m.text),$.openUrlFacet.pack(m.action),Ot.a.pack(m.allowMultiSelect),Ot.c.pack(m.isEnabled||!1),Ot.b.pack(m.iconUrl)),t)}),[3,4])):[3,6];case 2:return n?[4,zt({action:m,listViewAdapter:n})]:[3,4];case 3:h=_.sent(),w=h.actionKeys,U=h.itemResolver,l.merge(U),w.forEach(function(e){a.push(e)}),_.label=4;case 4:a.push(v),u++,_.label=5;case 5:return b++,[3,1];case 6:return!Object(Ct.a)(e)&&Vt(e)&&n?[4,zt({action:e,listViewAdapter:n})]:[3,8];case 7:return g=_.sent(),U=g.itemResolver,w=g.actionKeys,l.merge(U),o=o.concat(w),[3,9];case 8:!Object(Ct.a)(e)&&Vt(e)||(y=e.id?e.id:e.text+s.toString(),F=d.d.serialize({actionId:y}),l.resolveItems({items:(r={},r[F]=i.__assign({},$.displayNameFacet.pack(e.text),qe.a.pack({itemKeys:a}),$.openUrlFacet.pack(Object(Ct.a)(e)?"":e.action),Object(Ct.a)(e)?{}:Ot.a.pack(e.allowMultiSelect),Object(Ct.a)(e)?{}:Ot.c.pack(e.isEnabled||!1),Object(Ct.a)(e)?{}:Ot.b.pack(e.iconUrl)),r)}),o.push(F)),_.label=9;case 9:return s++,[2]}})},u=0,b=a,m.label=1;case 1:return u<b.length?(f=b[u],[5,c(f)]):[3,4];case 2:m.sent(),m.label=3;case 3:return u++,[3,1];case 4:return l.resolveItems({items:(t={},t[r]=i.__assign({},St.g.pack(!0),qe.a.pack({itemKeys:o})),t)}),[2,{itemResolver:l}]}})})}function zt(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,a,n,l,o,s;return i.__generator(this,function(c){switch(c.label){case 0:return t=e.action,r=e.listViewAdapter,a=new D.a,n=[],l=t.clientSideComponentId&&t.clientSideComponentId.toString()||"",o=t.clientSideComponentProperties||"",l&&l!==me.default.Empty?[4,r.loadCommandSet(l,o).catch(function(){})]:[2,{itemResolver:a,actionKeys:[]}];case 1:return(s=c.sent())&&s.commandAdapters&&s.commandAdapters.forEach(function(e){var r,l=t.clientSideComponentId+"."+e.commandId,o=d.d.serialize({actionId:l});a.resolveItems({items:(r={},r[o]=i.__assign({},$.displayNameFacet.pack(e.title),$.openUrlFacet.pack(t.action),Ot.a.pack(t.allowMultiSelect),Ot.c.pack(t.isEnabled||!1),Ot.b.pack(e.iconUrl||t.iconUrl),At.e.pack(e)),r)}),n.push(o)}),[2,{itemResolver:a,actionKeys:n}]}})})}function qt(e,t,r){var a=e(Object(X.a)({pageContext:N.Mb},d.U.serialize({webAbsoluteUrl:t,listFullUrl:r}))),i=e(Object(X.a)({list:N.Z},d.J.serialize({webAbsoluteUrl:t,listFullUrl:r})));return{currentUserIsSiteAdmin:a.pageContext&&a.pageContext.isSiteAdmin||!1,listTemplate:i.list&&i.list.templateType||Nt.ListTemplateType.invalidType,listId:i.list&&i.list.id||"",isDocumentLibrary:i.list&&i.list.isDocumentLibrary}}function Vt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==me.default.Empty)||!1}var Mt=r("275976081ce1abf67779"),Bt=r("455751f14e5c7456742c");function Gt(e){var t=e.serverRelativeItemUrl,r=e.dataRequestor,a=e.webApiUrl,i=e.duration,n=void 0===i?1:i,l=e.authToken,o=a;return o=(o=o.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",n),r.getData({url:o.toString(),method:"GET",authToken:l,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}var Ht=r("df0590cb07119b259360"),Wt=r("c42c356815f80924f647"),Jt=r("aa112348dbd293212a65"),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultRender,r=i.__rest(e,["defaultRender"]);return t?Mt.createElement(t,i.__assign({},r,{preferOpenInBrowser:!0})):null},t}(Mt.PureComponent),Xt=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKeys,a=r[0],n=e.demandItemFacet($.folderFacet,a),l=e.demandItemFacet(je.b,a);return 1!==r.length||n||l?r.length>0?function(e,t){var r=t.itemKeys,a=e.demandItemFacet(d.C,r[0]);if(!a||!a.webAbsoluteUrl||!a.listFullUrl)return{};var n=a.webAbsoluteUrl,l=a.listFullUrl,o=d.J.serialize({webAbsoluteUrl:n,listFullUrl:l}),s=e.demandItem({listFacets:N.Z,downloadZipApiUrl:Ht.a},o),c=s.listFacets,u=s.downloadZipApiUrl;if(!c||!u||c.templateType===Nt.ListTemplateType.webPageLibrary)return{};for(var b=[],f=0,m=r;f<m.length;f++){var p=m[f],v=e.demandItem({name:$.displayNameFacet,size:$.fileSizeFacet,itemUrl:$.vroomUrlFacet,folder:$.folderFacet,permissions:N.ob,itemComplianceStatus:Wt.a,isOneNote:je.b},p),h=v.name,g=v.size,U=v.itemUrl,w=v.folder,y=v.permissions,F=v.itemComplianceStatus,_=v.isOneNote;if(_)return{isAvailable:!1};if(!U)return{};var I=e.demandItemFacet(Ht.b,o),O=Object(Bt.getItemUrlWithToken)(U,(I?I.accessToken:void 0)||"");if(O){var A=!!w;3!==F&&4!==F&&Pe.a.hasItemPermission({permissions:y},Pe.a.openItems)&&b.push({name:h||"",size:g||0,docId:O,isFolder:A})}}if(0===b.length)return{};return{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.zipApiUrl,l=e.itemsData;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return t=l&&l[0]&&l[0].docId,o=void 0,t&&-1!==t.indexOf("access_token")?[3,2]:[4,e(Object(x.b)({url:r||a}))];case 1:o=i.sent(),i.label=2;case 2:return s=l&&1===l.length?l[0].name+".zip":"OneDrive_"+ ++Zt+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip",c=me.default.generate(),[2,{url:n,method:"POST",postData:{zipFileName:s,guid:c,provider:"spo",files:JSON.stringify({items:l}),oAuthToken:o||""}}]}})})}}({webAbsoluteUrl:n,listFullUrl:l,zipApiUrl:u,itemsData:b})}}}(e,{itemKeys:r}):{}:function(e,t){var r=t.itemKey,a=e.demandItem({spItem:d.C,permissions:N.ob,folderPath:N.G,itemComplianceStatus:Wt.a},t.itemKey),n=a.spItem,l=a.permissions,o=a.folderPath,s=a.itemComplianceStatus,c=e.demandItemFacet($.malwareDetectedFacet,t.itemKey),u=n&&d.U.serialize(n),b=e.demandItemFacet(N.Mb,u);if(!b||!n)return{};var f=n.webAbsoluteUrl,m=n.listFullUrl,p=d.J.serialize(n),v=e.demandItemFacet(N.Z,p);if(v&&v.templateType===Nt.ListTemplateType.webPageLibrary)return{};if(3===s||4===s||!Pe.a.hasItemPermission({permissions:l},Pe.a.openItems))return{};if(c){if(!b.allowInfectedDownload)return{};var h=e.demandItemFacet($.canonicalUrlFacet,r);if(!h)return{};var g=Object(Jt.a)(e,{spCookieDomainConfiguration:N.yb,enableMalwareDownloadInNewWindow:N.u}),U=g.spCookieDomainConfiguration,w=g.enableMalwareDownloadInNewWindow;return w?{isAvailable:!0,downloader:Qt,getDownloadData:function(){return $t({canconicalUrl:h})}}:U?new De.SimpleUri(U).authority!==new De.SimpleUri(h).authority?{}:{isAvailable:!0,getDownloadData:function(){return $t({canconicalUrl:h})}}:{}}if(!o)return{};var y=b.layoutsUrl;if(!y)return{};return{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.folderPath;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,l,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return t=e(Object(x.d)({webAbsoluteUrl:r,listFullUrl:a})),l=t.dataRequestor,o=t.hasDigest,[4,e(Object(x.b)({url:r||a,disallowCookies:!o}))];case 1:return s=i.sent(),c=Object(E.getWebApiUrl)({webAbsoluteUrl:r,listOrItemFullUrl:a}),[4,Gt({dataRequestor:l,authToken:s,serverRelativeItemUrl:n,webApiUrl:c})];case 2:return[2,{url:i.sent(),method:"GET"}]}})})}}({webAbsoluteUrl:f,listFullUrl:m,folderPath:o,layoutsUrl:y})}}}(e,{itemKey:a})}}});var Zt=0;function $t(e){var t=this;return function(r){return i.__awaiter(t,void 0,void 0,function(){var t;return i.__generator(this,function(r){return(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1"),[2,{url:t,method:"GET"}]})})}}var Yt=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({permissions:N.ob},r).permissions;return{isAvailable:Pe.a.hasItemPermission({permissions:a},Pe.a.deleteListItems)}}}});var er=Object(n.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=d.cb.deserialize(r).webAbsoluteUrl;return function(r){return i.__awaiter(t,void 0,void 0,function(){var t,n,l,o,s;return i.__generator(this,function(c){switch(c.label){case 0:return n=Object(E.getStaticApiUrl)({webAbsoluteUrl:a}).segments("ComponentContextInfo"),[4,r(Object(x.c)({url:n.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:a,noRedirect:!0}))];case 1:return l=c.sent(),o=JSON.parse(l.d.SerializedData),(s=new D.a).resolveItems({items:(t={},t[e.itemKey]=i.__assign({},d.cb.pack({webAbsoluteUrl:a}),N.Mb.pack(o)),t)}),r(s.execute()),[2]}})})}});var tr=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.groupKey;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c,u,b,f,m,p,v,h,g,U,w,y;return i.__generator(this,function(i){switch(i.label){case 0:if(a=e(Object(X.a)({spGroupField:N.Fb,groupValue:N.O,parentGroupKey:N.nb},r)),n=a.spGroupField,l=a.groupValue,o=a.parentGroupKey,s=d.B.matches(r)&&d.B.deserialize(r),c=d.C.deserialize(t),F={webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,itemId:c.itemId||""},_=F.webAbsoluteUrl,I=F.listFullUrl,O=F.itemId,u=Object(E.getListApiUrl)({webAbsoluteUrl:_,listFullUrl:I}).method("Items",O).method("ValidateUpdateListItem").toString(),b=[],f=function(e,t){return{FieldName:e,FieldValue:t,HasException:!1,ErrorMessage:null}},n&&n.internalName&&l&&b.push(f(n.internalName,l)),o&&o.itemKey&&(m=e(Object(X.a)({parentGroupField:N.Fb,parentGroupValue:N.O},o.itemKey)),p=m.parentGroupField,v=m.parentGroupValue,p&&p.internalName&&v&&b.push(f(p.internalName,v))),s&&s.itemSetKey&&s.itemSetKey.filterParams&&(h=le.a.getFilterList(s.itemSetKey.filterParams,void 0,!0)).length>0)for(g=0;g<h.length;g++)U=h[g],w=e(Object(X.a)({isReadOnly:N.T},d.o.serialize({internalName:U.fieldName}))).isReadOnly,1===U.values.length&&!1===w&&b.push(f(U.fieldName,U.values[0]));return(y={}).formValues=b,y.bNewDocumentUpdate=!1,y.checkInComment=null,b.length>0?[4,e(Object(x.c)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:u,method:"POST",body:JSON.stringify(y),qosName:"assignItemToGroup",noRedirect:!0})).then(function(t){var a,i=t.d.ValidateUpdateListItem.results[0];if(i.HasException)throw new Error(i.ErrorMessage||void 0);e(Object(_e.b)({items:(a={},a[r]=[qe.a],a)}))})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}var F,_,I,O})})}});var rr=r("664990b3cc9463570172");function ar(e){for(var t=e,r="",a=0,i=void 0,n=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|n)||(l="=",n%1);r+=l.charAt(63&a>>8-n%1*8)){if((i=t.charCodeAt(n+=.75))>255)throw new Error("Unable to obtain default share URL: btoa failed");a=a<<8|i}return r}var ir=r("37b99d1e7f0c88452ea0"),nr=Object(_.a)()(function(){return function(e){return lr}});function lr(e,t){var r=t.itemKey,a=e.demandItem({driveItem:d.C,canonicalLinkUrl:$.canonicalUrlFacet},r),n=a.driveItem,l=a.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return i.__awaiter(t,void 0,void 0,function(){var t,a,n,l,o,s,c,u,d,b,f;return i.__generator(this,function(i){switch(i.label){case 0:if(t=e.driveItem,a=e.canonicalLinkUrl,t&&a)return[3,1];throw new Error("Unable to obtain default share URL");case 1:if(n=void 0,a){for(l=new ir.a(a),o=l.authority,s=0,c=l.segments;s<c.length;s++)""!==(u=c[s])&&(o=o+"/"+encodeURIComponent(u));d=ar(o.toString()),n="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}return b=new ir.a(t.webAbsoluteUrl).authority,[4,r(Object(x.c)({webAbsoluteUrl:b,listFullUrl:void 0,url:b+"/_api/v2.0/shares/"+n+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(f=i.sent()).value[0].link.webUrl,scope:f.value[0].link.scope}]}})})}}({driveItem:n,canonicalLinkUrl:l})}}}var or=r("809072ae40093b380229"),sr=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.bNewDocumentUpdate,n=r.checkInComment,l=r.formValues,o=r.qosName;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,s,c,u,d;return i.__generator(this,function(i){switch(i.label){case 0:return l.length>0?[4,e(Object(Ie.a)(t))]:[3,3];case 1:return r=i.sent(),s=r.key,c=r.itemId,u=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(E.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).method("ValidateUpdateListItem").toString()}({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:c||s.itemId||""}),(d={}).formValues=l,d.bNewDocumentUpdate=a,d.checkInComment=n,[4,e(Object(x.c)({body:JSON.stringify(d),listFullUrl:s.listFullUrl,method:"POST",qosName:o,url:u,webAbsoluteUrl:s.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:i.sent(),i.label=3;case 3:return[2]}})})}});var cr=new v.a("refreshItemsInSet"),ur=Object(C.d)({operationTypeFacet:cr}),dr=r("dc969c026d388e81ff0e");var br=r("7ac3ab87caf33903810b");function fr(e){return function(t){for(var r=e.itemSetKey,a=e.itemKeys,n=t(Object(P.a)(function(e){var t=e.demandItemFacet(d.r,r)||d.r.deserialize(r);return i.__assign({},t,{pageContext:Object(br.a)(e,d.C.serialize(t))})})),l=n.webAbsoluteUrl,o=n.listFullUrl,s=n.pageContext,c=[],u=0,b=a;u<b.length;u++){var f=b[u],m=d.C.deserialize(f).itemId;if(!m)m=t(Object(X.a)({listItemId:N.bb},f)).listItemId;m&&c.push(m)}var p=t(function(e,t){return function(r){var a=r(Object(X.a)({schema:qe.f},t)).schema,i=a&&a.columnKeys,n=[];if(i)for(var l=0,o=i;l<o.length;l++){var s=o[l],c=r(Object(X.a)(e,s));n.push(c)}return n}}({internalName:N.Q},r)),v=[];if(p)for(var h=0,g=p;h<g.length;h++){var U=g[h];U.internalName&&v.push(U.internalName)}return{webAbsoluteUrl:l,listFullUrl:o,currentPageContext:s,qosName:"refreshItemsInSet",viewXml:Object(dr.getViewXml)({itemIds:c,recurseInFolders:!0,pageSize:a.length,fieldNames:v.length>0?v:void 0}),postDataContext:{needsSchema:!0}}}}var mr=r("85b502035ba6002afa5a"),pr=Object(n.e)()(function(e){var t=e.itemKey;return function(r){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,l,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return a=d.r.deserialize(t),n=r(Object(ee.c)({itemSetKey:a})),l=Object.keys(e.options),[4,r(fr({itemSetKey:t,itemKeys:l}))];case 1:return o=i.sent(),[4,r(Object(te.a)(o))];case 2:return s=i.sent(),c=r(Object(mr.a)({serverData:s,itemSetKey:a,currentPageContext:o.currentPageContext,contentTypes:n,isItemSetRequest:!0})).itemResolver,r(c.execute()),[2]}})})}}),vr=r("7a458e85783b71176e85"),hr=Object(_.a)()(function(){return function(e){return gr}});function gr(e,t){var r=t.itemKey,a=t.link,n=t.recipients,l=e.demandItem({driveItem:d.C},r).driveItem;return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return i.__awaiter(t,void 0,void 0,function(){var t,a,n,l,o,s,c,u,d,b;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.driveItem,a=e.link,n=e.recipients,t?(l=void 0,o=ar(a),l="u!"+o.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),s=n.map(function(e){return{email:e}}),c={recipients:s,roles:["read"]},u=new ir.a(t.webAbsoluteUrl).authority,[4,r(Object(x.c)({webAbsoluteUrl:u,listFullUrl:void 0,url:u+"/_api/v2.0/shares/"+l+"/permission/invite",body:JSON.stringify(c),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))]):[3,2];case 1:return d=i.sent(),b=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}}),[2,{recipients:b}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}}({driveItem:l,link:a,recipients:n})}}}var Ur=r("661b65dcf8351e92fe44"),wr=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItemFacet(d.C,r);if(!a)return{};var i={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl},n=e.demandItemFacet(N.Z,d.J.serialize(i)),l=e.demandItemFacet(N.Mb,d.U.serialize(i));if(!l)return{};var o=n&&n.templateType===Nt.ListTemplateType.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:l.currentUICultureName||l.currentCultureName||"en-US",client:o?"OneDrive":"SharePoint",domainHint:"organizations",userId:l.userLoginName}}}}});var yr=r("83f2d47bcced97f0a85c"),Fr=r("4fab54035bc77294dc42"),_r=r("6dec44e5485412f70439"),Ir=r("7f8b22b90e1fa57005a6"),Or=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=void 0,i=e.demandItem({key:d.C,driveItemKey:Fr.a},r),n=i.key,l=i.driveItemKey;if(l)return{driveItemFullUrl:Object(_r.c)(l)};if(n){var o={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl},s=e.demandItem({listMediaFacets:Ir.b},d.J.serialize(o)).listMediaFacets;if(s&&s[".driveUrl"]){var c=s[".driveUrl"],u=n.rootFolder||"",b="";if(u){var f=new xe.a({context:{webAbsoluteUrl:n.webAbsoluteUrl,listUrl:n.listFullUrl}}),m=f.getUrlParts();m.serverRelativeListUrl&&"/"!==(b=u.replace(m.serverRelativeListUrl,"")).charAt(0)&&(b="/"+b)}return{driveItemFullUrl:a=c+"/items/root"+(b?":":"")+b}}}return{driveItemFullUrl:a}}}});var Ar=r("9478e86dcd48357093ed"),Sr=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.aggregateType,n=r.columnKey;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,l,o,s,c,u,b,f,m,p,v,h,g;return i.__generator(this,function(i){switch(i.label){case 0:return(o=e(Object(X.a)({setKey:d.r},t)).setKey)&&((s=o.viewKey?d.ab.serialize(o.viewKey):void 0)&&(c=e(Object(X.a)({currentDerivedView:N.j},s)).currentDerivedView))?(u=e(Object(X.a)({internalName:N.Q,fieldType:N.E,fieldFieldType:N.C},n)),b=u.internalName,f=u.fieldType,m=u.fieldFieldType,b?(p=e(Object(X.a)({spFolderAggregates:N.f},t)).spFolderAggregates,v=c.isDirty(),!(h=p&&p[n]?p[n].aggregateFunctionType:void 0)&&0===a||h===Ar.a[a]?[2]:(g=0===a?void 0:Ar.a[a],c.updateColumnAggregateType(b,g),[4,e(Object(y.a)({items:(r={},r[d.K.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl})]={views:(l={},l[s]={shouldSaveAggregationsOnly:!0},l),qosName:"SaveModifyColumnAggregateType"},r)})).then(function(){var r,a=new D.a;a.invalidateItems({items:(r={},r[t]=[qe.a],r[s]=[N.wb],r)}),e(a.execute())},function(e){throw ot.default.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:f,fieldFieldType:m,currentAggregateType:h||"None",newAggregateType:g||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),c.updateColumnAggregateType(b,h),c.setIsDirty(v),e})])):[3,2]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})}}),Cr=r("f594c3c93ec9f3598a3f"),jr=r("9e7274a6a80450887587"),kr=Object(n.e)()(function(e){var t=e.itemKey,r=e.options,a=r.itemKeys,n=r.bNewDocumentUpdate,l=r.checkInComment,o=r.formValues,s=r.qosName;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,c,u,b,f,m,p,v,h,g,U,w,y,F,_;return i.__generator(this,function(i){switch(i.label){case 0:if(!(o&&o.length&&a&&a.length))return[2];r=d.r.deserialize(t),c=r.viewKey,u=r.rootFolder,b=r.webAbsoluteUrl,f=r.listFullUrl,m=u||"",c&&(!(p=e(Object(X.a)({currentDerivedView:N.j},d.ab.serialize(c))).currentDerivedView)||1!==p.scope&&2!==p.scope||(m="")),v=[],h={},g=0,U=a,i.label=1;case 1:return g<U.length?(w=U[g],[4,e(Object(Ie.a)(w))]):[3,4];case 2:y=i.sent().itemId,v.push(parseInt(y,10)),h[y]=w,i.label=3;case 3:return g++,[3,1];case 4:return F=Object(E.getListApiUrl)({webAbsoluteUrl:b,listFullUrl:f}).method("BulkValidateUpdateListItems").toString(),_={itemIds:v,formValues:o,folderPath:m,bNewDocumentUpdate:n,checkInComment:l},[4,e(Object(x.c)({body:JSON.stringify(_),listFullUrl:f,method:"POST",qosName:s,url:F,webAbsoluteUrl:b,noRedirect:!0})).then(function(r){for(var a,i="",n={},l=0,o=r.d.BulkValidateUpdateListItems.results;l<o.length;l++){var s=o[l];if(s.HasException)i=s.ErrorMessage+"\n"+i;else h[s.ItemId]&&(n[h[s.ItemId]]={})}if(Object.keys(n).length>0&&e(ur({items:(a={},a[t]=n,a)})),i)throw new Error(i)})];case 5:return i.sent(),[2]}})})}}),Tr=r("aa420188fc5b81d114ba"),Nr=r("7fa9594be33133790955"),xr=r("390bac1530ab6cf4e614"),Dr=r("45f20a17936fcb32edb1");r.d(t,"spDataOnlyAddonDeferred",function(){return Kr}),r.d(t,"spItemUploadItemsOperationHandler",function(){return Tr.a}),r.d(t,"spItemCreateFolderOperationHandler",function(){return Nr.b}),r.d(t,"spItemCreateDocumentOperationHandler",function(){return xr.c});var Kr=Object(n.b)(function(){return function(e){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(t){return e(Object(n.f)(d.M,c.a)(re)),e(Object(n.f)(d.p,c.a)(de)),e(Object(n.f)(d.C,f.c)(Ue)),e(Object(n.f)(d.C,m.b)(Oe)),e(Object(n.f)(d.C,p.b)(Ae)),e(Object(n.f)(d.C,l.b)(ke)),e(Object(n.f)(d.C,o.b)(Re)),e(Object(_.d)(d.C,I.a)(ze)),e(Object(n.f)(d.C,u.b)(Ve)),e(Object(n.f)(d.X,b.a)(Be.c)),e(Object(n.f)(d.C,g)(tr)),e(Object(n.f)(d.K,F.b)(Ye)),e(Object(n.f)(d.K,w.b)(et)),e(Object(n.f)(d.K,y.b)(nt)),e(Object(n.f)(d.r,O.b)(st)),e(Object(n.f)(d.r,Cr.b)(Sr)),e(Object(n.f)(d.r,j)(ct)),e(Object(n.f)(d.r,cr)(pr)),e(Object(n.f)(d.r,jr.b)(kr)),e(Object(n.f)(d.B,s.b)(yt)),e(Object(n.f)(d.h,c.a)(at)),e(Object(n.f)(d.K,c.a)(_t)),e(Object(n.f)(d.g,c.a)(Rt)),e(Object(n.f)(d.db,c.a)(Pt)),e(Object(n.f)(d.e,c.a)(Lt)),e(Object(_.d)(d.C,A.a)(Xt)),e(Object(_.d)(d.C,S.b)(Yt)),e(Object(n.f)(d.cb,c.a)(er)),e(Object(n.f)(d.r,B)(J)),e(Object(n.f)(d.r,Q)(Y)),e(Object(_.d)(d.C,Ur.a)(wr)),e(Object(_.d)(d.C,yr.a)(Or)),e(Dr.a),e(k.a),e(T.a),e(M.a),e(V),e(Object(_.d)(d.C,rr.a)(nr)),e(Object(n.f)(d.C,or.a)(sr)),e(Object(_.d)(d.C,vr.a)(hr)),[2]})})}})},f553bf0f97ddfedc1f32:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"c",function(){return n}),r.d(t,"b",function(){return l});var a=r("447964f318fe44ff3682"),i=new a.a("enabledForMultipleItems"),n=new a.a("isEnabledFunction"),l=new a.a("iconUrl")},f594c3c93ec9f3598a3f:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),i=r("022addba5cf25ce091fb"),n=new a.a("modifyColumnAggregateType"),l=Object(i.d)({operationTypeFacet:n})},f698cfbaff8a2434ab85:function(e,t,r){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut"}(a||(a={})),t.a=a}}]);