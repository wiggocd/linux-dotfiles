(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[23],{"0bdd75e78dcb9cfa71d6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("64328bb588b46459132d"),r=a("275976081ce1abf67779"),i=a("646ed378ac0e9617b57e"),o=a("82ff961ec8519623f20a"),s=a("b73e9dbcd106334326ef"),l=a("4086e807fbdd293ec65c"),c=a("670da31dee86af854d96"),u=a("a48ac27d6d227e44e1a5");a("80c1d0bf7c1262a92fd4");var d=a("55c3ef991a028d41e160"),p=o.BasePicker,f=o.BasePickerListBelow,m=function(e){function t(t){var a=e.call(this,t)||this;if(t.dataProvider)a._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");a._dataProvider=new s.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return a._handleGetMoreResultsInBaseClass=!!(a._dataProvider.canUseGraph&&a.props.peoplePickerQueryParams&&a._dataProvider.canUseGraph(a.props.peoplePickerQueryParams))&&!a.props.onGetMoreResults,a.state={hasUnresolvedText:!1,searchForMoreText:a._getSearchForMoreText(a._handleGetMoreResultsInBaseClass)},a}return n.__extends(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.className,a=e.onRenderItem,i=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,s=e.onSelectedPersonasChange,l=e.suggestionsHeaderText,d=e.suggestionsClassName,m=e.noResultsFoundText,b=e.loadingText,h=e.inputProps,y=e.onSuggestionSelected,g=e.suggestionsAvailableAlertText,v=e.enableSelectedSuggestionAlert,_=e.selectedItems,P=e.itemLimit,S=e.onInputChange,w=e.onGetMoreResults,k=e.searchForMoreText,C=e.pickerCalloutProps,x={className:t,onRenderSuggestionsItem:i||c.SuggestionItemDefault,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:_,onChange:s,inputProps:h,enableSelectedSuggestionAlert:v,pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:b,noResultsFoundText:m,className:d,suggestionsAvailableAlertText:g,searchForMoreText:k||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0)},onItemSelected:y,itemLimit:P,onInputChange:S,onGetMoreResults:w||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:C};switch(this.props.peoplePickerType){case u.PeoplePickerType.listBelow:return x.onRenderItem=a||c.SelectedItemBelowDefault,r.createElement(f,n.__assign({},x,{componentRef:this._resolveRef("_peoplePicker")}));default:return x.onRenderItem=a||c.SelectedItemDefault,r.createElement(p,n.__assign({},x,{componentRef:this._resolveRef("_peoplePicker")}))}},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._onResolveSuggestions=function(e){var t=this;if(this._peoplePickerSearchPromise&&(this._peoplePickerSearchPromise.cancel(),this._peoplePickerSearchPromise=void 0),(e=e.trim()).length<2)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],e):[];var a=this._dataProvider.search(e.trim(),this._getPeoplePickerQueryParams());if(!a)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],e):[];var n=a.cached?a.cached:[];return this._peoplePickerSearchPromise=a.promise,this._peoplePickerSearchPromise.then(function(e){return t._peoplePickerSearchPromise=void 0,e?n.concat(e):[]}).then(function(a){return t.props.onResolvedSuggestions?t.props.onResolvedSuggestions(a,e):a})},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:l.default.user|l.default.securityGroup|l.default.sharePointGroup}},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?d.default.searchForMoreText:void 0},t.prototype._onGetMoreResults=function(e){var t;return this.props.peoplePickerQueryParams&&((t=n.__assign({},this.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),this._dataProvider&&this._dataProvider.sharePointSearch&&t?this._dataProvider.sharePointSearch(e,t):[]},n.__decorate([i.autobind],t.prototype,"_onResolveSuggestions",null),n.__decorate([i.autobind],t.prototype,"_getSearchForMoreText",null),n.__decorate([i.autobind],t.prototype,"_onGetMoreResults",null),t}(i.BaseComponent);t.PeoplePicker=m,t.default=m},"2b59a0fb8f81c55fbaf0":function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"a",function(){return i});var n=a("264a40ebead766e0e784"),r=new n.ControlFacet("progressListGroupControl",{}),i=new n.ControlFacet("progressListControl",{groupControlHandler:Object(n.childControlOption)(r)})},"33ce002e6a69ade13405":function(e,t,a){"use strict";var n=a("64328bb588b46459132d"),r=a("5c1e3c3a333c0e96782a"),i=a("c2801f66d553d6a165e0"),o=a("4086e807fbdd293ec65c"),s=a("0b8514f932f40951d460"),l=a("4e087ea06522888b2152"),c=a("60e0518b24b76347603c"),u=a.n(c),d=a("948e07ec1b658aef2b54"),p=a("637f546134386c5b625a"),f=a("cfd15bb212a873934c4b"),m={ODB:1286},b=(function(){function e(e,t){this._dataRequestor=new c.DataRequestor({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO?e:this._pageContext&&this._pageContext.authToken?e:(this._pageContext&&this._oAuthTokenProvider&&f.a.isFeatureEnabled(m)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",p.a.session)),e)},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue("DisableSubstrateSearch",!0,p.a.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return s.default.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new l.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken("https://outlook.office.com/search").then(function(e){return t.end({resultType:l.ResultTypeEnum.Success}),e},function(a){return s.default.isCanceled(a)?(t.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),s.default.reject(a)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:l.ResultTypeEnum.Failure,extraData:{serverErrorCode:a._serverErrorCode,message:a.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:"https://outlook.office.com/search/api/v1/init?scenario=documentshare",headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new d.a("PeoplePicker",p.a.session))}}(),a("5e729a564cfb43974b42")),h=a("1d2727e1b6137177eca9"),y=a("ed82754416f168d14460"),g=a("a24d70c7702f13f024d9"),v=a("cc08c169973ba8efeefa"),_=function(){function e(t){var a;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var n,r,i=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!=(r=i.exec(t));){var l=r[0],c=l.charAt(0),u=l.charAt(l.length-1);if((s="<"===c&&">"===u?e.EmailMatchTypes.Bracketed:'"'===c&&'"'===u?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(n=r,o=s,s===e.EmailMatchTypes.Bracketed))break}var d=t;if(n){a=n[0];var p=n.index,f=p+a.length,m=p>0?t.substr(0,p).trim():"",b=f<t.length?t.substr(f):"";"'"===(a=e.StripBracketsAndQuotesRegex.exec(a)[1]).charAt(0)&&b&&"'"===b.charAt(0)&&(a=a.slice(1),b=b.slice(1).trim()),d=""===m?b:m,this._email=a.trim()}(d=d.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==d.charAt(d.length-2)&&(d=d.replace(/\s*"$/,"")),""!==(d=d.replace(/\//g,""))&&d!==a&&(this._name=d)}}return e.isValidEmailSyntax=function(t,a){return!!t&&!!(a?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var a=e._splitAddresses(t),n=[],r=0,i=a.length;r<i;r++)n.push(new e(a[r]));return n},e.endsWithDelimiter=function(t){if(t){var a=t.split(e.DelimiterRegex);return!a[a.length-1].trim()}return!1},e._splitAddresses=function(t){for(var a=t.split(e.DelimiterRegex),n=a.length-1;n>=0;n--)a[n]=a[n].trim(),0===a[n].length&&a.splice(n,1);return a},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}(),P=a("1c8f7532950b71f6d754");a.d(t,"a",function(){return S});var S=function(e){function t(t,a){var n=this,r=w(t)?t:a.pageContext;n=e.call(this,{},{pageContext:r})||this;var i=w(t)?t.apiUrlHelper:a.apiUrlHelper;return n._imageAbsoluteWebUrl=t.imageAbsoluteWebUrl||"",n._apiUrlHelper=i||new b.a({},{itemUrlHelper:new h.a({},{pageContext:r}),pageContext:r}),n._capabilities={supportsMruCaching:!0},a&&(n._dataRequestor=a.dataRequestor,n._graphPeoplePickerHelper=a.graphPeoplePickerHelper,n._substratePeoplePickerHelper=a.substratePeoplePickerHelper,n._getAuthToken=a.getAuthToken),n}return n.__extends(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return s.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:a,parseResponse:function(e){var a=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},n=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:a(n.Primary),managerChain:n.ManagerChain.results.map(a),directReports:n.DirectReports.results.map(a)};return i.personDetails.profilePage=Object(r.b)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,a=0;e.principalType===o.default.sharePointGroup&&(a=Number(e.rawPersonData.EntityData.SPGroupID));var n=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:a}});return s.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:n,qosName:"getPickerEntityInformation",authToken:a,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var a=this;return s.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return a.dataRequestor.getData({url:a._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:a._constructPostBody(e,t),qosName:"Resolve",authToken:n,parseResponse:function(e){var n=JSON.parse(e),r=JSON.parse(n.d.ClientPeoplePickerResolveUser),i=[];i[0]=r,v.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?r.IsResolved||(i[0].DisplayText=r.Key):r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||(i[0].DisplayText=r.Key);var s=(i=a._transformData(i,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&1===s.entityType?(s.isResolved=!1,s.entityType=0):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=1),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=2,s.principalType=o.default.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new u.a({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new u.a({},{})),t},t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)},t.prototype.sharePointSearch=function(e,t){var a=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return s.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return a.dataRequestor.getData({url:a._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:a._constructPostBody(e,t),qosName:"Search",authToken:n,parseResponse:function(n){var r=t.allowSharePointGroups,i=void 0===r||r,s=t.filterExternalUsers,l=t.forceResolve,c=JSON.parse(n),u=JSON.parse(c.d.ClientPeoplePickerSearchUser),d=a._transformData(u,s);s&&(d=d.filter(function(e){return 1!==e.entityType}));var p=!d.length;if(d=d.filter(function(e){return e.principalType===o.default.sharePointGroup?i:e.principalType===o.default.securityGroup?i||a._isValidEmail(e.email,!0):a._isValidEmail(e.email,!1)}),v.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))l&&p&&d.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===d.length&&a._isValidEmail(e,!1)){var f={Key:e,IsResolved:!1};d.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:f,rawPersonData:f,isExternal:!0})}return d}})})},t.prototype.subscribePresence=function(e,t){var a=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var n=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,n),{dispose:function(){try{a._skypeIntegration.UntrackPresence(e,n)}catch(e){}}}}catch(e){}return null},t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"},t.prototype._constructPostBody=function(e,t){var a={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(a)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,t){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(n){if(!n)return a.sharePointSearch(e,t);var r=new P.default("https://graph.microsoft.com/v1.0/me/people");return e&&r.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName",$filter:"personType/subclass ne 'PublicDistributionList'"}),a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:r.toString(),headers:{Authorization:"Bearer "+n,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(n){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=n.value,i=[];if(r.forEach(function(e){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",n=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,r={Key:n,IsResolved:!1},s="ImplicitContact"===e.personType.subclass,l="OrganizationUser"===e.personType.subclass,c="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,u="PublicDistributionList"===e.personType.subclass,d={department:e.department,email:t,image:s?void 0:Object(y.a)({userLoginName:t}),job:e.jobTitle||t,name:e.displayName,providerName:l?"Provider":void 0,userId:n,rawData:r,rawPersonData:r,isExternal:!l};l?(d.entityType=0,d.principalType=o.default.user,d.isResolved=!0):c?(d.entityType=2,d.principalType=o.default.securityGroup,d.isResolved=!1,d.userId=e.id):(d.principalType=u?o.default.distributionList:o.default.none,d.entityType="Group"===e.personType.class?2:1,d.isResolved=!1,d.providerName=void 0),d.userId&&i.push(d)}),!1!==t.resolveEmailIfNoResults&&0===i.length&&a._isValidEmail(e,!1)){var s={Key:e,IsResolved:!1};i.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:s,rawPersonData:s,isExternal:!0})}return i},function(n){if(Object(g.isGraphError)(n))switch(n.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,t);default:return a.sharePointSearch(e,t)}else"Canceled"!==n.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===n.name?null:a.sharePointSearch(e,t)})})},t.prototype._substrateSearch=function(e,t){var a=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(n){return n?a._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"https://outlook.office.com/search/api/v1/suggestions",headers:{Authorization:"Bearer "+n,"X-User-Context":"litoken="+n},needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Fallback",Provenances:["Mailbox","Directory","LinkedIn"],Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"]}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(n){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=n.Groups[0]?n.Groups[0].Suggestions:[],i=[];if(r.forEach(function(e){var t=e.EmailAddresses[0]||e.QueryText||"",n=e.UserPrincipalName&&a._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:t,r={Key:n,IsResolved:!1},s="ImplicitContact"===e.PeopleSubtype,l="OrganizationUser"===e.PeopleSubtype,c="LinkedIn"===e.PeopleSubtype,u="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,d="PublicDistributionList"===e.PeopleSubtype,p={department:e.Department,office:e.OfficeLocation,email:t,image:s?void 0:Object(y.a)({userLoginName:t}),job:e.JobTitle||t,name:e.DisplayName,providerName:"Provider",userId:n,rawData:r,rawPersonData:r,isExternal:!l};l?(p.entityType=0,p.principalType=o.default.user,p.isResolved=!0):u?(p.entityType=2,p.principalType=o.default.securityGroup,p.isResolved=!1):c?p.entityType=4:(p.principalType=d?o.default.distributionList:o.default.none,p.entityType="Group"===e.PeopleType?2:1,p.isResolved=!1,p.providerName=void 0),p.userId&&i.push(p)}),!1!==t.resolveEmailIfNoResults&&0===i.length&&a._isValidEmail(e,!1)){var s={Key:e,IsResolved:!1};i.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:s,rawPersonData:s,isExternal:!0})}return i},function(n){return"Canceled"!==n.name&&(a._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),a.sharePointSearch(e,t)),null}):a.sharePointSearch(e,t)})},t.prototype._isValidEmail=function(e,t){if(!e)return!t;if(e.indexOf(" ")>-1||e.indexOf(";")>-1)return!1;if(v.Killswitch.isActivated("85cfc348-6fc6-4b40-9578-1e669e8aeab1","07/06/2018","t-jasm, more restrictive email validation.")){return/\S+@\S+\.\S+/.test(e)}return _.isValidEmailSyntax(e,!1)},t.prototype._transformData=function(e,t){var a=this;return e.map(function(e){var n=e.EntityData,r={name:e.DisplayText,email:n.Email,userId:e.Key,job:n.Title,department:n.Department,phone:n.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=a._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return 1!==e.entityType})));var i=r.email;r.isResolved&&(r.image=i?a._imageAbsoluteWebUrl+Object(y.a)({userLoginName:i}):null);var s=n.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=1,r.principalType=o.default.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":r.entityType=2,r.principalType="SharePointGroup"===s?o.default.sharePointGroup:o.default.securityGroup;break;default:r.entityType=0,r.principalType=o.default.user}return r})},t}(i.a);function w(e){return!!e.webAbsoluteUrl}},"3904ebd1f9f5e501e8ce":function(e,t,a){"use strict";var n=a("64328bb588b46459132d"),r=a("275976081ce1abf67779"),i=a("958db96f3e5e5318cd6e"),o=a("e75d371903c4d34a93e5"),s=a("33bb73eed6fa4bd29ad5"),l=a("c9764d34b3eb6a106977"),c=a("b0e26fa7634e6889091e"),u=a("8183bb1c55fccc7b597d"),d=a("71623759d63dd484b782"),p=a("37eb1a1a2ffc722b1c94"),f=a("661b65dcf8351e92fe44"),m=a("578e5017557fc66bb247"),b=a("5fef64b3561abb2ebffa"),h=a("aef40636031701b462d4"),y=a.n(h),g=a("6dec44e5485412f70439"),v=a("3bbe42d2eda1d0f5d766");function _(e){var t=this;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,s,l;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.appId,r=e.itemKeys,i=e.getPreAuthUrl,o=e.driveUrl,i?(s=r.map(function(e){return a(Object(m.a)({fullUrl:b.canonicalUrlFacet},e)).fullUrl||""}),[4,a(Object(v.a)(o))]):[2,r.map(function(e){return a(Object(m.a)({vroomUrl:b.vroomUrlFacet},e)).vroomUrl||""})];case 1:return l=n.sent(),[2,new y.a({},{dataRequestor:a(g.b).dataRequestor}).getPreAuthUrls({appId:t,items:s,accessToken:l,driveUrl:o})]}})})}}var P=a("a5db57338f8274c3300c"),S=a("4986dedaa57d766e48bb")["_wLy2JS8/ZL6a9DW2sxTn5Q"],w=a("4fab54035bc77294dc42");a.d(t,"a",function(){return k});var k=Object(o.withCurrentItem)()(Object(i.b)(function(e,t){var a,i=t.itemKeys,o=t.action,s=t.isAvailable,m=t.itemKey,b=o.handler,h=b.appId,y=b.isPromoted,v=m,k="";if(1===i.length){var C=i[0],x=v||C,I=e.demandItem({controlHandler:f.a,driveItemKey:w.a},x),F=I.controlHandler,T=I.driveItemKey;(k=T&&Object(g.d)(T)||"").indexOf("/v2.1")>-1&&(k=k.replace("/v2.1","/v2.0"));var A=f.a.evaluate(F)(e,{itemKey:x}).sharedPostData;a=A}var E=e.dispatch,O=void 0;return s&&o.url&&a&&k&&(O=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(s){switch(s.label){case 0:return e=window.open("","_blank"),[4,E(_({appId:h,itemKeys:i,getPreAuthUrl:!y,driveUrl:k})).catch(function(){})];case 1:return(t=s.sent())&&t.length>0&&e&&e.document?(e.opener=null,r=JSON.stringify(t||[]),Object(p.navigateViaPost)({url:o.url,postdata:n.__assign({},a,{appId:h,items:r}),document:e.document})):e&&e.close(),[2]}})})}),{isAvailable:s&&!!O,children:function(e){var t=e.resolve,a=e.reject,i=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return t(),O?[4,O()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},o=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return a(new P.CancelError),[2]})})},s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return null},t.prototype.componentDidMount=function(){i()},t}(r.PureComponent);return y?r.createElement(l.a,{dialogContentProps:{title:S.consentDialogTitle,onDismiss:o},hidden:!1},r.createElement("p",null,S.consentDialogMessage),r.createElement(c.a,null,r.createElement(u.a,{onClick:i},S.consentDialogContinueButton),r.createElement(d.a,{onClick:o},S.consentDialogCancelButton))):r.createElement(s,null)}}})(s.c))},"4086e807fbdd293ec65c":function(e,t,a){"use strict";var n;a.r(t),function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(n||(n={})),t.default=n},"55c3ef991a028d41e160":function(e,t,a){"use strict";a.r(t),a.d(t,"strings",function(){return n});var n=a("4986dedaa57d766e48bb")["_jAjwK5kNfDUjJ/VI8nbGZQ"];t.default=n},"5c1e3c3a333c0e96782a":function(e,t,a){"use strict";var n,r;a.d(t,"b",function(){return i}),a.d(t,"a",function(){return o}),function(e){e[e.Default=0]="Default",e[e.Tenant=1]="Tenant",e[e.Hub=2]="Hub",e[e.Site=3]="Site"}(n||(n={})),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1"}(r||(r={}));function i(e){var t=e.webAbsoluteUrl,a=e.webServerRelativeUrl;return"/"===a||""===a?t:t.substring(0,t.lastIndexOf(a))}function o(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}},"670da31dee86af854d96":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("64328bb588b46459132d"),r=a("275976081ce1abf67779"),i=a("87a575c0d667197cf8b8"),o=a("15445632c7c7b851c44c"),s=a("613f460ac6104075ad08"),l=a("646ed378ac0e9617b57e");function c(e){return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt}}a("c002951aef819a46ff3f"),t.SuggestionItemDefault=function(e){var t=c(e);return r.createElement("div",{className:"ms-PeoplePicker-personaContent"},r.createElement(i.Persona,n.__assign({},t,{presence:i.PersonaPresence.none,size:i.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&r.createElement(s.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},t.SelectedItemDefault=function(e){var t=e.item,a=e.onRemoveItem,s=e.index,u=e.selected,d=e.removeButtonAriaLabel,p=c(t);return r.createElement("div",{className:l.css("ms-PickerPersona-container",{"is-selected":!!u}),"data-is-focusable":!0,"data-selection-index":s,key:s,role:"listitem"},r.createElement("div",{className:"ms-PickerItem-content"},r.createElement(i.Persona,n.__assign({},p,{presence:i.PersonaPresence.none,size:i.PersonaSize.extraSmall}))),r.createElement(o.IconButton,{onClick:a,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1,ariaLabel:d}))},t.SelectedItemBelowDefault=function(e){var t=e.item,a=e.onRemoveItem,s=e.index,u=e.selected,d=c(t);return r.createElement("div",{className:l.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!u}),"data-is-focusable":!0,"data-selection-index":s,key:s},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({},d,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}))),r.createElement("div",{className:"ms-PickerItem-sideContent"},r.createElement(o.IconButton,{onClick:a,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))},t.SelectedItemBelowCustomMenu=function(e,t){var a=e.item,s=e.onRemoveItem,u=e.index,d=e.selected,p=c(a);return r.createElement("div",{className:l.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!d}),"data-is-focusable":!0,"data-selection-index":u,key:u},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({},p,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}),t||null)),r.createElement("div",{className:"ms-PickerItem-sideContent"},r.createElement(o.IconButton,{onClick:s,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))}},"7baee5760cf48380523c":function(e,t,a){"use strict";a.r(t);var n=a("64328bb588b46459132d"),r=a("275976081ce1abf67779"),i=a("a4060cda3c9c24220a4a"),o=a("ee92087a6ec1d0e9ecc9"),s=a("3c88ca8e24c9c99ad593"),l=a("fcf654cc44d7ec457fe0"),c=a.n(l),u=a("ff539ea87d93c9d2099c"),d=a("5e76ddf6bb30811ee697"),p=a("e75d371903c4d34a93e5"),f=a("958db96f3e5e5318cd6e"),m=a("44e6ed3c2eaab3f422db"),b=a("800956ab6ff71efe3834"),h=a("264a40ebead766e0e784"),y=new h.ControlFacet("createListItemActionControl"),g=a("bb1ad009e1d0371a2be6"),v=Object(p.withOnlyCurrentItem)()(Object(f.b)(function(e,t){var a,r=t.itemKey,l=t.contentTypeId,p=e.demandItemFacet(i.C,r),f="",m=!1;if(p){var h=i.J.serialize({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl}),g=e.demandItemFacet(o.ab,h),v=e.demandItemFacet(o.ob,r);if(m=s.a.hasItemPermission({permissions:v},s.a.insertListItems)){if(l){var _=i.I.serialize({listKey:{webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl},contentTypeId:l}),P=e.demandItemFacet(o.Lb,_);if(P&&P.templateUrl){var S=new d.a({context:{webAbsoluteUrl:p.webAbsoluteUrl,listUrl:p.listFullUrl}}).getUrlParts({path:P.templateUrl});S.fullItemUrl&&(f=S.fullItemUrl)}}f||(f=g&&g.newFormUrl||""),f&&(f=Object(u.a)(f,p.rootFolder||new c.a(p.listFullUrl).path,void 0,l));var w=l;if(!w){var k=e.demandItemFacet(o.i,h);if(k&&k.length){var C=e.demandItemFacet(o.Lb,k[0]);C&&(w=C.contentTypeId)}}var x=e.demandItemFacet(y,t.itemKey);a=y.evaluate(x)(e,{itemKey:t.itemKey,formUrl:f,contentTypeId:w}).action}}return n.__assign({action:a,isAvailable:m,onExecute:function(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(a){return e&&(t=window.open(e,"_blank"))&&t.focus(),[2]})})}}(f)},Object(b.a)(e,{itemKey:r,engagement:{name:"CreateItem",isIntentional:!0}}))})(function(e){return e.action?r.createElement(g.ActionSelector,{action:e.action}):r.createElement(m.a,n.__assign({},e))})),_=a("d915b981cf8f9e330a1a"),P=a("c9764d34b3eb6a106977"),S=a("709c166948243d934acd"),w=a("fabc10f8a47ab6c08add"),k=a("033eaa4449bd36d1de5d"),C=a("a8c7165f33a4dc07ab0d");Object(C.loadStyles)([{rawString:".IFrameDialog_176c97db .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_176c97db iframe{border:none;width:100%}\n"}]);var x=function(e){function t(t){var a=e.call(this,t)||this;return a._onClose=function(){a.setState({isOpen:!1})},a._iframeOnLoad=function(){var e=a.props.heightOffset;if(a._iframeElement&&a._iframeElement.contentDocument){var t=a._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e),a._iframeElement.style.height=t+"px"}a.setState({isIFrameLoaded:!0}),a.props.onLoad&&a._iframeElement&&a.props.onLoad(a._iframeElement)},a.state={isOpen:!0,isIFrameLoaded:!1},a}return n.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})},t.prototype.render=function(){var e=this,t=this.props,a=t.url,i=(t.heightOffset,n.__rest(t,["url","heightOffset"])),o=this.state.isIFrameLoaded;return r.createElement(P.a,n.__assign({className:"IFrameDialog_176c97db",hidden:!this.state.isOpen,type:S.a.close},i),r.createElement(_.a,null,!o&&r.createElement(w.a,{size:k.a.large}),r.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:a,style:{display:o?"block":"none"},onLoad:this._iframeOnLoad})))},t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose,t.commitPopup=this._onClose}this._iframeElement=e},t}(r.Component),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){t.props.resolve()},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.linkLocation,n=e.launchBehaviorType;if(a&&void 0!==n){if("dialog"===n)return r.createElement(x,{url:a,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===n?window.open(a,"_self"):window.open(a,"_blank")}return this.props.resolve(),null},t}(r.PureComponent),F=a("15ba69abe4e28f21b76e"),T=a("bab1d393317a3961d499"),A=a("b32a03546c11ac251a10"),E=a("cdb9a7d2db44c7a9f4dd"),O=Object(p.withCurrentItemSet)()(Object(f.b)(function(e,t){var a=t.itemKey,r=e.demandItemFacet(i.r,a),s="",l=!1;if(r){var c=e.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}));if(c&&!c.isAnonymousGuestUser&&!c.isEmailAuthenticationGuestUser&&r.viewKey&&r.viewKey.viewId){var u="",d=i.J.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),p=e.demandItemFacet(o.Z,d);p&&(u=p.id,l=!(!p.permissions||!p.permissions.useClientIntegration)),l&&(s=r.webAbsoluteUrl+"/_vti_bin/owssvr.dll?",s+=Object(A.a)({CS:65001,Using:"_layouts/15/query.iqy",List:u,View:E.default.normalizeUpper(r.viewKey.viewId),RootFolder:r.rootFolder,CacheControl:1}))}}return n.__assign({isAvailable:!!l},Object(b.a)(e,{itemKey:a,engagement:{name:"ExportList",isIntentional:!0}}),{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return window.open(s),[2]})})}})})(m.a)),D=a("4986dedaa57d766e48bb")._xsh5S2gmqdwnLiU67le5Ag,U=a("d6e6a1e726db94fe6759"),R=a("b1dcd93e69c85f76518a"),K=a("b72efa01fadd65c4f99b");Object(C.loadStyles)([{rawString:".syncDialog_cf7c131a{-webkit-box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;text-align:center}.syncDialogContent_cf7c131a{margin:0 -8px;overflow-x:hidden}.syncDialogContent_cf7c131a .syncImg_cf7c131a{width:100%;max-width:100%;-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2);margin-bottom:20px;margin-top:10px;height:278px}.pointerText_cf7c131a{text-decoration:none}.footNote_cf7c131a{font-size:12px}.syncTitle_cf7c131a{font-weight:600;font-size:20px}.contentContainer_cf7c131a{margin:10px 0px;padding:0 10px}.adminContentContainer_cf7c131a{margin:2.5px -2.5px}.separator_cf7c131a{margin:-5px}\n"}]);var N="syncDialog_cf7c131a",j="syncDialogContent_cf7c131a",M="syncImg_cf7c131a",V="pointerText_cf7c131a",L="footNote_cf7c131a",B="syncTitle_cf7c131a",G="contentContainer_cf7c131a",z="adminContentContainer_cf7c131a",q="separator_cf7c131a",H=a("931f59fc2dac498e8999"),Q=a("cc08c169973ba8efeefa"),W={},J=function(e){function t(t){var a=e.call(this,t)||this;return a._onDismiss=function(){a.props.resolve()},a._getLatestOneDrive=function(){var e=a.props.clientDownloadUrl;return r.createElement(K.a,null,U.formatToArray(D.NGSCSyncDialogBody3Format,r.createElement("a",{className:V,href:e,target:"_blank"},D.NGSCSyncDialogGetOneDriveButton)))},a._getCopySyncContent=function(){var e=a._getLatestOneDrive();return a.state.isTenantAdmin?r.createElement(K.a,null,r.createElement("div",{className:z},r.createElement(R.a,null,a._bodyLine1,r.createElement("a",{className:V,href:"javascript:void(0);",onClick:a._onClick},a._bodyLine4a),a._bodyLine4b)),r.createElement("div",{className:q},r.createElement(H.a,null)),r.createElement(R.a,{className:L},e)):r.createElement("div",{className:G},a._bodyLine1,e)},a._newDesign=function(){var e=a._getCopySyncContent();return r.createElement(P.a,{isOpen:!0,onDismiss:a._onDismiss,containerClassName:N,dialogContentProps:{styles:a._getCloseButtonStyles}},r.createElement("div",{className:j},r.createElement("img",{className:M,src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/sync_to_device_illustration.svg",alt:D.syncImgAlt}),r.createElement(R.a,{className:B},a._title),e))},a._oldSyncContent=function(){return a.state.isTenantAdmin?r.createElement("div",null,r.createElement(R.a,null,a._bodyLine4b),r.createElement(R.a,null,r.createElement("a",{className:V,onClick:a._onClick},a._bodyLine4a)),r.createElement(R.a,null,r.createElement("a",{className:V,href:"https://docs.microsoft.com/onedrive/use-group-policy",target:"_blank"},a._bodyLine5))):null},a._oldDesign=function(){var e=a.props.clientDownloadUrl;return r.createElement(P.a,{isOpen:!0,title:a._title,onDismiss:a._onDismiss},r.createElement(R.a,null,a._bodyLine1),r.createElement(R.a,null,a._bodyLine2," "),r.createElement(R.a,null,U.formatToArray(D.NGSCSyncDialogBody3Format,r.createElement("a",{href:e,target:"_blank"},D.NGSCSyncDialogGetOneDriveButton))),a._oldSyncContent())},a._onClick=function(){var e=a.state.syncInfo;!function(e){var t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("value",e),document.body.appendChild(t);var a=!1;try{t.focus(),t.select(),a=document.execCommand("copy")}catch(e){}if(!a&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value),a=!0}catch(e){}document.body.removeChild(t)}(e&&e.syncConfigParams||"")},a._getCloseButtonStyles=function(){return{button:{zIndex:100}}},a._title=D.NGSCSyncDialogTitle,a._bodyLine1=D.NGSCSyncDialogBody1,a._bodyLine2=U.format(D.NGSCSyncDialogBody2,t.userLoginName),a._bodyLine4a=D.NGSCSyncDialogBody4a,a._bodyLine4b=D.NGSCSyncDialogBody4b,a._bodyLine5=D.NGSCSyncDialogBody5,a.state=W,a}return n.__extends(t,e),t.prototype.render=function(){var e=this.state.syncInfo,t=e&&e.protocolUrl,a=!Q.Killswitch.isActivated("2472583e-74dd-48ad-a4e5-2cf4b52b1455","02/11/2018","New design Sync button"),n=this._newDesign(),i=this._oldDesign(),o=a?n:i;return r.createElement(K.a,{hidden:!0},o,t&&!this.props.protocolCallback?r.createElement("div",{style:{display:"none"}},r.createElement("iframe",{hidden:!0,src:t})):null)},t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(a){switch(a.label){case 0:return[4,this.props.getSyncInfo()];case 1:return e=a.sent(),[4,this.props.isTenantAdmin()];case 2:return t=a.sent(),e&&e.protocolUrl&&this.props.protocolCallback&&this.props.protocolCallback(e.protocolUrl),this.setState({syncInfo:e,isTenantAdmin:t}),[2]}})})},t}(r.PureComponent),Z=a("801b679406aabac77627"),$=a("33bb73eed6fa4bd29ad5"),X=a("f17bd487533a7ba56195"),Y=a("95da7825c4969f34e250"),ee=a("df3b1036848e822966d1"),te=a("c66f09e6ff6ae2202829"),ae=a("5dbed4587913c17b5459"),ne=a("4e087ea06522888b2152"),re=Object(ae.c)()(Object(ee.a)(function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){var t,a,r,i,o,s,l,c,u;return n.__generator(this,function(d){switch(d.label){case 0:return t=e.props,a=t.engagement,r=t.getEngagement,i=t.telemetry,o=t.isAvailable,s=e.previousProps,a&&r?(l=oe(e.props),s&&l===oe(s)?[2]:(u=[{}],[4,r()])):[2];case 1:return c=n.__assign.apply(void 0,u.concat([d.sent(),a])),i(te.default).logData(c),new(i(ne.Qos))({name:a.name,extraData:a.extraData}).end({resultType:o?ne.ResultTypeEnum.Success:ne.ResultTypeEnum.ExpectedFailure,resultCode:l}),[2]}})})}})),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(Z.WithItemCache,null,function(a){var i=a.itemCache,o=a.dispatch,s=Object(Y.c)(X.a)(i,t),l=X.a.evaluate(s)(i,{itemKey:t,isAvailable:!1}),c=l.clientDownloadUrl,u=l.userLoginName,d=l.getSyncInfo,p=l.isAvailable,f=l.protocolCallback,m=l.isTenantAdmin,h=l.syncState,y=l.fallbackAction,g=Object(b.a)(i,{itemKey:t,engagement:{name:"Sync.Initialize",isIntentional:!0,extraData:{syncState:h}}});return r.createElement(r.Fragment,null,r.createElement(re,n.__assign({},g,{itemKey:t,isAvailable:p})),void 0!==y?y:p&&d&&c&&u?r.createElement($.a,n.__assign({},Object(b.a)(i,{itemKey:t,engagement:{name:"Sync",isIntentional:!0}})),function(a){return r.createElement(J,n.__assign({},a,{itemKey:t,getSyncInfo:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,o(d({}))];case 1:return[2,e.sent()]}})})},clientDownloadUrl:c,userLoginName:u,protocolCallback:f,isTenantAdmin:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return m?[4,o(m({}))]:[3,2];case 1:return[2,e.sent()];case 2:return[2,!1]}})})}}))}):r.createElement($.a,{isAvailable:!1}))})},t}(r.PureComponent);function oe(e){var t=e.engagement;if(!t)return"";var a=t.extraData;return a&&a.syncState||""}var se=Object(p.withOnlyCurrentItem)()(ie),le=a("4e318b84c4772f9f58b9"),ce=a("fdbcb7664c17b5b4e4d9"),ue=a("dafd9db62310f1337c17"),de=a("5fa66f575765619863ae"),pe=a("d27387ede93a2620cbf6"),fe=Object(f.b)(function(e,t){var a=t.itemKey,s=t.itemSetKey,l=t.viewId,c=t.currentDerivedView,u=e.demandItemFacet(i.C,a);if(!u)return{action:null};var d=u.webAbsoluteUrl,p=u.listFullUrl,f=e.demandItemFacet(i.r,s);!f&&i.r.matches(s)&&(f=i.r.deserialize(s));var h=i.r.serialize({webAbsoluteUrl:d,listFullUrl:p,rootFolder:f&&f.rootFolder||"",viewKey:{viewId:l}}),y=c&&i.ab.serialize({viewId:c.id}),v=e.isItemFacetResolved(o.ub,y)?e.demandItemFacet(o.ub,y):void 0,_=Object(b.a)(e,{itemKey:a,engagement:{name:"SwitchView",isIntentional:!0}}),P=e.dispatch,S=Object(g.evaluateAction)(e,r.createElement(de.a,{itemKey:h}));return{action:r.createElement(g.WithAction,{action:S},function(e){var t=e.isAvailable,i=e.execute;return r.createElement(m.a,n.__assign({isAvailable:t,isToggled:c?l===c.id:""===l,onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,s;return n.__generator(this,function(l){switch(l.label){case 0:return P(Object(le.a)({items:n.__assign({},y?(t={},t[y]=n.__assign({},o.vb.pack(!1),v&&c&&c.isDirty()?n.__assign({},o.j.pack(new ue.a(v))):{}),t):{},a?(r={},r[h]=n.__assign({},ce.e.pack({itemKey:a})),r):{})})),y&&c&&c.isDirty()&&P(Object(pe.b)({items:(s={},s[y]=[o.ub,o.j],s)})),[4,i(e)];case 1:return l.sent(),[2]}})})}},_))})}})(g.ActionSelector),me=Object(p.withCurrentItem)()(fe),be=a("6946c0f0887243183999"),he=Object(f.b)(function(e,t){var a=t.currentDerivedView,r=t.listViewSetKey,s=!1,l=r&&i.J.serialize(r);if(r&&a){var c=e.demandItemFacet(o.Z,l);s=!(!(c&&c.permissions&&c.permissions.manageLists&&a&&a.id)||a.isPersonal||a.isDefault)}return n.__assign({isAvailable:s},Object(b.a)(e,{itemKey:l,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var a=t.currentDerivedView,r=t.listViewSetKey;return{onExecute:a?function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,o;return n.__generator(this,function(n){return e(Object(be.a)({items:(t={},t[i.K.serialize(r)]={views:(o={},o[a.id]={isDefault:!0},o)},t)})),[2]})})}:void 0}})(m.a),ye=a("9c90792576def41b81c5"),ge=a("0a6fcc9f9518a7fcc53b"),ve=a("b7cf87cb13cd9c750b2f"),_e=a("bd2835d22f85a2b6d99d"),Pe=a("b0e26fa7634e6889091e"),Se=a("0740e1ac327ca777c207"),we=a("7d61c34bb660b33148a0"),ke=a("8183bb1c55fccc7b597d"),Ce=a("82a5b752ca799aba4856"),xe=a("4986dedaa57d766e48bb")["_0aHe/eu0Mohgb+N1X6YOkA"],Ie=a("9550830cbfda1b20b739");Object(C.loadStyles)([{rawString:".saveViewDialogTextField_9a58e14c{margin-bottom:8px}.saveViewDialogCheckbox_9a58e14c{min-height:36px}.saveViewDialogSpinner_9a58e14c{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"}]);var Fe=function(e){function t(t){var a=e.call(this,t)||this;return a._onCheckboxChanged=function(e,t){a.setState({isPublicView:!!t})},a._onNameRef=function(e){e&&(e.focus(),e.select())},a._onNameChanged=function(e){var t=a.props.validator;a.setState(function(){return{viewTitle:e,errorMessage:t?t(e):void 0}})},a._onClickAction=function(){a.setState({showSpinner:!0}),a.props.onContinue({viewTitle:a.state.viewTitle,isPublicView:a.state.isPublicView}).catch(function(e){a.setState({showSpinner:!1,errorMessage:e&&e.message})})},a._onKeyPress=function(e){13===e.which&&a._onClickAction()},a._initialViewTitle=t.viewTitle,a._initialIsPublicView=t.isPublicView,a.state={viewTitle:a._initialViewTitle,isPublicView:a._initialIsPublicView},a}return n.__extends(t,e),t.prototype.render=function(){var e=this.state,t=e.viewTitle,a=e.errorMessage,n=e.showSpinner;return r.createElement(P.a,{isOpen:!0,title:xe.SaveAs,onDismiss:this.props.onCancel},r.createElement(Se.a,{label:xe.SaveViewExplanation,componentRef:this._onNameRef,value:t,onChanged:this._onNameChanged,errorMessage:a,onKeyPress:this._onKeyPress,className:"saveViewDialogTextField_9a58e14c"}),r.createElement(we.a,{label:xe.SaveViewMakePublic,className:"saveViewDialogTextField_9a58e14c",disabled:t===this._initialViewTitle,defaultChecked:this._initialIsPublicView,onChange:this._onCheckboxChanged}),r.createElement(Pe.a,null,r.createElement(ke.a,{disabled:!t||!!a||n,onClick:this._onClickAction,text:xe.SaveViewCommit}),n&&r.createElement(w.a,{size:k.a.medium,className:"saveViewDialogSpinner_9a58e14c"}),r.createElement(Ce.a,{text:Ie.a.cancelActionText,onClick:this.props.onCancel})))},t}(r.PureComponent),Te=a("a5db57338f8274c3300c"),Ae=a("85bfca0cd3bb87373c39"),Ee=a("578e5017557fc66bb247"),Oe=a("bdda16acc41d10fb2021"),De=a("eb7a0bfa0cd4073aa989"),Ue=a("a083584f8eeab8771a10"),Re=a("5f6c4af8cb56376acb4d");var Ke=a("4fab947ce2688fcc8eb5"),Ne=a("d502eee49001d6af3403"),je=a("784240ae17271fdef466"),Me=new Ke.a("saveViewProgressBatch");var Ve=Object(Ne.a)()(me),Le=function(e){function t(t){var a=e.call(this,t)||this;return a._onComplete=function(){a.setState({isCompleted:!0}),a.props.onViewSaved&&a.props.onViewSaved(),a.props.resolve()},a._onContinue=function(e){return n.__awaiter(a,void 0,void 0,function(){var t,a,r,s,l,c,u,d,p,f,m,b,h,y,g=this;return n.__generator(this,function(v){switch(v.label){case 0:return r=e.viewTitle,s=e.isPublicView,l=this.props,c=l.listViewSetKey,u=l.itemCacheDispatch,d=l.itemSetKey,p=l.itemsScopeItemKey,f=l.currentViewKey,m=this.state.progressItemKey,b=u(Object(Ee.a)({currentDerivedView:o.j},f)).currentDerivedView,h=b&&b.title!==r,y=u(Object(Ee.a)({deserializedSetKey:i.r},d)).deserializedSetKey,h&&y&&b?[4,u(Object(Ae.a)({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}))]:[3,2];case 1:if(v.sent().some(function(e){return e.serverView.Title===r}))throw new Error(U.format(xe.SaveViewErrorCannotOverwrite,r));return[2,u(Object(_e.a)({items:(t={},t[c]={views:(a={},a[r]={itemSetKey:d,isPublic:s,sourceView:b,progressItemKey:m},a)},t)})).then(function(){var e=u(Object(Ee.a)({createdViewKey:i.ab},m)).createdViewKey;e&&g.setState({createdViewId:e.viewId,showDialog:!1})})];case 2:return[2,u((_={itemsScopeItemKey:p,listViewSetKey:c,itemSetKey:d,currentViewKey:f},function(e){var t,a,r=_.itemsScopeItemKey,s=_.listViewSetKey,l=_.itemSetKey,c=_.currentViewKey,u=e(Object(Ee.a)({childItems:ce.a,parentItem:ce.e,deserializedItemSetKey:i.r},l)),d=u.childItems,p=u.parentItem,f=u.deserializedItemSetKey;return e(Object(Ue.a)({items:(t={},t[s]={views:(a={},a[c]={itemSetKey:l},a)},t)})).then(function(){var t,a;if(f){var s=i.r.serialize(n.__assign({},f,{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),l=e(Object(Ee.a)({filterOptionSets:ce.c},s)).filterOptionSets;if(l&&f.filterParams){var u={};for(var m in l)l.hasOwnProperty(m)&&(u[l[m]]=!0);e(Object(Oe.a)({items:u}))}var b=new Re.a;b.resolveItems({items:(t={},t[s]=n.__assign({},d?ce.a.pack(d):{},p?ce.e.pack(p):{}),t[c]=n.__assign({},o.vb.pack(!1)),t)}),e(b.execute()),e(Object(pe.b)({items:(a={},a[c]=[o.ub,o.j],a[s]=[ce.a],a)})),e(Object(De.a)({itemsScopeItemKey:r,currentItemKey:s}))}})})).then(function(){g.props.onViewSaved&&g.props.onViewSaved(),g.props.resolve()})]}var _})})},a._onCancel=function(){a.props.reject(new Te.CancelError)},a.state={showDialog:!0,progressItemKey:Me.serializeNext()},a}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.viewTitle,a=e.isPublicView,n=e.itemSetKey,i=this.state,o=i.showDialog,s=i.createdViewId,l=i.isCompleted;return r.createElement(je.a,{itemsScopeItemKey:this.props.itemsScopeItemKey},o?r.createElement(Fe,{viewTitle:t,isPublicView:a,onContinue:this._onContinue,onCancel:this._onCancel}):!l&&s?r.createElement(Ve,{viewId:s,currentDerivedView:void 0,onComplete:this._onComplete,itemSetKey:n}):null)},t}(r.Component),Be=new h.ControlFacet("saveViewActionControl"),Ge=Object(ye.a)(void 0,{isBackgroundTask:!0})(Le),ze=Object(p.withCurrentItemSet)()(Object(ge.b)(function(e){return{itemSetKey:e.itemKey}})(Object(ve.a)()(Object(f.b)(function(e,t){var a=t.itemSetKey,r=t.currentViewKey,s=!1,l=e.demandItemFacet(i.r,a),c=e.demandItemFacet(o.j,r),u=e.demandItemFacet(Be,a),d=Be.evaluate(u)(e,{viewKey:r}).onViewSaved;if(l&&c){var p=i.J.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),f=e.demandItemFacet(o.Z,p);s=!!(f&&c&&134217728!==c.viewType&&f.permissions&&(f.permissions.managePersonalViews||f.permissions.manageLists))}return n.__assign({isAvailable:s},Object(b.a)(e,{itemKey:a,engagement:{name:"SaveView",isIntentional:!0}}),{viewTitle:c&&c.title,isPublicView:c&&!c.isPersonal,onViewSaved:d})})(Ge)))),qe=a("0c6179dbfb538858488e"),He=a("dedce7a34d3ecbf5e40f");Object(C.loadStyles)([{rawString:"[dir='ltr'] .filterPanelClearAllButton_6a300898{margin-left:8px}[dir='rtl'] .filterPanelClearAllButton_6a300898{margin-right:8px}.filterPanelRoot_6a300898 .ms-Panel-content{padding-bottom:0px}.filterPanelFooter_6a300898{display:-webkit-box;display:-ms-flexbox;display:flex}\n"}]);var Qe,We=a("4986dedaa57d766e48bb")._9brNxRcM2rAYjZAjORvLGw;!function(e){e[e.user=0]="user",e[e.fileType=1]="fileType",e[e.choice=2]="choice"}(Qe||(Qe={}));var Je=a("3d36f452b19c91868cbc"),Ze=a("d7d144a7313c4e633cfa"),$e=a("2b1ef1ee9b2aa1876740"),Xe=a("814049e387c5d777c75a"),Ye=a("53d65358d43e356fac63"),et=a("cdb7d49c64b43d532424"),tt=a("aba02007ddf17c261fe1"),at=a("adf6e81d5ecf9ea16532"),nt=a("192917b18135005f9dfd");Object(C.loadStyles)([{rawString:".checkboxRoot_61d38cdc{padding:8px 0;font-size:14px}.checkboxLabelRoot_61d38cdc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir='ltr'] .checkboxLabelRoot_61d38cdc{margin-left:4px}[dir='rtl'] .checkboxLabelRoot_61d38cdc{margin-right:4px}[dir='ltr'] .fileTypeCheckboxLabel_61d38cdc{margin-left:8px}[dir='rtl'] .fileTypeCheckboxLabel_61d38cdc{margin-right:8px}.userCheckboxRoot_61d38cdc{padding:4px 0}.userCheckboxRoot_61d38cdc .ms-Persona-details{padding:0 8px}\n"}]);var rt=function(e){function t(t){var a=e.call(this,t)||this;return a._warnMutuallyExclusive({checkedKeys:"defaultCheckedKeys"}),a.state={keysChecked:(void 0!==t.checkedKeys?t.checkedKeys:t.defaultCheckedKeys)||[]},a.root=void 0,a.focusZone=void 0,a}return n.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){void 0!==e.checkedKeys&&this.setState({keysChecked:e.checkedKeys})},t.prototype.render=function(){var e=this,t=this.props,a=t.options,n=t.className,i=this.state.keysChecked;return r.createElement("div",{ref:this._resolveRef("root"),role:"group",className:n,"data-automationid":"CheckboxGroup"},a&&a.length>0&&r.createElement(_.a,{componentRef:this._resolveRef("focusZone"),direction:Ye.a.vertical,isCircularNavigation:!0},a.map(function(t,a){var n;return Object(Je.a)(t,{checked:i.indexOf(t.key)>=0}),r.createElement("div",{key:t.key,"data-automationid":"Checkbox","data-is-checked":t.checked,"data-checked-label":t.label},r.createElement(we.a,{key:t.key,label:t.label,onRenderLabel:st(t),className:Object(Ze.a)("checkboxRoot_61d38cdc",(n={},n.userCheckboxRoot_61d38cdc=t.renderType===Qe.user,n),t.className),checked:t.checked,onChange:e._onToggleCheckbox.bind(null,t)}))})))},t.prototype._onToggleCheckbox=function(e,t,a){var n=this.props,r=n.checkedKeys,i=n.onChange;void 0===r&&this.setState(function(t){var n=t.keysChecked;if(a)n.push(e.key);else{var r=n.indexOf(e.key);r>=0&&n.splice(r,1)}return{keysChecked:n}}),i&&i(t,e,a)},t.defaultProps={options:[]},n.__decorate([$e.a],t.prototype,"_onToggleCheckbox",null),t}(Xe.a),it=function(e){return e?r.createElement(et.a,{primaryText:e.label,imageUrl:e.imageSrc,size:tt.c.size28,className:"checkboxLabelRoot_61d38cdc"}):null},ot=function(e){return e?r.createElement("div",{className:"checkboxLabelRoot_61d38cdc"},r.createElement(at.a,n.__assign({},Object(nt.a)({extension:e.label,size:16}))),r.createElement("span",{className:"fileTypeCheckboxLabel_61d38cdc"},e.label)):null};function st(e){var t=e.onRenderLabel,a=e.renderType;t||(a===Qe.user?t=it:a===Qe.fileType&&(t=ot));var n=t;return function(t,a){return n?n(e):a&&t?a(t):null}}var lt=a("5e39fc4e09867bef67ce"),ct=a("0bdd75e78dcb9cfa71d6"),ut=a("a48ac27d6d227e44e1a5"),dt=function(e){return U.format(We.FilterSelectPanelTitle,e)},pt=We.ApplyFilterButtonAriaDescription,ft=We.ApplyFilterButtonLabel,mt=We.ClearAllButtonLabel,bt=function(e){return U.format(We.ClearAllButtonAriaDescription,e)},ht=function(e){function t(t){var a=e.call(this,t)||this;return a._onSelectedPersonasChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var n={display:t.name,value:t.name};a.setState(function(e){for(var t=-1,a=0;a<e.filterOptionSet.length;a++)if(e.filterOptionSet[a].value===n.value){t=a;break}return{filterOptionSet:-1===t?e.filterOptionSet.concat([n]):e.filterOptionSet,checkedFilterValues:e.checkedFilterValues.concat([n.value])}})}},a._onCheckboxGroupChange=function(e,t,n){a.setState(function(e){var a=e.checkedFilterValues;if(n)a=a.concat([t.key]);else{var r=a.indexOf(t.key);r>-1&&(a=a.slice(0,r).concat(a.slice(r+1)))}return{checkedFilterValues:a}})},a._onClearAllClick=function(){a.setState({checkedFilterValues:[]})},a.state={filterOptionSet:t.filterOptionSet,checkedFilterValues:t.checkedFilterValues},a}return n.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({filterOptionSet:e.filterOptionSet,checkedFilterValues:e.checkedFilterValues})},t.prototype.render=function(){var e=this,t=this.props,a=t.columnName,i=t.onClose,o=t.fieldType,s=t.fieldInternalName,l=t.isLoading,c=t.applyFiltersAction,u=this.state,d=u.checkedFilterValues,p=u.filterOptionSet,f=p?function(e,t,a){var n=[];e&&e.length&&(n=e.map(function(e){var n={key:e.value,label:e.display};return"User"===t||"UserMulti"===t?n.renderType=Qe.user:"DocIcon"===a&&(n.renderType=Qe.fileType),n}));return n}(p,o,s):void 0;return r.createElement(lt.a,null,r.createElement(qe.a,{"data-automationid":"FilterPanel",className:"filterPanelRoot_6a300898",isOpen:!0,type:He.a.smallFixedFar,headerText:dt(a),onDismiss:i,closeButtonAriaLabel:We.closeButtonAriaLabel,onRenderFooterContent:l?void 0:function(){return r.createElement("div",{className:"filterPanelFooter_6a300898"},r.createElement(g.WithAction,{action:c({filterOptionSet:p,checkedFilterKeys:d})},function(t){var a=t.isAvailable,i=t.execute;return r.createElement(ke.a,{"data-automationid":"FilterPanel-Apply",onClick:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i({})];case 1:return e.sent(),this.props.onComplete(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}})})},disabled:!a,ariaDescription:pt,text:ft})}),r.createElement(Ce.a,{className:"filterPanelClearAllButton_6a300898","data-automationid":"FilterPanel-ClearAll",onClick:e._onClearAllClick,ariaDescription:bt(a),text:mt}))}},l?r.createElement(w.a,null):r.createElement(K.a,null,this._renderFilterPicker(),r.createElement(rt,{options:f,checkedKeys:d,onChange:this._onCheckboxGroupChange}))))},t.prototype._onRenderItem=function(){return null},t.prototype._renderFilterPicker=function(){var e=this.props,t=e.fieldType,a=e.filterPickerProps;return("User"===t||"UserMulti"===t)&&a&&a.peoplePickerDataSource?r.createElement(ct.PeoplePicker,{className:"od-CheckBoxFilterSection-peoplePicker",context:a.pageContextForPicker,peoplePickerType:ut.PeoplePickerType.listBelow,dataSource:a.peoplePickerDataSource,onRenderItem:this._onRenderItem,onSelectedPersonasChange:this._onSelectedPersonasChange,inputProps:{placeholder:We.PeoplePickerPlaceholder},noResultsFoundText:We.NoResults}):null},t}(r.PureComponent);var yt=a("5fef64b3561abb2ebffa"),gt=a("5004fc2f3329649ad54d"),vt=new h.ControlFacet("filterActionControl"),_t={ODB:1352},Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.itemSetKey,s=t.filterableSet,l=t.internalName,c=t.filterOptionSet,u=t.fieldType,d=t.checkedFilterKeys;return r.createElement(Z.WithItemCache,null,function(t){var p=t.itemCache,f=t.dispatch;if(!(l&&s&&c&&u))return r.createElement(g.WithAction,null);for(var h=[],y={},v=0,_=c;v<_.length;v++){var P=_[v];y[P.value]=P}for(var S=0,w=d;S<w.length;S++){var k=w[S];y[k]&&h.push(y[k].value)}var C,x=s.getFilteredItemSetKey({filterField:l,filterValues:h,filterType:u,useLookupId:!1}),I=p.demandItemFacet(i.r,x),F=p.demandItemFacet(ce.e,a),T=p.demandItemFacet(i.r,a),A=T&&T.viewKey&&i.ab.serialize(T.viewKey);T&&(C=p.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:T.listFullUrl})));var E,O=Object(gt.a)(p,{feature:_t,pageContext:C});if(O){var D=p.demandItemFacet(vt,a),U=vt.evaluate(D)(p,{viewKey:A}).onFilter;E=U}var R=Object(b.a)(p,{itemKey:a,engagement:{name:"ApplyFilters",isIntentional:!0}});return r.createElement(g.WithAction,{action:r.createElement(de.a,{itemKey:x})},function(t){var a=t.isAvailable,i=t.execute;return r.createElement(m.a,n.__assign({isAvailable:a,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,a,r;return n.__generator(this,function(s){switch(s.label){case 0:return O&&E&&(r=I&&I.filterParams,f(E({filterParams:r}))),f(Object(le.a)({items:n.__assign((e={},e[x]=n.__assign({},ce.e.pack(F)),e),A?(a={},a[A]=n.__assign({},o.vb.pack(!0)),a):{})})),[4,i(t)];case 1:return s.sent(),[2]}})})}},R))})})},t}(r.PureComponent),St=Object(ve.a)()(Object(f.b)(function(e,t){var a=t.columnKey,s=t.itemSetKey,l=e.demandItem({fieldType:o.E,internalName:o.Q},a),c=l.fieldType,u=l.internalName,d=e.demandItem({deserializedSetKey:i.r,filterableSet:o.Db,filterOptionSets:ce.c},s),p=d.deserializedSetKey,f=d.filterableSet,m=d.filterOptionSets,b=p&&e.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl})),h=p&&e.demandItemFacet(o.Ob,i.V.serialize({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl})),y=e.demandItemFacet(o.F,m&&m[a]),g=f&&y&&f.appliedFilters&&u&&f.appliedFilters[u]?f.appliedFilters[u].values:[];return{filterOptionSet:y||[],fieldType:c||"",fieldInternalName:u||"",applyFiltersAction:function(e){return r.createElement(Pt,n.__assign({},e,{itemSetKey:s,filterableSet:f,fieldType:c,internalName:u}))},isLoading:!y,checkedFilterValues:g,filterPickerProps:"User"===c||"UserMulti"===c?{pageContextForPicker:b,peoplePickerDataSource:h}:void 0}})(ht)),wt=Object(ye.a)(function(e,t){return{onClose:function(){e.reject(new Te.CancelError)},onComplete:function(){e.resolve()}}})(St),kt=Object(f.b)(function(e,t){var a=t.columnKey,r=t.itemSetKey,o=t.isToggled,s=e.demandItemFacet(yt.displayNameFacet,a),l=e.demandItemFacet(vt,r),c=e.demandItemFacet(i.r,r),u=c&&c.viewKey&&i.ab.serialize(c.viewKey),d=vt.evaluate(l)(e,{viewKey:u,isAvailable:!0}).isAvailable;return n.__assign({isAvailable:d,isToggled:o},Object(b.a)(e,{itemKey:r,engagement:{name:"LaunchFilterPanel",isIntentional:!0}}),{columnName:s||"",columnKey:a,itemSetKey:r})})(wt),Ct=new h.ControlFacet("sortActionControl"),xt=a("6578506114fc52cc91d3"),It=a("65da65eb66805e3724ff"),Ft=a("00620f24248a4f158ff6"),Tt={ODB:1352},At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.sortFieldKey,s=t.itemSetKey,l=t.isAscending;return r.createElement(Z.WithItemCache,null,function(t){var c=t.itemCache,u=t.dispatch,d=c.demandItemFacet(i.r,s);if(!d)return r.createElement(g.WithAction,null);var p,f=i.r.serialize(n.__assign({},d,{sortFieldKey:a,sortAscending:l})),h=i.C.serialize(d),y=d.viewKey&&i.ab.serialize(d.viewKey),v=c.demandItemFacet(o.Z,i.J.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),_=c.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),P=Object(gt.a)(c,{feature:Tt,pageContext:_});if(P){var S=c.demandItemFacet(Ct,f),w=Ct.evaluate(S)(c,{viewKey:y}).onSort;p=w}var k=Object(b.a)(c,{itemKey:s,engagement:{name:"Sort",isIntentional:!0}}),C=c.demandItemFacet(ce.g,s),x=C&&c.demandItemFacet(i.o,C.columnKey),I=x&&x.internalName||d.sortFieldKey,F=C?C.isAscending:d.sortAscending;return r.createElement(g.WithAction,{action:r.createElement(de.a,{itemKey:f})},function(t){var s=t.isAvailable,c=t.execute;return r.createElement(m.a,n.__assign({isAvailable:s,isToggled:I===a&&F===l,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,a;return n.__generator(this,function(r){switch(r.label){case 0:return P&&p&&u(p({sortFieldKey:this.props.sortFieldKey,sortAscending:this.props.isAscending})),u(function(e){var t=this;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,s,l,c,u,d;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.sortField,r=e.isAscending,i=e.webAbsoluteUrl,o=e.listFullUrl,s=e.pageContext,l=e.templateType,c=l===Ft.ListTemplateType.mySiteDocumentLibrary,s&&s.isSiteAdmin&&c?(u=Object(xt.getListApiUrl)({webAbsoluteUrl:i,listFullUrl:o}).segment("DefaultView").segment("SetViewXml"),d=r?"TRUE":"FALSE",[4,a(Object(It.c)({webAbsoluteUrl:i,listFullUrl:o,url:u.toString(),method:"POST",qosName:"SetDefaultView",noRedirect:!0,body:JSON.stringify({viewXml:'<View><Query><OrderBy><FieldRef Name="'+t+'" Ascending="'+d+'" /></OrderBy></Query></View>'})}))]):[3,2];case 1:return[2,n.sent()];case 2:return[4,Promise.resolve(void 0)];case 3:return[2,n.sent()]}})})}}({sortField:this.props.sortFieldKey,isAscending:this.props.isAscending,webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl,pageContext:_,templateType:v&&v.templateType})),u(Object(le.a)({items:n.__assign((e={},e[f]=n.__assign({},ce.e.pack({itemKey:h}),ce.g.pack({columnKey:i.o.serialize({internalName:this.props.sortFieldKey}),isAscending:this.props.isAscending})),e),y?(a={},a[y]=n.__assign({},o.vb.pack(!0)),a):{})})),[4,c(t)];case 1:return r.sent(),[2]}})})}},k))})})},t}(r.PureComponent);var Et=new h.ControlFacet("groupByActionControl"),Ot=a("aa112348dbd293212a65"),Dt={ODB:1352},Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.groupByFieldKey,s=t.itemSetKey;return r.createElement(Z.WithItemCache,null,function(t){var l=t.itemCache,c=t.dispatch,u=l.demandItemFacet(i.r,s);if(!u)return r.createElement(g.WithAction,null);var d=i.J.serialize(u),p=l.demandItemFacet(o.Z,d),f=p&&p.templateType===Ft.default.mySiteDocumentLibrary,h=Object(Ot.a)(l,{enableGroupByInOneDrive:o.s}).enableGroupByInOneDrive,y=u.groupByFieldKey===a,v=i.r.serialize(n.__assign({},u,{groupByFieldKey:y?void 0:a})),_=i.C.serialize(u),P=u.viewKey&&i.ab.serialize(u.viewKey),S=l.demandItemFacet(Et,s),w=Et.evaluate(S)(l,{itemSetKey:s,viewKey:P,groupedItemSetKey:v,isAvailable:!f||!!h}),k=w.isAvailable,C=w.onGroupBy,x=l.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),I=Object(gt.a)(l,{feature:Dt,pageContext:x}),F=Object(b.a)(l,{itemKey:s,engagement:{name:"GroupBy",isIntentional:!0}});return r.createElement(g.WithAction,{action:r.createElement(de.a,{itemKey:v})},function(t){var a=t.isAvailable,s=t.execute;return r.createElement(m.a,n.__assign({isAvailable:a&&k,isToggled:y,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,a,r,l;return n.__generator(this,function(u){switch(u.label){case 0:return I&&C&&(r=i.r.deserialize(v),l=r&&r.groupByFieldKey,c(C({groupByFieldKey:l}))),c(Object(le.a)({items:n.__assign((e={},e[v]=n.__assign({},ce.e.pack({itemKey:_})),e),P?(a={},a[P]=n.__assign({},o.vb.pack(!0)),a):{})})),[4,s(t)];case 1:return u.sent(),[2]}})})}},F))})})},t}(r.PureComponent),Rt=a("c88e7380c3f2d1910abe"),Kt=a("9e31270e173c703ec1f7"),Nt={ODB:1318},jt=!1,Mt=Object(f.b)(function(e,t){var a=t.itemSetKey,r=t.modifyType,s=t.columnKey,l=!1,c=e.demandItem({setKey:i.r,canModifySchema:o.e},a),u=c.setKey,d=c.canModifySchema,p=u&&u.viewKey?i.ab.serialize(u.viewKey):void 0,f=e.demandItem({currentDerivedView:o.j},p).currentDerivedView,m=e.demandItemFacet(o.Q,s);if(u&&d&&f&&f.baseViewXml&&m)if(1===r||2===r){var h=f.getEffectiveFieldNames();if(h&&h.length){var y=h.indexOf(m),g=u.groupByFieldKey?1:0;l=1===r?y>g+1:y>=g&&y<h.length-1}}else l=!0;if(u){var v=e.demandItemFacet(o.Mb,i.U.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));jt=Object(gt.a)(e,{feature:Nt,pageContext:v})}return n.__assign({isAvailable:l},Object(b.a)(e,{itemKey:a,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var a=t.itemSetKey,r=t.modifyType,i=t.columnKey,o=jt?Kt.modifyColumnWithProgress:Rt.a;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,s;return n.__generator(this,function(n){return e(o({items:(t={},t[a]={columnModifyTypeMap:(s={},s[i]={modifyType:r},s)},t)})),[2]})})}}})(m.a),Vt=a("f594c3c93ec9f3598a3f"),Lt=a("9478e86dcd48357093ed"),Bt=Object(f.b)(function(e,t){var a=t.itemSetKey,r=t.columnKey,i=t.aggregateType,s=e.demandItemFacet(o.f,a),l=s&&s[r]&&s[r].aggregateFunctionType||Lt.a[0],c=l===Lt.a[i]?void 0:Lt.a[i];return n.__assign({isAvailable:!0,isToggled:l===Lt.a[i]},c?Object(b.a)(e,{itemKey:a,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:c||"AggregateTypeNone",extraData:{PreviousAggregateType:l||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var a=t.itemSetKey,r=t.columnKey,i=t.aggregateType;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){return e(Object(Vt.a)({items:(t={},t[a]={aggregateType:i,columnKey:r},t)})),[2]})})}}})(m.a),Gt=a("bc38f53c4642d5526f0b"),zt=a("9e891d519df45958713d");a.d(t,"CreateListItemAction",function(){return v}),a.d(t,"OpenAsHyperLinkExecutor",function(){return I}),a.d(t,"NewItemInOfficeClientAction",function(){return F.b}),a.d(t,"ItemOpenInOfficeClientAction",function(){return F.a}),a.d(t,"OpenInOfficeClientAction",function(){return F.c}),a.d(t,"ItemOpenInOfficeOnlineAction",function(){return T.a}),a.d(t,"OpenInOfficeOnlineAction",function(){return T.b}),a.d(t,"ExportListAction",function(){return O}),a.d(t,"SyncActionBase",function(){return ie}),a.d(t,"SyncAction",function(){return se}),a.d(t,"ItemSwitchViewAction",function(){return fe}),a.d(t,"SwitchViewAction",function(){return me}),a.d(t,"SetDefaultViewAction",function(){return he}),a.d(t,"SaveViewAction",function(){return ze}),a.d(t,"LaunchFilterPanelAction",function(){return kt}),a.d(t,"SortAction",function(){return At}),a.d(t,"GroupByAction",function(){return Ut}),a.d(t,"ModifyColumnAction",function(){return Mt}),a.d(t,"ModifyColumnAggregateTypeAction",function(){return Bt}),a.d(t,"ApproveRejectAction",function(){return Gt.a}),a.d(t,"ItemFileHandlerOpenAction",function(){return zt.b}),a.d(t,"FileHandlerOpenAction",function(){return zt.a})},"80c1d0bf7c1262a92fd4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".ms-Suggestions{width:260px}\n"}])},"9e31270e173c703ec1f7":function(e,t,a){"use strict";a.r(t);var n,r=a("c88e7380c3f2d1910abe"),i=a("f5df325953ebb7f1143d"),o=a("64328bb588b46459132d"),s=a("4986dedaa57d766e48bb")._mdUvzXyVLdpWl82nZD7irQ,l=a("680b7ac74280293b48f0"),c=a("95da7825c4969f34e250"),u=a("9c98f89a0e31dc353072"),d=a("7c35367aa9ac1c882ae5"),p=a("2b59a0fb8f81c55fbaf0"),f=a("fdbcb7664c17b5b4e4d9"),m=a("3da5d317c00adfe8f79c"),b=a("959d5e23f32a2e71cc99"),h=new b.a("modifyColumnProgressItem",{columnKey:Object(b.e)(),modifyType:Object(b.d)(),targetIndex:Object(b.d)()}),y=new i.a("modifyColumnProgress",function(e,t){var a=Object.keys(t.columnModifyTypeMap)[0],n=t.columnModifyTypeMap[a].modifyType,r=t.columnModifyTypeMap[a].targetIndex;return h.serialize({columnKey:a,modifyType:n,targetIndex:r})}),g=a("ee92087a6ec1d0e9ecc9"),v=((n={})[m.d.started]=s.columnOperationStarted,n[m.d.completed]=s.columnOperationCompleted,n[m.d.failed]=s.columnOperationFailed,n),_=Object(l.b)(function(){return function(e){e(Object(c.d)(y,u.a)(Object(c.a)()(P))),e(Object(c.d)(y,d.c)(Object(c.a)()(S))),e(Object(c.d)(y,p.b)(Object(c.a)()(w)))}});function P(){return function(e){return function(e,t){var a,n=t.itemKey,r=t.format,s=Object(i.f)(e,t).phase,l=void 0,c=e.demandItemFacet(f.a,n),u=c&&c.itemKeys;if(u&&u.length>0)a=(l=v)&&l[s];else if("item"===r){var d=e.demandItemFacet(y,n),p=d&&d.taskKey;if(p){var m=e.demandItemFacet(h,p),b=m&&m.columnKey;if(b)a=e.demandItemFacet(g.Q,b)}}return o.__assign({},a?{title:a}:{})}}}function S(){return function(e){return function(e,t){return{reportMode:d.a.pin}}}}function w(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}a.d(t,"modifyColumnWithProgress",function(){return k});var k=Object(i.g)({operationTypeFacet:r.b,progressKeyFacet:y,initializeBatch:function(){return _}})},"9e891d519df45958713d":function(e,t,a){"use strict";a.d(t,"b",function(){return c}),a.d(t,"a",function(){return u});var n=a("64328bb588b46459132d"),r=a("958db96f3e5e5318cd6e"),i=a("3904ebd1f9f5e501e8ce"),o=a("e75d371903c4d34a93e5"),s=a("5fef64b3561abb2ebffa"),l=a("800956ab6ff71efe3834"),c=Object(r.b)(function(e,t){var a=t.itemKey,r=t.action,i=!1;if(a){var o=e.demandItem({fileName:s.fileNameFacet},a),c=o&&o.fileName,u=c&&c.extension||"";i=r.availableOn.file&&r.availableOn.file.extensions&&(-1!==r.availableOn.file.extensions.indexOf(u)||-1!==r.availableOn.file.extensions.indexOf(".*"))||!1}var d=r.handler,p=d.appId,f=d.isPromoted?"ItemsScopeFileHandlerOpen":"ItemsScopePromotedFileHandlerOpen",m={appId:p};return n.__assign({isAvailable:i,itemKeys:a?[a]:[]},Object(l.a)(e,{itemKey:a,engagement:{name:f,isIntentional:!0,extraData:m}}))})(i.a),u=Object(o.withSelectedItems)()(Object(o.withExactlyOneItem)()(c))},a48ac27d6d227e44e1a5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(t.PeoplePickerType||(t.PeoplePickerType={}))},aef40636031701b462d4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.getPreAuthUrls=function(e){var t=e.items,a=e.accessToken,n=void 0===a?void 0:a,r=e.driveUrl,i=void 0===r?"":r,o={items:t};return this._dataRequestor.send({path:(i||"/drive")+"/getPreAuthorizedUrls",apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(o),requestType:"POST",accessToken:n,useAuthorizationHeaders:!!n}).then(function(e){return e.value})},e}();t.default=n},b73e9dbcd106334326ef:function(e,t,a){"use strict";a.r(t);var n,r,i=a("33ce002e6a69ade13405"),o=a("4086e807fbdd293ec65c");!function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Busy=2]="Busy",e[e.DoNotDisturb=3]="DoNotDisturb",e[e.BeRightBack=4]="BeRightBack",e[e.Away=5]="Away",e[e.Offline=6]="Offline",e[e.Hidden=7]="Hidden"}(r||(r={}));var s=a("0b8514f932f40951d460"),l=a("64328bb588b46459132d"),c=a("948e07ec1b658aef2b54"),u=a("637f546134386c5b625a"),d=a("cc08c169973ba8efeefa"),p=function(e){function t(){var a=e.call(this,t._Key,t._DataStoreCachingType)||this;a._MaxItems=200,a._Version=5;if(a._buffer=a.getValue(t._StorageKey),a._buffer&&a._buffer.version===a._Version&&a._buffer.lastCachePrune||a.initializeBuffer(),a._data={},Date.now()<a._buffer.lastCachePrune+6048e5||d.Killswitch.isActivated("e96e6a47-9f55-4ea4-8395-c9f48a655b2a","8/07/2018","PeopleStorePruning"))for(var n=0;n<a._buffer.dataArray.length;n++)a._data[a._buffer.dataArray[n].email]=a._buffer.dataArray[n];else a.initializeBuffer(),a.setValue(t._StorageKey,a._buffer);return a}return l.__extends(t,e),t.clear=function(){new c.a(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var a=this._data[e.email];if(a){if(t.isCacheEntryFresh(a,e))return;var n=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[n]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index];delete this._data[r.email],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[e.email]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var a=[],n=0;n<this._buffer.dataArray.length;n++){var r=(this._buffer.index-n+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[r].email&&this._buffer.dataArray[r].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[r].name&&this._buffer.dataArray[r].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[r].entityType||a.push(this._buffer.dataArray[r])}return a},t.prototype.containsItem=function(e){return Boolean(this._data[e.email])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=u.a.local,t}(c.a),f=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new i.a({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new p,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var a,n,r=this,i={cached:null,promise:null};return this._mruCache&&!t.groupID&&(n=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(i.cached=n),i.promise=new s.default(function(i,o){a=r._dataSource.search(e,t).then(function(e){if(e)if(n){n.length>0&&(n=r._removeStaleCacheResults(n,e));var t=n.map(function(e){return e.userId});i(e.filter(function(e){return t.indexOf(e.userId)<0}))}else i(e)},function(e){o(e)})},function(){a&&a.cancel()}),i},e.prototype.resolve=function(e,t){var a=this;return this._dataSource.resolve(e,t).then(function(e){return a._mruCache&&e.isResolved&&a.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.searchMruCache=function(e,t){var a=[],n=this._mruCache;if(n){a=n.getItems(e,t);var r=this.MaxCacheSuggestions;a.length>r&&(a=a.splice(0,r))}return a},e.prototype._removeStaleCacheResults=function(e,t){var a=e.map(function(e){return e.userId}),n=[];return t.forEach(function(t){var r=a.indexOf(t.userId);if(r>-1){var i=e[r];p.isCacheEntryFresh(i,t)&&n.push(i)}}),n},e}();a.d(t,"PeoplePickerDataSource",function(){return i.a}),a.d(t,"PrincipalType",function(){return o.default}),a.d(t,"EntityType",function(){return n}),a.d(t,"PresenceType",function(){return r}),a.d(t,"PeoplePickerProvider",function(){return f})},c002951aef819a46ff3f:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".ms-PickerPersona-container{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#666666"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-webkit-box-flex:1;-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077B5}\n"}])},c2801f66d553d6a165e0:function(e,t,a){"use strict";var n=a("64328bb588b46459132d"),r=a("c1d76209a7f2fe28e159"),i=function(){function e(e,t){var a=this._pageContext=t.pageContext,i=t.dataRequestorType,o=void 0===i?function(e){function t(t){return e.call(this,t,{pageContext:a})||this}return n.__extends(t,e),t}(r.default):i,s=e.dataSourceName,l=void 0===s?"DataSource":s;this.dataSourceName=l,this.dataRequestor=new o({qosName:l})}return e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,a,n,r,i,o,s,l,c,u,d,p){void 0===r&&(r="POST");var f=e();return this.dataRequestor.getData({url:f,parseResponse:t,qosName:a,qosHandler:u,customQosLogger:d,additionalPostData:n&&n(),method:r,additionalHeaders:i,contentType:o,maxRetries:s,noRedirect:l,qosExtraData:p,crossSiteCollectionCall:c,needsRequestDigest:this.needsRequestDigest(f)})},e}();t.a=i},cfd15bb212a873934c4b:function(e,t,a){"use strict";var n=a("95a42c24c7003bcd6d09"),r=a("cd86271a21b3a4d18be3"),i=a("9ba97cc998d0be4df04a"),o=a("948e07ec1b658aef2b54"),s=a("637f546134386c5b625a"),l=a("cc08c169973ba8efeefa"),c="enableFeatures",u="disableFeatures",d="Store",p={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},f={ODB:357,ODC:null,Fallback:!1},m={ODB:342,ODC:null,Fallback:!1},b={},h=new o.a("FeatureOverrides",s.a.session),y="FeatureOverrides_"+c,g="FeatureOverrides_"+u;function v(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}!function(){var e=l.Killswitch.isActivated("CA76C674-5DEE-4C8A-9EDF-82C275E0CF01","11/27/2018","Don't save enable/disable features query params to session storage");if(e){var t=h.getValue(d);b=t||{}}else b=function(){var e={},t=v(y);if(t)for(var a=0,n=t.split(",");a<n.length;a++)e[n[a]]=!0;var r=v(g);if(r)for(var i=0,o=r.split(",");i<o.length;i++)e[o[i]]=!1;return e}();var a=location.search?location.search.substring(1):"",n=i.a(a),r=n[c];if(r)for(var o=0,s=r.split(",");o<s.length;o++){var p=s[o];b[p]=!0}var f=n[u];if(f)for(var m=0,_=f.split(",");m<_.length;m++)p=_[m],b[p]=!1;e?h.setValue(d,b):function(e){var t=[],a=[];for(var n in e)(e[n]?t:a).push(n);document.cookie=y+"="+t.join(",")+";path=/",document.cookie=g+"="+a.join(",")+";path=/"}(b)}();var _=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function(){return b},enumerable:!0,configurable:!0}),e.evaluateCanOverride=function(){"undefined"!=typeof DEBUG&&DEBUG?e.CanOverride=!0:e.CanOverride=n.default.isFeatureEnabled(p)||n.default.isFeatureEnabled(f)||n.default.isFeatureEnabled(m)},e.isFeatureEnabled=function(t,a){if(e.CanOverride){if(t.ODB in b)return b[t.ODB];if(t.ODC in b)return b[t.ODC]}return a?Object(r.isSPFeatureEnabled)(t,a):n.default.isFeatureEnabled(t)},e.AllowFeatureOverrides=p,e.SPODebugOnlyCookieRedirect=f,e}();t.a=_,_.evaluateCanOverride()},f17bd487533a7ba56195:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var n=new(a("264a40ebead766e0e784").ControlFacet)("itemSyncControl")}}]);