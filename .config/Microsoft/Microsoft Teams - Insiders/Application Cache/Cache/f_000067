(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[48],{"0dcb4ef0c72818ebbce5":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("6631b0451e9f577f414d"),a=r("8e315e7d1c81f1fe46e0"),o=r("256c2b1df06b9b785912"),i=r("0b8514f932f40951d460"),s=r("c1a09d7dd35e11297e15"),c=function(){function e(e,t){var r=t.asyncType,i=void 0===r?n.default:r,s=t.eventGroupType,c=void 0===s?a.default:s,u=t.targetWindow,d=void 0===u?window:u,l=this._scope=new o.default;this._async=l.attach(new i(this)),this._events=l.attach(new c(this)),this._targetWindow=d}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.wait=function(e){var t,r=e.duration,n=e.allowWakeWhenOnline,a=void 0!==n&&n,o=this._async,c=this._events,u=this._targetWindow,d=new s.default(function(){o.clearTimeout(t)}),l=function(){a&&d.complete()};return t=o.setTimeout(function(){d.complete()},r),c.on(u,"online",l),d.getPromise().then(function(){c.off(u,"online",l)},function(e){return c.off(u,"online",l),i.default.reject(e)})},e}();t.UploadWaiter=c},"26a436222c7071f5071f":function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=new(r("264a40ebead766e0e784").ControlFacet)("itemThumbnailControl")},"28d43522af463e91e061":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("64328bb588b46459132d"),a=r("0b8514f932f40951d460"),o=r("a24d70c7702f13f024d9"),i=r("4e087ea06522888b2152"),s=function(){function e(e,t){var r=t.uploadService,n=t.uploadStateMachine,a=t.useStreamingUpload,o=void 0!==a&&a;this._uploadService=r,this._uploadStateMachine=n,this._useStreamingUpload=o}return e.prototype.upload=function(e){var t=e.conflictBehavior,r=n.__rest(e,["conflictBehavior"]),s=r.qosData,c=new i.Qos({name:"VroomUploader.upload",extraData:s});return this._uploadState(r,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){return c.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return c.end({resultType:a.default.isCanceled(e)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,error:e.message,resultCode:o.getResultCodeFromError(e),extraData:n.__assign({},s,o.getQosExtraDataFromError(e))}),a.default.reject(e)})},e.prototype._uploadState=function(e,t){var r=this,n=t.sessionUrl,o=t.item,i=t.error;if(o)return a.default.resolve(o);if(i){var s=void 0;return n&&(s=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:n}).then(function(){},function(){})),a.default.resolve(s).then(function(){return a.default.reject(i)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return r._uploadState(e,t)})},e}();t.Uploader=s,t.default=s},"39db02180d2ec50cbbfb":function(e,t,r){"use strict";r.r(t);var n=r("680b7ac74280293b48f0"),a=r("95da7825c4969f34e250"),o=r("4fab54035bc77294dc42"),i=r("163bd1662ba0d8c200dc"),s=r("e87bb409a9007bb8123c"),c=r("63aeb04d7e4744f15272"),u=r("6187b1a01125644c0b13"),d=r("2807dfd01f20f29a2152"),l=r("e008263a4c0e246e4f4f"),f=r("64b1e6e25051aaaf0681"),m=r("6addfaf561d910b46fa0"),p=r("2c440e638bb16e83d44e"),h=r("26a436222c7071f5071f"),v=r("119e7fc4035eae889114"),_=r("64328bb588b46459132d"),g=r("6dec44e5485412f70439"),b=r("3da5d317c00adfe8f79c"),y=r("fdbcb7664c17b5b4e4d9"),S=r("01b70109f23a290743e9"),w=r("5f6c4af8cb56376acb4d"),E=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.folders,n=o.a.deserialize(t),a=n.endpoint,i=n.driveId,s=Object.keys(r)[0],c=r[s].progressItemKey;return function(e){return _.__awaiter(void 0,void 0,void 0,function(){var r,u,d,l,f,m,p;return _.__generator(this,function(h){switch(h.label){case 0:return l=Object(g.c)(n)+"/children",[4,e(Object(g.e)({url:l,method:"POST",body:{name:s,folder:{},"@microsoft.graph.conflictBehavior":"rename"},qosName:"createFolder",endpoint:a}))];case 1:return f=h.sent(),m=o.a.serialize({endpoint:a,driveId:i,itemId:f.id}),p=new w.a,c&&p.resolveItems({items:(r={},r[c]=_.__assign({},b.f.pack({itemKey:m})),r)}),p.invalidateItems({items:(u={},u[t]=[y.b],u)}),p.resolveItems({items:(d={},d[m]=_.__assign({},Object(S.a)({driveItem:f,parentFolderItemKey:t,endpoint:a})),d)}),e(p.execute()),[2]}})})}}),F=r("d27387ede93a2620cbf6"),T=r("5fef64b3561abb2ebffa"),R=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=o.a.deserialize(t);return function(e){return _.__awaiter(void 0,void 0,void 0,function(){var n,a;return _.__generator(this,function(o){switch(o.label){case 0:return a=Object(g.c)(r),[4,e(Object(g.e)({url:a,method:"DELETE",qosName:"deleteItem",endpoint:r.endpoint}))];case 1:return o.sent(),e(Object(F.b)({items:(n={},n[t]=[T.deletedFacet],n)})),[2]}})})}}),x=r("56aac858adc5742217b8"),O=r("a9dd204dd0bee7467912"),D=r("578e5017557fc66bb247"),I=r("a24d70c7702f13f024d9"),U=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.names,n=o.a.deserialize(t);return function(e){return _.__awaiter(void 0,void 0,void 0,function(){var a,o,i,s,c,u,d;return _.__generator(this,function(l){switch(l.label){case 0:return a=Object.keys(r)[0],o=r[a],i=o.newName,s=o.newExtension,c=Object(g.c)(n),u=e(Object(D.a)({fileName:T.fileNameFacet},t)).fileName,d="string"==typeof s?s:u&&u.extension||"",[4,e(Object(g.e)({url:c,method:"PATCH",body:{name:""+i+d},qosName:"renameItem",endpoint:n.endpoint})).then(function(r){var n,a,o=new w.a;o.invalidateItems({items:(n={},n[t]=[T.displayNameFacet],n)}),o.resolveItems({items:(a={},a[t]=_.__assign({},T.displayNameFacet.pack(r.name),T.fileNameFacet.pack(Object(S.b)(r.name||"",!!r.folder))),a)}),e(o.execute())}).catch(function(e){if(e instanceof I.GraphError&&e.status===x.b)throw new x.a({facets:_.__assign({},O.k.pack({})),innerError:e});throw e})];case 1:return l.sent(),[2]}})})}}),C=r("28d43522af463e91e061"),j=r("e98307e3d02bf06255ee"),q=r("0dcb4ef0c72818ebbce5"),B=r("c3cad731bb834f32ee95"),N=r("aed6969132a8e15168e7"),k=r("3bbe42d2eda1d0f5d766"),z=r("2be4cdf0880f45f00879"),M=r("3560af8f1e8ae6e7a04f"),P=r("eef09ec91afb2fd77b66"),K=r("c21819129ba64362c121"),A=r("4e318b84c4772f9f58b9"),Q=r("447964f318fe44ff3682"),L=r("0b8514f932f40951d460"),V=r("a5db57338f8274c3300c"),W=Object(M.a)(function(){return new q.UploadWaiter({},{})}),G=Object(M.a)(function(e){var t=e(g.b).dataRequestor,r=function(e){function t(t){return e.call(this,t,{performanceNow:N.performanceNow})||this}return _.__extends(t,e),t}(N.ActivityBandwidthVerifier),n=new j.UploadService({},{dataRequestor:t}),a=new B.UploadStateMachine({},{activityBandwidthVerifierType:r,uploadService:n});return new C.Uploader({},{uploadService:n,uploadStateMachine:a})}),H=0,J=Object(n.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,n=e.options.sourceEntries,a=o.a.deserialize(r),i=a.endpoint,s=a.driveId,c=Object.keys(n)[0],u=n[c].progressItemKey;return function(e){return _.__awaiter(t,void 0,void 0,function(){var t,n,d,l,f,m,p,h,v;return _.__generator(this,function(E){switch(E.label){case 0:if(!(f=e(Object(D.a)({sourceFile:K.b},c)).sourceFile))throw new Error("No source file for Graph upload.");return m=Object(g.c)(a)+":",u&&e(Object(A.a)({items:(t={},t[u]=_.__assign({},b.p.pack({total:f.size,current:0})),t)})),[4,e(X({progressItemKey:u,sourceFile:f,itemUrl:m,endpoint:i}))];case 1:return p=E.sent(),h=o.a.serialize({endpoint:i,driveId:s,itemId:p.id}),v=new w.a,u&&v.resolveItems({items:(n={},n[u]=_.__assign({},b.f.pack({itemKey:h}),Object(Q.d)({progressSize:b.p},{progressSize:{current:f.size}})),n)}),v.invalidateItems({items:(d={},d[r]=[y.b],d)}),v.resolveItems({items:(l={},l[h]=_.__assign({},Object(S.a)({driveItem:p,parentFolderItemKey:r,endpoint:i})),l)}),e(v.execute()),[2]}})})}});function X(e){var t=this,r=e.progressItemKey,n=e.sourceFile,a=e.itemUrl,o=e.endpoint;return function(e){return _.__awaiter(t,void 0,void 0,function(){var t,i,s,c,u,d,l,f,m,p;return _.__generator(this,function(h){switch(h.label){case 0:return t=e(G),i=e(W),[4,e(Object(k.a)(o))];case 1:s=h.sent(),c=new z.a,u=0,d=c.debounce(function(t){var n;t>u&&(r&&e(Object(A.a)({items:(n={},n[r]=Object(Q.d)({progressSize:b.p},{progressSize:{current:t}}),n)})),u=t)},300,{leading:!1}),l=e(Object(P.a)(function(e){return e.demandItemFacet(b.e,r)})),f=t.upload({conflictBehavior:"fail",qosData:{uploadId:""+ ++H},accessToken:s,fileName:n.name,content:n,itemUrl:a,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return i.wait(e)}}),m=l?l.token.subscribe(function(){f.cancel()}):void 0,h.label=2;case 2:return h.trys.push([2,4,5,6]),[4,f];case 3:return[2,h.sent()];case 4:if(p=h.sent(),L.default.isCanceled(p))throw new V.CancelError;throw p;case 5:return m&&m(),c.dispose(),[7];case 6:return[2]}})})}}var Y=r("cfef2ab49d0d7bc1e869"),Z=r("3c5e58fee5b0e3275498"),$=r("36e2fbcb644dd53b7016"),ee=r("f5454705d9d5f89bad27"),te=r("e66c59a0c38d59122168"),re=r("2852e19dad7ee30e33c6"),ne=(new te.a("addToOneDrive",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.a}))}),new te.a("canCreateFolder",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.b}))})),ae=(new te.a("canCreateLink",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.c}))}),new te.a("canDelete",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.d}))})),oe=new te.a("canDownload",function(e,t){return!e.demandItemFacet(re.b,t.itemKey)&&ce(e,_.__assign({},t,{commandFacet:$.e}))}),ie=(new te.a("canInvite",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.f}))}),new te.a("canMove",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.g}))}),new te.a("canUseOfficeLens",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.h}))}),new te.a("canRename",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.i}))})),se=new te.a("canUpload",function(e,t){return ce(e,_.__assign({},t,{commandFacet:$.j}))});function ce(e,t){var r=t.itemKey,n=t.commandFacet,a=e.demandItemFacet(o.a,r);if(!a)return!1;var i=a.endpoint,s=a.driveId,c=e.demandItemFacet(n,ee.a.serialize({endpoint:i,driveId:s}));return!!c&&!!c.roles&&function(e,t){var r=t.itemKey,n=t.oneOfRequiredRoles,a=function(e,t){if(function(e,t){var r=e.demandItemFacet(Z.a,t);return!r||!r.effectiveRoles||!r.owner}(e,t))return["read","write","owner"];var r=e.demandItemFacet(Z.a,t);if(r&&r.effectiveRoles)return r.effectiveRoles;return[]}(e,r);return function(e,t){var r=t.oneOfRequiredRoles,n=t.effectiveRoles;for(var a in n)if(a in r)return!0;return!1}(0,{oneOfRequiredRoles:n,effectiveRoles:a})}(e,{itemKey:r,oneOfRequiredRoles:c.roles})}var ue=Object(a.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ne,r),validator:Y.a}}}});var de=Object(a.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ie,r),validator:Y.a}}}});var le=Object(a.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ae,r)}}}});var fe=Object(a.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(se,r)}}}});var me=Object(a.a)()(function(){return function(e){return pe}});function pe(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(T.folderFacet,r))return{};var n=e.demandItemFacet(o.a,r),a=n?Object(g.c)(n):void 0,i=n&&n.endpoint||"";return{isAvailable:e.demandItemFacet(oe,r),getDownloadData:a?function(){return function(e){var t=this,r=e.itemUrl,n=e.endpoint;return function(a){return _.__awaiter(t,void 0,void 0,function(){var t,o,i,s;return _.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,a(Object(g.e)({url:e.itemUrl,method:"GET",qosName:"getItemDownloadUrl",endpoint:n}))];case 1:if(t=c.sent(),!(o=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:o}];case 2:throw(i=c.sent())instanceof I.GraphError?(s=Object(I.getErrorResolution)(i,function(e,t){switch(e){case"unauthenticated":case 401:return O.b.pack({});case"itemNotFound":case 404:return O.e.pack({});case"accessDenied":case 403:return O.a.pack({});default:return O.k.pack({})}}),new x.a({innerError:i,facets:s})):i;case 3:return[2]}})})}}({itemUrl:a,endpoint:i})}:void 0}}var he=Object(a.a)()(function(){return function(e){return ve}});function ve(e,t){var r=t.itemKey,n=e.demandItemFacet(o.a,r);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return _.__awaiter(t,void 0,void 0,function(){var t,n,a;return _.__generator(this,function(o){switch(o.label){case 0:return(t=e.driveItem)?(n=Object(g.c)(t)+"/invite",[4,r(Object(g.f)({url:n,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(a=o.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:a.value[0].link.webUrl,scope:a.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:n})}}}var _e=Object(a.a)()(function(){return function(){return function(){return{}}}});var ge=Object(a.a)()(function(){return function(e){return be}});function be(e,t){var r=t.itemKey,n=t.link,a=t.recipients,i=e.demandItemFacet(o.a,r);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return _.__awaiter(t,void 0,void 0,function(){var t,n,a,o,i,s,c,u,d,l,f;return _.__generator(this,function(m){switch(m.label){case 0:if(t=e.driveItem,n=e.link,a=e.recipients,!t)throw new Error("Unable to obtain default share URL");return o=t.endpoint,s=btoa(n),i="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),c=a.map(function(e){return{email:e}}),u={recipients:c,roles:["read"]},d=o+"/shares/"+i+"/permission/grant",[4,r(Object(g.f)({url:d,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:u}))];case 1:return l=m.sent(),f=l.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}}),[2,{recipients:f}]}})})}}({driveItem:i,link:n,recipients:a})}}}var ye=r("1bf44020f3901b4e05c2"),Se=Object(a.a)()(function(){return function(e){return we}});function we(e,t){var r=t.itemKey,n=t.desiredSize,a=e.demandItemFacet(o.a,r),i=function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t}(e.demandItemFacet(ye.a,r));return a&&i&&i.large?{thumbnail:{url:Te(i.large.url,n),width:0,height:0}}:{}}var Ee=/width=[0-9]*/,Fe=/height=[0-9]*/;function Te(e,t){var r=""+(t.width||"");Ee.test(e)?e=e.replace(Ee,"width="+r):e+=(e.indexOf("?")>-1?"&":"?")+"width="+r;var n=""+(t.height||"");return Fe.test(e)?e=e.replace(Fe,"height="+n):e+=(e.indexOf("?")>-1?"&":"?")+"height="+n,e}var Re=r("664990b3cc9463570172"),xe=r("7a458e85783b71176e85"),Oe=r("38b5b26773d7dabe2878"),De=Object(n.e)()(function(e){var t=e.itemKey,r=e.options.isFollowed,n=Oe.a.deserialize(t),a=n.driveItemKey,o=a.itemId,i=void 0===o?"":o;return function(e){return _.__awaiter(void 0,void 0,void 0,function(){var t,o,s,c,u,d;return _.__generator(this,function(l){switch(l.label){case 0:return s=Object(g.c)(a),r?(c=s+"/follow",[4,e(Object(g.e)({url:c,method:"POST",qosName:"followItem",endpoint:a.endpoint}))]):[3,2];case 1:return l.sent(),[3,4];case 2:return c=a.endpoint+"/drives/"+a.driveId+"/following/"+i,[4,e(Object(g.e)({url:c,method:"DELETE",qosName:"unfollowItem",endpoint:a.endpoint}))];case 3:l.sent(),l.label=4;case 4:return u=new w.a,d=Oe.a.serialize(n),u.invalidateItems({items:(t={},t[d]=[T.isFollowedFacet],t)}),u.resolveItems({items:(o={},o[d]=_.__assign({},T.isFollowedFacet.pack(r)),o)}),e(u.execute()),[2]}})})}}),Ie=r("22bfccc2773074be6880"),Ue=r("e03a358d7e9a80ade819"),Ce=r("7e3c1a3ef9a4a6f39fb9"),je=r("d6c3da553edc07112fb2");function qe(e,t){return je.a.serialize(_.__assign({},{driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Be=Object(a.a)()(ke),Ne=Object(a.a)()(ke);function ke(){return function(e){return function(e,t){var r,n=t.itemKey,a=e.demandItemFacet(Ce.a,n);if(a)r=function(e){return a?qe(a,e):void 0};else{var o=e.demandItemFacet(je.a,n);r=function(e){return o?qe(o,e):void 0}}return{isAvailable:!0,getSearchItemKey:r}}}}r.d(t,"graphAddonDeferred",function(){return ze});var ze=Object(n.b)(function(){return function(e){e(Object(a.d)(Ce.a,Ue.a)(Be)),e(Object(a.d)(je.a,Ue.a)(Ne)),e(Object(n.f)(o.a,i.b)(E)),e(Object(n.f)(o.a,s.b)(R)),e(Object(n.f)(o.a,c.b)(U)),e(Object(n.f)(o.a,u.b)(J)),e(Object(a.d)(o.a,d.a)(ue)),e(Object(a.d)(o.a,l.a)(de)),e(Object(a.d)(o.a,f.b)(le)),e(Object(a.d)(o.a,m.a)(fe)),e(Object(a.d)(o.a,Re.a)(he)),e(Object(a.d)(o.a,xe.a)(ge)),e(Object(a.d)(o.a,p.a)(me)),e(Object(a.d)(o.a,h.a)(Se)),e(Object(a.d)(o.a,v.a)(_e)),e(Object(n.f)(Oe.a,Ie.b)(De))}})},"664990b3cc9463570172":function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=new(r("264a40ebead766e0e784").ControlFacet)("getDefaultShareLinkActionControl")},"7a458e85783b71176e85":function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=new(r("264a40ebead766e0e784").ControlFacet)("permissionInviteActionControl")},aed6969132a8e15168e7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=function(){function e(e,t){this._performanceNow=t.performanceNow,this._startTime=this._performanceNow(),this._expirationTime=this._startTime+e.timeout,this._totalBytes=e.totalBytes,this._progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5},e.prototype._getRateRatio=function(e){this._progressPoints++;var t,r=this._performanceNow(),n=r-this._startTime,a=this._expirationTime-r,o=this._totalBytes-e;return(this._progressPoints>=4&&n>=4e3||this._progressPoints>0&&0===o)&&a>0&&(t=o/a/(e/n)),t},e}();t.ActivityBandwidthVerifier=n},c21819129ba64362c121:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o});var n=r("447964f318fe44ff3682"),a=new n.a("entryBatch"),o=new n.a("sourceFile")},c3cad731bb834f32ee95:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("64328bb588b46459132d"),a=r("a24d70c7702f13f024d9"),o=r("4e087ea06522888b2152"),i=r("0b8514f932f40951d460"),s=r("c1a09d7dd35e11297e15"),c=62914560,u=Math.pow(2,.25),d=function(){function e(e,t){this._uploadService=t.uploadService,this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var r=t.useCommitForUpload,n=void 0!==r&&r,a=t.checkForCompletedUploadOnSessionTermination,o=void 0===a||a,i=t.shouldCancelOnCompleteFailure,s=void 0===i||i,u=t.maximumFragmentSize,d=void 0===u?c:u;this._shouldCancelOnCompleteFailure=s,this._useCommitForUpload=n,this._checkForCompletedUploadOnSessionTermination=o,this._maximumFragmentSize=d}return e.prototype.advanceState=function(e,t){var r=this,n=t.sessionUrl,a=t.nextExpectedRanges;return(n?a?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?r._handleGeneralErrorState(e,t):r._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})},e.prototype._createSessionState=function(e,t){var r=this,i=e.qosData,s=new o.Qos({name:"VroomUploader.createSession",extraData:i});return this._uploadService.createSession({qosData:i,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior}).then(function(e){return s.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(c){return r._handleCreateSessionErrorState(e,r._getState(t,{error:c})).then(function(e){return e.error?s.end({resultType:o.ResultTypeEnum.Failure,error:c.message,resultCode:a.getResultCodeFromError(c),extraData:n.__assign({},i,a.getQosExtraDataFromError(c))}):s.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),e})})},e.prototype._handleCreateSessionErrorState=function(e,t){var r=this;return this._handleErrorState(t,function(n,a){switch(n){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(a,e,t)}})},e.prototype._getStatusState=function(e,t){var r=this,i=e.qosData,s=new o.Qos({name:"VroomUploader.getStatus",extraData:i});return this._uploadService.getStatus({qosData:i,sessionUrl:t.sessionUrl}).then(function(e){return s.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){return s.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},i,a.getQosExtraDataFromError(e))}),r._getState(t,{error:e})})},e.prototype._uploadItemState=function(e,t){var r=this,i=e.qosData,s=e.content.size,c=this._getNextRange({fileSize:s,nextExpectedRanges:t.nextExpectedRanges}),u=new o.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(c&&c.start<s?t.allowStreaming?this._uploadStreamState({nextRange:c},e,t):this._uploadFragmentState({nextRange:c},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){return t.error?r._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;return t?u.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:a.getResultCodeFromError(t),extraData:n.__assign({},i,a.getQosExtraDataFromError(t))}):u.end({resultType:o.ResultTypeEnum.Success}),e}):(u.end({resultType:o.ResultTypeEnum.Success}),t)})},e.prototype._terminateUploadOnCompleteFailure=function(e){return i.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))},e.prototype._uploadFragmentState=function(e,t,r){var i=this,c=e.nextRange,d=t.onProgress,l=t.content,f=t.content.size,m=t.qosData,p=r.sessionUrl,h=r.speed,v=void 0===h?1/8:h,_=c.start,g=c.end;d&&d(_);var b,y,S=this._getFragmentSize(v),w=Math.min(_+S,g),E=new s.default(function(){b&&b.cancel()}),F=v>1/1920?6e4:3e5,T=new this._activityBandwidthVerifierType({timeout:F,totalBytes:w-_}),R=new o.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign({},m,{startByte:_,endByte:w,fileSize:f,speed:v,fragmentSize:S})});return(b=this._uploadService.uploadFragment({qosData:m,sessionUrl:p,startByte:_,endByte:w,fileSize:f,content:l.slice(_,w),timeout:F,onProgress:function(e){y=e,v>1/1920&&!T.doesActivityHaveRemainingCapacity(e-_)&&(R.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign({},m,{lastByte:e})}),E.complete(i._getState(r,{speed:Math.max(.5*v,1/1920),nextExpectedRanges:void 0})),b&&b.cancel()),d&&d(e)}}).then(function(e){return d&&d(w),R.end({resultType:o.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(T.didActivityHaveExtraCapacity()?v*u:v,1)})},function(e){return R.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},m,a.getQosExtraDataFromError(e),{lastByte:y})}),i._getState(r,{error:e})})).done(function(e){E.complete(e)}),E.getPromise()},e.prototype._uploadStreamState=function(e,t,r){var i=this,c=e.nextRange,u=t.onProgress,d=t.content,l=t.content.size,f=t.qosData,m=r.sessionUrl,p=c.start,h=c.end,v=Math.min(h-p,this._maximumFragmentSize),_=p+v;u&&u(p);var g,b=new s.default(function(){g&&g.cancel()}),y=new o.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign({},f,{startByte:p,endByte:_,fileSize:l,fragmentSize:v})});return(g=this._uploadService.uploadFragment({qosData:f,sessionUrl:m,startByte:p,endByte:_,fileSize:l,content:d.slice(p,_),timeout:864e5,onProgress:function(e){u&&u(e)}}).then(function(e){return u&&u(_),y.end({resultType:o.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges})},function(e){return y.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},f,a.getQosExtraDataFromError(e),{lastByte:void 0})}),i._handleUploadStreamErrorState({nextRange:c},t,i._getState(r,{error:e}))})).done(function(e){b.complete(e)}),b.getPromise()},e.prototype._handleUploadStreamErrorState=function(e,t,r){var n=this,a=e.nextRange;return this._handleErrorState(r,function(e){switch(e){case 0:return n._wait({duration:1e3},t).then(function(){return n._getStatusState(t,r).then(function(e){return n._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>a.start?e:n._getState(r,{allowStreaming:!1})})})}})},e.prototype._commitState=function(e,t){var r=this,i=e.qosData,s=e.onProgress;s&&s(e.content.size);var c=new o.Qos({name:"VroomUploader.commit",extraData:i});return this._uploadService.commit({qosData:i,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){return c.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{item:e})},function(e){return r._handleCommitErrorState(r._getState(t,{error:e})).then(function(t){return c.end({resultType:t.error?o.ResultTypeEnum.Failure:o.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},i,a.getQosExtraDataFromError(e))}),t})})},e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(r){switch(r){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return i.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})},e.prototype._cancelSessionState=function(e,t){var r=this,i=e.qosData,s=new o.Qos({name:"VroomUploader.cancelSession",extraData:i});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){return s.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{sessionUrl:void 0})},function(e){return s.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},i,a.getQosExtraDataFromError(e))}),r._getState(t,{sessionUrl:void 0})})},e.prototype._handleUploadItemErrorState=function(e,t){var r=this,n=t.speed,a=void 0===n?1:n;return t=this._getState(t,{nextExpectedRanges:void 0}),this._handleErrorState(t,function(n,o){switch(n){case 0:return window.navigator.onLine?t.allowStreaming?i.default.resolve(r._getState(t,{allowStreaming:!1})):i.default.resolve(r._getState(t,{speed:Math.max(a*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return i.default.resolve(r._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return r._wait({duration:1e3},e).then(function(){return r._getState(t,{error:void 0})})}})},e.prototype._getItemIfCompletedState=function(e,t){var r=this,i=e.qosData,s=new o.Qos({name:"VroomUploader.getItemIfCompleted",extraData:i});return this._uploadService.getItem({qosData:i,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){return s.end({resultType:o.ResultTypeEnum.Success}),e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?r._getState(t,{item:n,error:void 0}):r._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){return s.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},i,a.getQosExtraDataFromError(e))}),r._getState(t,{error:e})})},e.prototype._handleGeneralErrorState=function(e,t){var r=this,n=t.waitDuration,a=void 0===n?500:n,o=t.attemptsRemaining,i=void 0===o?10:o;return this._handleErrorState(t,function(n){switch(n){case"uploadSessionNotFound":return r._checkForCompletedUploadOnSessionTermination?r._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof n){if(n>=400&&n<500)return;if(0===n||n>=500&&n<600)return r._wait({duration:a,allowWakeWhenOnline:!0},e).then(function(){return r._getState(t,{error:void 0,waitDuration:Math.min(2*a,3e4),attemptsRemaining:void 0})});if(!i)return;return r._wait({duration:1e3},e).then(function(){return r._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(i-1,0)})})}})},e.prototype._handleErrorState=function(e,t){var r=e.error,n=a.getErrorResolution(r,t);return void 0===n&&(n=i.default.resolve(e)),n},e.prototype._promptForConflictBehaviorState=function(e,t,r){var s=this,c=t.onPromptForConfictBehavior,u=t.qosData,d=new o.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:u});return i.default.resolve().then(function(){return c(e)}).then(function(e){return d.end({resultType:o.ResultTypeEnum.Success,extraData:u}),s._getState(r,{error:void 0,conflictBehavior:e})},function(t){return d.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:a.getResultCodeFromError(e),extraData:n.__assign({},u,a.getQosExtraDataFromError(t))}),s._getState(r,{error:t})})},e.prototype._wait=function(e,t){var r=e.duration,n=e.allowWakeWhenOnline,s=t.onWait,c=t.qosData,u=new o.Qos({name:"VroomUploader.wait",extraData:c});return i.default.resolve(s({duration:r,allowWakeWhenOnline:n})).then(function(){u.end({resultType:o.ResultTypeEnum.Success})},function(e){return u.end({resultType:i.default.isCanceled(e)?o.ResultTypeEnum.Success:o.ResultTypeEnum.Failure,error:e&&e.message,resultCode:a.getResultCodeFromError(e)}),i.default.reject(e)})},e.prototype._getState=function(e,t){return n.__assign({},e,t)},e.prototype._getNextRange=function(e){var t=e.fileSize,r=e.nextExpectedRanges;return(void 0===r?[]:r).reduce(function(e,r){var n,a=r.split("-",2),o=a[0],i=a[1],s=parseInt(o,10);!e||s<e.start&&s<t?n={start:s,end:""===i?t:Math.min(parseInt(i,10)+1,t)}:n=e;return n},void 0)},e.prototype._isItem=function(e){return!!e.id},e.prototype._getFragmentSize=function(e){var t,r=e*c;return t=r>327680?r-r%327680:r-r%32768,Math.min(Math.max(t,32768),this._maximumFragmentSize)},e}();t.UploadStateMachine=d},e98307e3d02bf06255ee:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("64328bb588b46459132d"),a=r("c1a09d7dd35e11297e15"),o=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,a=e.accessToken,o=e.fileName,s=e.fileSize,c=e.lastModifiedDate,u=e.eTag,d=e.conflictBehavior,l={item:n.__assign({},i(r)?{"@microsoft.graph.conflictBehavior":d}:{"@name.conflictBehavior":d},c?{fileSystemInfo:{lastModifiedDateTime:c.toISOString()}}:{})},f=n.__assign({},u?{"If-Match":u}:{},{Prefer:"synchronousmetadata"});return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o)+":/"+(i(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:f,accessToken:a,useAuthorizationHeaders:!0,postData:JSON.stringify(l),qosExtraData:n.__assign({conflictBehavior:d,fileSize:s},t)})},e.prototype.cancelSession=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.uploadFragment=function(e){var t=e.qosData,r=e.sessionUrl,o=e.startByte,i=e.endByte,s=e.fileSize,c=e.content,u=e.timeout,d=e.onProgress,l={"Content-Range":"bytes "+o+"-"+Math.max(i-1,o)+"/"+s},f=!0,m=this._dataRequestor.send({path:r,needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:l,postData:c,timeout:u,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&f&&d(o+e.loaded)},qosExtraData:n.__assign({},t,{startByte:o,endByte:i,fileSize:s})}),p=new a.default(function(){f=!1,m.cancel()});return m.done(function(e){f=!1,p.complete(e)},function(e){f=!1,p.error(e)}),p.getPromise()},e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,a=e.accessToken,o=e.fileName,s=(e.description,e.eTag),c=e.conflictBehavior,u=e.sessionUrl,d={"If-Match":s},l=i(r)?{"@microsoft.graph.conflictBehavior":c,"@microsoft.graph.sourceUrl":u}:{"@name.conflictBehavior":c,"@content.sourceUrl":u};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:d,accessToken:a,useAuthorizationHeaders:!0,postData:JSON.stringify(l),qosExtraData:n.__assign({conflictBehavior:c},t)})},e.prototype.getStatus=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,a=e.accessToken,o=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(o),useAuthorizationHeaders:!0,accessToken:a,qosExtraData:n.__assign({},t)})},e}();function i(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}t.UploadService=o}}]);