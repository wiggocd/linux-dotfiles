(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[47],{"3c942398161a09cbb4d7":function(t,e,n){"use strict";n.r(e);var r=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),s=n("47abe75ff47c370e8091"),i=n("877a6e603323418b7008"),o=n("a032c788b45e976efa61"),c=n("9b73502a4fb17676c09d"),l=n("82a5b752ca799aba4856"),d=n("d915b981cf8f9e330a1a"),p=n("53d65358d43e356fac63"),m=n("222b3f6c82513e602ebc"),u=n("da7bfc878b0cf66154c2"),f=n("b912ecc4473ae8a2ff0b"),b=n("44f64afe8913260e06f6"),_=n("67cd898f5a9495f1e843"),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listAriaLabel=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_TRANSCRIPT_LIST_ARIA_LABEL),e.selectedEntryAriaLabel=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_TRANSCRIPT_ENTRY_SELECTED_ARIA_LABEL),e.renderTranscriptItem=function(t){var n,r,s=(null===(r=e.props.selectedTranscript)||void 0===r?void 0:r.transcriptId)===t.transcriptId,i=e.props.l10n.formatDateTime(t.createTime,c.a.LONG_DATE,!0),o=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_TRANSCRIPT_ENTRY_ARIA_LABEL,{entryName:i});return a.createElement(l.a,{role:"listitem","aria-label":o,key:t.transcriptId,onClick:e.onClick.bind(e,t),className:f((n={},n[u.transcriptSelectorButton]=!0,n[u.selected]=s,n))},i)},e}return Object(r.__extends)(e,t),e.prototype.render=function(){return a.createElement(d.a,{direction:p.a.vertical},a.createElement(m.a,{role:"list","aria-label":this.listAriaLabel,items:this.props.associatedTranscripts,onRenderCell:this.renderTranscriptItem}))},e.prototype.onClick=function(t){this.props.selectTranscript(t),this.props.ariaLiveContext.announce(this.selectedEntryAriaLabel)},e}(a.PureComponent),h=Object(i.a)(o.a,b.a)(T),g=n("5b2d459d9e82cf3bf3bf"),v=n("486d0f083e13728083f0"),P=n("80d2fe5fad76c7d24717"),A=n("aa82b29957b8abcd1e1b"),y=r.__assign;function N(t,e){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var i=t;return i.isSlot?0===a.Children.count(n)?i(e):(n=a.Children.toArray(n),i(r.__assign({},e,{children:n}))):a.createElement.apply(a,[t,e].concat(n))}function E(t,e){void 0===e&&(e={});var n=e.defaultProp,s=void 0===n?"children":n;return function(e,n,i){if(a.isValidElement(n))return n;if("function"==typeof n)return n(function(n,r){var a=x(s,r);return a=S(i,e,a),n(t,a)});n=x(s,n);var o=S(i,e,n);return a.createElement(t,r.__assign({},o))}}var D=Object(A.b)(function(t){return E(t)});function w(t,e){var n={},r=t,a=function(t){if(e.hasOwnProperty(t)){var a=function(n){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];if(a.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return function(t,e,n,r){return void 0!==t.create?t.create(e,n,r):D(t)(e,n,r)}(e[t],n,r[t],r._defaultStyles&&r._defaultStyles[t])};a.isSlot=!0,n[t]=a}};for(var s in e)a(s);return n}function x(t,e){return"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e||((n={})[t]=e,e=n),e;var n}function S(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r={},a=[],s=0,i=e;s<i.length;s++){var o=i[s];a.push(o&&o.className),y.apply(void 0,[r].concat(o))}return r.className=Object(g.Y)(t,a),r}function C(t){var e=t.factoryOptions,n=(void 0===e?{}:e).defaultProp,s=function(e){return a.createElement(v.a.Consumer,null,function(n){var s=function(t,e,n){return P.a.getSettings(n||["theme","styles","tokens"],t,e.customizations)}(t.displayName,n,t.fields),i=function(n){var a=n?r.__assign({},e,n):e,i=a.theme||s.theme,o=function t(e,n){var r=[];for(var a=2;a<arguments.length;a++)r[a-2]=arguments[a];var s={};for(var i=0,o=r;i<o.length;i++){var c=o[i];c&&(c="function"==typeof c?c(e,n):c,Array.isArray(c)&&(c=t.apply(void 0,[e,n].concat(c))),y.apply(void 0,[s].concat(c)))}return s}(a,i,t.tokens,s.tokens,a.tokens),c=function(t,e,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return g.F.apply(void 0,r.map(function(r){return"function"==typeof r?r(t,e,n):r}))}(a,i,o,t.styles,s.styles,a.styles),l=r.__assign({},a,{styles:c,tokens:o,_defaultStyles:c});return t.view(l)};return t.state?a.createElement(t.state,r.__assign({},e,{renderView:i})):i()})};return s.displayName=t.displayName,n&&(s.create=E(s,{defaultProp:n})),y(s,t.statics),s}var k,I=n("cadf351e66a0d5bfc60e"),L=C({displayName:"Text",styles:function(t,e){var n=t.as,r=t.className,a=t.block,s=t.nowrap,i=t.variant,o=e.fonts[i||"medium"];return{root:[e.fonts.medium,{display:a?"td"===n?"table-cell":"block":"inline",fontFamily:o&&o.fontFamily||"inherit",fontSize:o&&o.fontSize||"inherit",fontWeight:o&&o.fontWeight||"inherit",color:o&&o.color||"inherit",mozOsxFontSmoothing:o&&o.MozOsxFontSmoothing,webkitFontSmoothing:o&&o.WebkitFontSmoothing},s&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},r]}},view:function(t){if(!t.children)return null;t.block,t.className;var e=t.as,n=void 0===e?"span":e,a=(t.variant,t.nowrap,r.__rest(t,["block","className","as","variant","nowrap"]));return N(w(t,{root:n}).root,r.__assign({},Object(I.j)(a,I.k)))}}),B=n("e026eb6ba07db166b8ec"),O=n("a5b2c2b80d41b1456c8c"),R=n("f1b80114f5918facb76a"),z=n("25c44098a85de94290b4"),j={root:"ms-StackItem"},U={start:"flex-start",end:"flex-end"},W=C({displayName:"StackItem",styles:function(t,e,n){var r=t.grow,a=t.shrink,s=t.disableShrink,i=t.align,o=t.verticalFill,c=t.order,l=t.className,d=Object(g.N)(j,e);return{root:[e.fonts.medium,d.root,{margin:n.margin,height:o?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(s||!r&&!a)&&{flexShrink:0},a&&!s&&{flexShrink:1},i&&{alignSelf:U[i]||i},c&&{order:c},l]}},view:function(t){var e=t.children;return a.Children.count(e)<1?null:N(w(t,{root:"div"}).root,null,e)}}),F=function(t,e){return e.spacing.hasOwnProperty(t)?e.spacing[t]:t},M=function(t){var e=parseFloat(t),n=isNaN(e)?0:e,r=isNaN(e)?"":e.toString();return{value:n,unit:t.substring(r.toString().length)||"px"}},G=function(t,e){if(void 0===t||"number"==typeof t||""===t)return t;var n=t.split(" ");return n.length<2?F(t,e):n.reduce(function(t,n){return F(t,e)+" "+F(n,e)})},V={start:"flex-start",end:"flex-end"},Q={root:"ms-Stack",inner:"ms-Stack-inner"},K=N(W,null).type,H=C({displayName:"Stack",styles:function(t,e,n){var a,s,i,o,c,l,d,p=t.verticalFill,m=t.maxWidth,u=t.maxHeight,f=t.horizontal,b=t.reversed,_=t.gap,T=t.grow,h=t.wrap,v=t.padding,P=t.horizontalAlign,A=t.verticalAlign,y=t.disableShrink,N=t.className,E=Object(g.N)(Q,e),D=function(t,e){if(void 0===t||""===t)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof t)return{rowGap:{value:t,unit:"px"},columnGap:{value:t,unit:"px"}};var n=t.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:M(F(n[0],e)),columnGap:M(F(n[1],e))};var r=M(F(t,e));return{rowGap:r,columnGap:r}}(n&&n.childrenGap?n.childrenGap:_,e),w=D.rowGap,x=D.columnGap,S=""+-.5*x.value+x.unit,C=""+-.5*w.value+w.unit,k={textOverflow:"ellipsis"},I={"> *:not(.ms-StackItem)":{flexShrink:y?0:1}};return h?{root:[E.root,{flexWrap:"wrap",maxWidth:m,maxHeight:u,width:"auto",overflow:"visible",height:"100%"},P&&(a={},a[f?"justifyContent":"alignItems"]=V[P]||P,a),A&&(s={},s[f?"alignItems":"justifyContent"]=V[A]||A,s),N,{display:"flex"},f&&{height:p?"100%":"auto"}],inner:[E.inner,{display:"flex",flexWrap:"wrap",marginLeft:S,marginRight:S,marginTop:C,marginBottom:C,overflow:"visible",boxSizing:"border-box",padding:G(v,e),width:0===x.value?"100%":"calc(100% + "+x.value+x.unit+")",maxWidth:"100vw",selectors:r.__assign({"> *":r.__assign({margin:""+.5*w.value+w.unit+" "+.5*x.value+x.unit},k)},I)},P&&(i={},i[f?"justifyContent":"alignItems"]=V[P]||P,i),A&&(o={},o[f?"alignItems":"justifyContent"]=V[A]||A,o),f&&{flexDirection:b?"row-reverse":"row",height:0===w.value?"100%":"calc(100% + "+w.value+w.unit+")",selectors:{"> *":{maxWidth:0===x.value?"100%":"calc(100% - "+x.value+x.unit+")"}}},!f&&{flexDirection:b?"column-reverse":"column",height:"calc(100% + "+w.value+w.unit+")",selectors:{"> *":{maxHeight:0===w.value?"100%":"calc(100% - "+w.value+w.unit+")"}}}]}:{root:[E.root,{display:"flex",flexDirection:f?b?"row-reverse":"row":b?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:p?"100%":"auto",maxWidth:m,maxHeight:u,padding:G(v,e),boxSizing:"border-box",selectors:r.__assign((c={"> *":k},c[b?"> *:not(:last-child)":"> *:not(:first-child)"]=[f&&{marginLeft:""+x.value+x.unit},!f&&{marginTop:""+w.value+w.unit}],c),I)},T&&{flexGrow:!0===T?1:T,overflow:"hidden"},P&&(l={},l[f?"justifyContent":"alignItems"]=V[P]||P,l),A&&(d={},d[f?"alignItems":"justifyContent"]=V[A]||A,d),N]}},view:function(t){var e=t.as,n=void 0===e?"div":e,s=t.disableShrink,i=t.wrap,o=r.__rest(t,["as","disableShrink","wrap"]),c=a.Children.map(t.children,function(t,e){if(!t)return null;if(t.type===K){var n={shrink:!s};return a.cloneElement(t,r.__assign({},n,t.props))}return t}),l=Object(I.j)(o,I.k),d=w(t,{root:n,inner:"div"});return N(d.root,r.__assign({},l),i?N(d.inner,null,c):c)},statics:{Item:W}}),q=n("adf6e81d5ecf9ea16532"),J=n("aeefbf4359e8464c5277"),Y=n("f67a6dabd9dd73397689"),X=n("2967cf8009428a9155fe");!function(t){t.None="None",t.Text="Text",t.CallStarted="CallStarted",t.CallEnded="CallEnded",t.TranscriptStarted="TranscriptStarted",t.TranscriptEnded="TranscriptStopped",t.ParticipantJoined="ParticipantJoined",t.ParticipantLeft="ParticipantLeft"}(k||(k={}));var Z,$=n("a4da794462f5c4005bac"),tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timestampColumn={key:"timestamp",name:"timestamp",fieldName:"timestamp",className:u.transcriptTimestamp,minWidth:60,maxWidth:60,onRender:e.renderTimestamp.bind(e)},e.profilePictureColumn={key:"key",name:"profilePicture",minWidth:30,maxWidth:30,onRender:e.renderProfilePicture.bind(e)},e.mainColumn={key:"text",name:"text",fieldName:"text",className:u.transcriptMain,minWidth:800,maxWidth:800,isMultiline:!0,onRender:e.renderMain.bind(e)},e.styles=function(){return{root:{backgroundColor:"transparent",selectors:{".ms-DetailsRow":{backgroundColor:"transparent",borderBottom:"none"},".ms-DetailsRow:hover":{backgroundColor:"transparent"}}},focusZone:void 0,headerWrapper:void 0,contentWrapper:void 0}},e}return Object(r.__extends)(e,t),e.prototype.render=function(){var t=this.props.subject?this.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_TITLE,{subject:this.props.subject}):"";return a.createElement(d.a,{direction:p.a.vertical},a.createElement(L,{className:u.transcriptTitle,variant:"xLarge",nowrap:!0,block:!0},t),a.createElement(B.a,Object(r.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(O.a,{ariaLabelForGrid:t,columns:this.props.showAvatars?[this.profilePictureColumn,this.mainColumn]:[this.timestampColumn,this.mainColumn],items:this.props.loadedTranscript,layoutMode:R.e.fixedColumns,selectionMode:z.c.none,isHeaderVisible:!1,styles:this.styles})))},e.prototype.renderTimestamp=function(t){return t.showTimestampAndAvatar?a.createElement(L,null,t.timestamp):null},e.prototype.renderMain=function(t){if(this.props.showAvatars)return t.type===k.Text&&t.showTimestampAndAvatar?a.createElement(H,{disableShrink:!0},a.createElement(H,{horizontal:!0,disableShrink:!0},a.createElement(L,{className:u.transcriptName},t.speakerDisplayName),a.createElement(L,{className:u.transcriptTimestamp},t.timestamp)),a.createElement(L,{className:u.transcriptText},t.text)):a.createElement(L,{className:u.transcriptText},t.text);if(t.type===k.Text)return a.createElement(L,{className:u.transcriptText},t.text);var e=t.type===k.ParticipantJoined||t.type===k.ParticipantLeft?X.c:X.lb;return a.createElement(H,{horizontal:!0,disableShrink:!0},a.createElement(q.a,{iconName:e,className:u.transcriptTextIcon}),a.createElement(L,{className:u.transcriptText},t.text))},e.prototype.renderProfilePicture=function(t){if(t.type!==k.Text){var e=t.type===k.ParticipantJoined||t.type===k.ParticipantLeft?X.c:X.lb;return a.createElement(q.a,{iconName:e,className:u.transcriptIcon})}return t.showTimestampAndAvatar?a.createElement($.d,{mri:t.speakerId,principalName:t.email,displayName:t.speakerDisplayName,retainInCache:!0,className:u.transcriptProfilePicture}):null},e}(a.PureComponent),et=Object(i.a)(J.a)(tt);!function(t){t.Vtt="vtt",t.Docx="docx",t.Pdf="pdf"}(Z||(Z={}));var nt=n("c9e31b10bd07e1d676f4"),rt=n("eb359d7693dd06453be6"),at=n("56e93fab5efcffbf24fb"),st=n("53075d34f004a33b5f03"),it=n("c5b9285a31a202d8d4f5"),ot=n("c9764d34b3eb6a106977"),ct=n("709c166948243d934acd"),lt=n("b0e26fa7634e6889091e"),dt=n("8183bb1c55fccc7b597d"),pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deleteDialogTitle=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_DELETE_DIALOG_TITLE),e.cancelButtonLabel=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_CANCEL_BUTTON_LABEL),e.deleteButtonLabel=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL),e}return Object(r.__extends)(e,t),e.prototype.render=function(){return a.createElement(B.a,Object(r.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(ot.a,{hidden:!this.props.showDialog,onDismiss:this.props.handleDialogClose,dialogContentProps:{type:ct.a.normal,title:this.deleteDialogTitle},modalProps:{styles:{main:{maxWidth:450}},isBlocking:!1}},a.createElement(lt.a,null,a.createElement(l.a,{onClick:this.props.handleDialogClose,text:this.cancelButtonLabel,autoFocus:!0,"data-tid":"transcript-tab-delete-dialog-cancel-button"}),a.createElement(dt.a,{onClick:this.props.handleDelete,disabled:this.props.disableDeleteButton,autoFocus:!0,text:this.deleteButtonLabel,"data-tid":"transcript-tab-delete-dialog-delete-button"}))))},e}(a.PureComponent),mt=Object(i.a)(J.a)(pt),ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.unavailableDialogTitle=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_UNAVAILABLE_DIALOG_TITLE),e.unavailableDialogSubtext=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_UNAVAILABLE_DIALOG_SUBTEXT),e.closeButtonLabel=e.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_CLOSE_BUTTON_LABEL),e}return Object(r.__extends)(e,t),e.prototype.render=function(){return a.createElement(B.a,Object(r.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(ot.a,{hidden:!this.props.showDialog,onDismiss:this.props.handleDialogClose,dialogContentProps:{type:ct.a.normal,title:this.unavailableDialogTitle,subText:this.unavailableDialogSubtext},modalProps:{styles:{main:{maxWidth:450}},isBlocking:!1}},a.createElement(lt.a,null,a.createElement(l.a,{onClick:this.props.handleDialogClose,text:this.closeButtonLabel,autoFocus:!0,"data-tid":"transcript-tab-unavailable-dialog-close-button"}))))},e}(a.PureComponent),ft=Object(i.a)(J.a)(ut),bt=function(t){function e(){var e,n=null!==t&&t.apply(this,arguments)||this;return n.buttonLabels=((e={})[_.Pb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL]=n.props.localizationProvider.translate(_.Pb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL),e[_.Pb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL]=n.props.localizationProvider.translate(_.Pb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL),e[_.Pb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL]=n.props.localizationProvider.translate(_.Pb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL),e[_.Pb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL]=n.props.localizationProvider.translate(_.Pb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL),e),n.state={showDeleteDialog:!1,showUnavailableDialog:!1,isDeleteButtonDisabled:!1},n.renderQuickActionBar=function(){return a.createElement(a.Fragment,null,n.state.selectedTranscript&&a.createElement("div",{className:u.transcriptQuickActionBar,role:"region"},a.createElement(st.a,{iconProps:{iconName:X.B,className:u.transcriptActionButtonIcon},menuProps:n.getDownloadMenuProps(),className:u.transcriptActionButton,"data-tid":"transcript-tab-download-button"},n.buttonLabels[_.Pb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL]),n.props.event.isOrganizer&&a.createElement(it.a,{onClick:n.deleteTranscript,disabled:n.state.isDeleteButtonDisabled,iconProps:{iconName:X.z,className:u.transcriptActionButtonIcon},className:u.transcriptActionButton,"data-tid":"transcript-tab-delete-button"},n.buttonLabels[_.Pb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL])))},n.renderDialogs=function(){return a.createElement(a.Fragment,null,a.createElement(mt,{showDialog:n.state.showDeleteDialog,disableDeleteButton:n.state.isDeleteButtonDisabled,localizationProvider:n.props.localizationProvider,handleDelete:n.handleDeleteDialogConfirm,handleDialogClose:n.handleDeleteDialogClose}),a.createElement(ft,{showDialog:n.state.showUnavailableDialog,localizationProvider:n.props.localizationProvider,handleDialogClose:n.handleUnavailableDialogClose}))},n.getDownloadMenuProps=function(){return{items:[{key:"downloadDocx",text:n.buttonLabels[_.Pb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL],iconProps:{iconName:"WordDocument"},data:Z.Docx,onClick:n.downloadTranscript,"data-tid":"transcript-tab-download-docx-button"},{key:"downloadVtt",text:n.buttonLabels[_.Pb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL],iconProps:{iconName:"TextDocument"},data:Z.Vtt,onClick:n.downloadTranscript,"data-tid":"transcript-tab-download-vtt-button"}]}},n.selectTranscript=function(t){n.setState({selectedTranscript:t,loadedTranscript:void 0}),n.loadTranscript(t.transcriptUrl)},n.downloadTranscript=function(t,e){var r;if((null==e?void 0:e.data)&&(null===(r=n.state.selectedTranscript)||void 0===r?void 0:r.transcriptUrl)){var a=e.data;n.props.transcriptProvider.downloadTranscript(n.state.selectedTranscript.transcriptUrl,a).then(function(){}).catch(function(t){n.setState({error:t})})}},n.deleteTranscript=function(){var t;(null===(t=n.state.selectedTranscript)||void 0===t?void 0:t.transcriptUrl)&&n.setState({showDeleteDialog:!0})},n.handleDeleteDialogConfirm=function(){var t;(null===(t=n.state.selectedTranscript)||void 0===t?void 0:t.transcriptUrl)?(n.setState({isDeleteButtonDisabled:!0}),n.props.transcriptProvider.deleteTranscript(n.state.selectedTranscript.transcriptUrl).then(function(){n.setState({associatedTranscripts:void 0,selectedTranscript:void 0,loadedTranscript:void 0,showDeleteDialog:!1,isDeleteButtonDisabled:!1}),n.loadAssociatedTranscripts()}).catch(function(t){n.setState({showDeleteDialog:!1,isDeleteButtonDisabled:!1,error:t})})):n.setState({showDeleteDialog:!1})},n.handleDeleteDialogClose=function(){n.setState({showDeleteDialog:!1})},n.handleUnavailableDialogClose=function(){n.setState({associatedTranscripts:void 0,selectedTranscript:void 0,loadedTranscript:void 0,showUnavailableDialog:!1}),n.loadAssociatedTranscripts()},n}return Object(r.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this.props.transcriptProvider.getDeepLinkedTranscript();t&&this.selectTranscript(t),this.loadAssociatedTranscripts()},e.prototype.componentDidUpdate=function(){this.loadAssociatedTranscripts()},e.prototype.render=function(){var t=this,e=this.state,n=e.associatedTranscripts,i=e.loadedTranscript,o=e.showAvatars,c=e.selectedTranscript;return a.createElement("div",{className:u.transcriptPage},this.renderQuickActionBar(),a.createElement("div",{className:u.transcriptMainContainer},n&&n.length>1&&a.createElement("div",{className:u.transcriptSelectorContainer},a.createElement(h,{selectTranscript:this.selectTranscript,selectedTranscript:c,associatedTranscripts:Object(r.__spreadArrays)(n),localizationProvider:this.props.localizationProvider})),a.createElement("div",{className:u.transcriptRendererContainer},i?a.createElement(rt.a,{category:at.a.Default},function(e){var n=e.enableCallTranscriptPostMeetingSpeakerAttribution;return a.createElement(et,{loadedTranscript:i,showAvatars:!!n&&!!o,subject:t.props.event.subject,localizationProvider:t.props.localizationProvider})}):a.createElement(s.a,{size:"large"}))),this.renderDialogs())},e.prototype.loadAssociatedTranscripts=function(){var t=this;!this.state.associatedTranscripts&&this.props.event&&this.props.event.skypeTeamsDataObj&&this.props.event.skypeTeamsDataObj.cid&&(this.setState({associatedTranscripts:[]}),this.props.transcriptProvider.getAssociatedTranscripts(this.props.event.skypeTeamsDataObj.cid,this.props.event.skypeTeamsDataObj.mid).then(function(e){if(t.setState({associatedTranscripts:e||[]}),!t.state.selectedTranscript&&e&&e.length>0){var n=e[0];t.selectTranscript(n)}}).catch(function(e){t.setState({associatedTranscripts:[],error:e,showUnavailableDialog:!0})}))},e.prototype.getTranscriptEventType=function(t){return t===k.CallStarted||t===k.CallEnded?k.None:t},e.prototype.convertTranscriptEvent=function(t){return{type:this.getTranscriptEventType(t.eventType),key:t.eventId,timestamp:t.timestamp,text:"",showTimestampAndAvatar:!0,speakerId:t.userId,isOldMri:t.isOldMri}},e.prototype.convertTranscriptEntry=function(t){return{type:k.Text,key:t.entryId,timestamp:t.startTime,text:t.text,showTimestampAndAvatar:!0,speakerId:t.speakerId,isOldMri:t.isOldMri}},e.prototype.mergeTranscriptEntriesAndEvents=function(t){for(var e=t.data.entries,n=t.data.events,r=[],a=0,s=0;a<e.length&&s<n.length;)if(e[a].startTime>n[s].timestamp){var i=this.convertTranscriptEvent(n[s++]);i.type!==k.None&&r.push(i)}else r.push(this.convertTranscriptEntry(e[a++]));for(;s<n.length;){var o=this.convertTranscriptEvent(n[s++]);o.type!==k.None&&r.push(o)}for(;a<e.length;)r.push(this.convertTranscriptEntry(e[a++]));return r},e.prototype.getEventText=function(t,e){var n=this.props.localizationProvider,r="";switch(t.type){case k.TranscriptStarted:r=n.translate(_.Pb.TRANSCRIPT_STARTED,{name:e});break;case k.TranscriptEnded:r=n.translate(_.Pb.TRANSCRIPT_STOPPED,{name:e});break;case k.ParticipantJoined:r=n.translate(_.Pb.TRANSCRIPT_PARTICIPANT_JOINED,{name:e});break;case k.ParticipantLeft:r=n.translate(_.Pb.TRANSCRIPT_PARTICIPANT_LEFT,{name:e})}return r},e.prototype.resolveUser=function(t){var e=this;if(!t.speakerId)return Promise.resolve([]);var n=t.speakerId.split("@"),r=t.speakerId;return n.length>1&&(r=t.isOldMri?"8:orgid:"+n[1]+"_"+n[0]:"8:orgid:"+n[0]),t.speakerId=r,this.props.peopleProvider.getAllPeopleProfile([r]).then(function(n){return n&&n.length>0&&(t.email=Object(nt.a)(n[0].userPrincipalName||"")?n[0].userPrincipalName:n[0].email,t.speakerDisplayName=n[0].displayName,t.type!==k.Text&&(t.text=e.getEventText(t,t.speakerDisplayName||""))),n})},e.prototype.loadTranscript=function(t){var e=this;this.props.transcriptProvider.getTranscript(t).then(function(t){if(t&&t.data){var n=e.mergeTranscriptEntriesAndEvents(t),r=!1,a="-1",s="-1",i=n.length;n.forEach(function(t){t.type===k.Text&&t.speakerId&&(r=!0),t.timestamp=e.props.l10n.formatDateTime(t.timestamp,c.a.SHORT_TIME,!1),t.speakerId?s===t.speakerId?t.showTimestampAndAvatar=!1:s=t.speakerId:t.timestamp===a?t.showTimestampAndAvatar=!1:a=t.timestamp,e.resolveUser(t).then(function(){0==--i&&e.setState({loadedTranscript:n,showAvatars:r})}).catch(function(t){e.setState({error:t})})})}}).catch(function(t){e.setState({error:t,showUnavailableDialog:!0})})},e}(a.Component);n.d(e,"default",function(){return bt})},da7bfc878b0cf66154c2:function(t,e,n){var r=n("f179c3f94d6558690407");"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0};n("1e4534d1d62a11482e97")(r,a);r.locals&&(t.exports=r.locals)},f179c3f94d6558690407:function(t,e,n){(e=t.exports=n("c138e55a31f3f8960e99")(!1)).push([t.i,"/**\n * Common styles for all calendar components\n * TODO :  This is not an ideal placement for this file. This will go away when fela comes in.\n**/\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/*Font weight constants*/\n/* IF YOU CHANGE THESE PLEASE ALSO CHANGE IN models-calendar/src/constants*/\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/*Font weight constants*/\n/* IF YOU CHANGE THESE PLEASE ALSO CHANGE IN models-calendar/src/constants*/\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptPage--3n2QI {\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n  height: 100%; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  padding-left: 2.3rem;\n  border-bottom: 1px solid rgba(37, 36, 36, 0.15); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButtonIcon--26WR8 {\n  margin-bottom: 1.5rem;\n  margin-right: -0.5rem; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMainContainer--22koR {\n  display: flex;\n  flex: 1;\n  overflow: auto; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  width: 20rem;\n  padding: 1rem;\n  border-right: 1px solid rgba(37, 36, 36, 0.15); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptRendererContainer--1pEVP {\n  padding: 1rem;\n  overflow: auto;\n  margin-bottom: 6rem; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8 {\n  border: none;\n  box-shadow: none;\n  width: 100%;\n  background-color: transparent;\n  text-align: left; }\n  .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K {\n    background-color: #6264a7;\n    color: white; }\n  .ms-Fabric--isFocusVisible .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8:focus {\n    outline: 0.1rem solid rgba(37, 36, 36, 0.5); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTitle--4htik {\n  font-weight: bold;\n  padding: 1rem;\n  text-align: left;\n  font-size: 18px;\n  line-height: 24px;\n  letter-spacing: normal; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz,\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 19px;\n  text-align: left;\n  letter-spacing: normal; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz {\n  color: rgba(37, 36, 36, 0.65); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  margin-right: 1.5rem;\n  color: rgba(37, 36, 36, 0.75); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #252424; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptProfilePicture--2-QL1 {\n  width: 2.8rem;\n  height: 2.8rem;\n  margin-top: 0.3rem;\n  border-radius: 50%; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptIcon--1W6iw {\n  margin-top: -6px; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTextIcon--1h0km {\n  margin-top: -6px;\n  margin-left: -9px; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMain--1V7ty {\n  padding-bottom: 0;\n  padding-left: 0.5rem; }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  border-right-color: rgba(255, 255, 255, 0.15); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  border-bottom-color: rgba(255, 255, 255, 0.15); }\n\n.ms-Fabric--isFocusVisible .dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8:focus {\n  outline: 0.1rem solid rgba(255, 255, 255, 0.5); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz {\n  color: rgba(255, 255, 255, 0.5); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  color: rgba(255, 255, 255, 0.75); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz,\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK,\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  border-right-color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  border-bottom-color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU {\n  color: #ffff00; }\n  .contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU:hover {\n    color: #00ebff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K {\n  background-color: #00ebff;\n  color: #201f1f; }\n",""]),e.locals={transcriptPage:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptPage--3n2QI",transcriptQuickActionBar:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6",transcriptActionButtonIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButtonIcon--26WR8",transcriptMainContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMainContainer--22koR",transcriptSelectorContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ",transcriptRendererContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptRendererContainer--1pEVP",transcriptSelectorButton:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8",selected:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K",transcriptTitle:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTitle--4htik",transcriptTimestamp:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz",transcriptName:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK",transcriptText:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0",transcriptProfilePicture:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptProfilePicture--2-QL1",transcriptIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptIcon--1W6iw",transcriptTextIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTextIcon--1h0km",transcriptMain:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMain--1V7ty",transcriptActionButton:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU"}}}]);