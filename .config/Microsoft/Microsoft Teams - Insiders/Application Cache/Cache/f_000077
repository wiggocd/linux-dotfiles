webpackJsonp([19],{1981:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(1982)},1982:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){c.label=r[1];break}if(6===r[0]&&c.label<a[1]){c.label=a[1],a=r;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(r);break}a[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=r(1983),c=r(58),u=r(232),l=r(1984),f=r(1985),d=r(1986),p=r(1990),h=function(e){function t(t,r,n,i,o,a,s,c,u,l,f){var d=e.call(this,s)||this;return d.constants=t,d.utilityService=r,d.settingsService=n,d.authenticationService=i,d.localizationService=o,d.eventingService=a,d.loggingService=c,d.logger=u,d.actionCallbacks=l,d.dataCallbacks=f,d.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(d.getTheme(e))},d.initializeOnAppLaunchAndReinit("First Initialize"),d}return n(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,r){t.isLivePersonaCardInitialized&&t.changeTheme(r)})},t.prototype.initializeLPC=function(){return o(this,void 0,void 0,function(){var e,t,r,n,o,c,u,l,f,d,p,h,g;return a(this,function(a){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),r=this.localizationService.getLocale(),n=this.settingsService.getVersion().clientVersion,o=this.settingsService.isInternalRing(),c=this.authenticationService.getUserTypeInTenant(),u=c===teamspace.services.UserTypeInTenant.Guest,l=o&&!u?"df":"",f=this.getTeamsConfig(t,r,l),d=this.settingsService.getRing(),this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return p=d&&d.id?d.id:void 0,h=n,this.lpcPromise=s.initializeLivePersonaCardAsync(i({},f,{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,r){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+r)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:p,hostAppVersion:h,options:{hostAppRing:p,hostAppVersion:h}})),this.lpcPromise.then(function(){var r=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:r,clientCorrelationId:t,lpcRegion:l,userTypeInTenant:c})}).catch(function(r){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:l,userTypeInTenant:c}),r}),[2,this.lpcPromise]}catch(r){throw g="Could not load live persona card: "+r,e.fail({message:g,clientCorrelationId:t,lpcRegion:l,userTypeInTenant:c}),new Error(g)}return[2]})})},t.prototype.createLPC=function(e,t){var r=t.profile,n=t.behavior,o=t.ariaLabel,a=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex;{if(this.isLivePersonaCardInitialized){var l=u.determineLPCPersonaType(r.role,r.type),f=u.getCleanUpn(r.userPrincipalName),d={personaInfo:{identifiers:{PersonaType:l,AadObjectId:r.objectId,TeamsMri:r.mri,HostAppPersonaId:r.mri,Upn:f,Smtp:r.email},skypeId:r.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},n),ariaLabel:o,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:a,clientScenario:"MicrosoftTeams_MainWindow"};this.attachHoverTargetAsync(e,d);var p=function(){this.settingsService.valueAsBoolean(this.constants.settings.names.enableCstDeferralOptimization)?window.LPC.removedPersonaFromPage(e):window.requestAnimationFrame(function(){window.setTimeout(function(){window.LPC.removedPersonaFromPage(e)},250)})}.bind(this);return{destroy:function(){p()}}}this.logger.error("Not initialized")}},t.prototype.attachHoverTargetAsync=function(e,t){this.settingsService.valueAsBoolean(this.constants.settings.names.enableCstDeferralOptimization)?window.LPC.addedPersonaToPageV2(e,t):window.requestAnimationFrame(function(){window.setTimeout(function(){window.LPC.addedPersonaToPageV2(e,t)},250)})},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Default:return d.defaultTheme;case c.LpcTheme.Dark:return d.darkTheme;case c.LpcTheme.HighContrast:return d.highContrastTheme;default:return d.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,r){var n=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment);return{culture:t||window.navigator.language||"en-us",region:r,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:n,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1}}},t.prototype.getAuthToken=function(e){var t=this;return function(r,n){return o(t,void 0,void 0,function(){var t,i,o,s,c,u;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,o=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(o),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=a.sent())?r(c,e):n("Error retrieving auth token",e),[3,3];case 2:return u=a.sent(),this.logger.error("Error acquiring access token for LOKI"),n("Error retrieving auth token",e),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=h,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService",function(e,t,r,n,i,o,a,s,c,u,d,g,v,m,y,T,C,E,S,b,O,R,k,A,w,P){var _=o.newLogger("LivePersonaCardService"),I=new p.LpcTelemetryHelper(P,o),N=I.logPanelActionEvent.bind(I),L=l.LPCActionCallbackFactory(s,e,_,m,u,c,y,v,N),U=f.LPCDataCallbackFactory(_,u,T,m,n,C,E,i,e,S,b,O,R,k,d,A,t,r);return new h(e,n,i,a,d,g,w,o,_,L,U)}])},1983:function(e,t,r){!function(t,r){e.exports=r()}(window,function(){return function(e){function t(t){for(var r,n,o=t[0],a=t[1],s=0,u=[];s<o.length;s++)n=o[s],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(c&&c(t);u.length;)u.shift()()}function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}var n={},i={1:0};r.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise(function(t,r){n=i[e]=[t,r]});t.push(n[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+""+({0:"feed-bootstrapper",2:"topic-card-bootstrapper",3:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{0:"dd9395c0e97aceac9429",2:"5f52bc7f08ae459a614e",3:"f5c382323ada565beb69"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,r[1](c)}i[e]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://lpcres.delve.office.com/lpc/versionless/",r.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var c=a;return r(r.s=18)}([function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(e,t,r,n,i){this.name=e,this.message=t,this.rootCorrelationId=r,this.statusCode=n,this.numberOfRetries=i}},function(e,t,r){"use strict";var n;r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i}),function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"}(n||(n={}));var i=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var r=t.name.toLowerCase(),n=!1;-1!==r.indexOf("authtoken/loki")?(r="AuthRequestDuration",n=!0):-1!==r.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(r="AuthRequestDuration",n=!0):-1!==r.indexOf("/lpc/versionless/livepersonacard_")?(r="LpcBundleRequestDuration",n=!0):-1!==r.indexOf("/lpc/versionless/livepersonacardstrings")?(r="LpcStringsRequestDuration",n=!0):-1!==r.indexOf("/api/v1/configuration/")&&(r="InitConfigRequestDuration",n=!0),n&&(e.timings[r]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}()},function(e,t,r){"use strict";function n(e){var t=e.targetWindow||window,r=u.get(t);return r||(r={bootstrapperConfig:c(c({},e),{targetWindow:t}),ariaLogger:new s(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshInitializationTimeout:void 0}),u.set(t,r),r}function i(e){var t=u.get(e);if(t){var r=t.bootstrapperConfig.targetWindow;r&&(delete r.LPC,delete r.LivePersonaCardHoverTarget,delete r.LivePersonaCardHoverTargetV2,delete r.LivePersonaCardStrings,delete r.LivePersonaCardStringsLpcMini,delete r.OfficeFeed,delete r.OfficeFeedFull,delete r.OfficeFeedStrings,delete r.MeetingInsightsV2,delete r.MidgardBootstrapper,delete r.PersonaInsightRing),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}u.delete(e)}r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var o=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},a=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return r.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return r.sent().flush(this.noOp),[3,4];case 3:return r.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return o(this,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(r=n.sent()).setContext("LokiUrl",e.LokiUrl),r.setContext("tenantAadObjectId",e.TenantAadObjectId),r.setContext("userAadObjectId",e.UserAadObjectId),r.setContext("userPuid",e.UserPuid),[3,3];case 2:throw n.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return o(this,void 0,void 0,function(){var t,r,n;return a(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,this.getLogManagerAsync()];case 1:return r=i.sent(),[4,this.getCollectorUrlAsync()];case 2:n=i.sent(),(t=r.initialize(e,{collectorUri:n}))||(t=r.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20200617.22.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,r.e(3).then(r.t.bind(null,49,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlAsync=function(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return[4,r.e(3).then(r.t.bind(null,49,7))];case 1:switch(e=t.sent(),this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,e.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,e.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,e.AWT_COLLECTOR_URL_USGOV_DOD];case"Gallatin":throw new Error("Gallatin not supported by Aria");case"GccModerate":case"Prod":default:return[2,void 0]}return[2]}})})},e.prototype.noOp=function(){},e}(),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=new Map},,function(e,t,r){"use strict";function n(e,t,r){try{r.sessionStorage&&r.sessionStorage.setItem&&r.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,r){return new Promise(function(i,s){e?(n(a,e,r),i(e)):t(function(e,t){e?(n(a,e,r),i(e)):s(new o.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){var r=function(e){return/^AADSTS\d+?:/.test(e)}(e)?e:"";s(new o.a("GetAuthTokenError",r,t))})})}r.d(t,"a",function(){return i});var o=r(0),a="LokiAuthToken"},,function(e,t,r){"use strict";function n(e){var t={};return Object.keys(e).forEach(function(r){t["Perf_"+r]=e[r].toString()}),t}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=3e5},function(e,t,r){"use strict";function n(e,t){var r=this,n=0,o=function(e,t){return a(r,void 0,void 0,function(){var r;return s(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,6]),[4,i(e,t)];case 1:return a.sent(),[3,6];case 2:return r=a.sent(),n<c?(n++,[4,o(e,t)]):[3,4];case 3:return a.sent(),[3,5];case 4:throw r.numberOfRetries=n,r;case 5:return[3,6];case 6:return[2]}})})};return o(e,t)}function i(e,t){return new Promise(function(r,n){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){r()}),i.addEventListener("error",function(){n(new o.a("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}r.d(t,"a",function(){return n});var o=r(0),a=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},s=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},c=2},function(e,t,r){"use strict";function n(e){switch(e.complianceEnvironment){case"Blackforest":return o;case"GccHigh":return a;case"DoD":return s;case"Gallatin":return c;case"GccModerate":case"Prod":default:return i}}r.d(t,"a",function(){return n});var i="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",o="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",a="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",s="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",c=""},function(e,t,r){"use strict";function n(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e){return{family:w,code:e}}function i(e,t){if(null==e)return e;for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];t(e[o])&&(r[o]=e[o])}return r}function o(e,t){return Object.assign({},e,t)}function a(e,t){return e.hasOwnProperty(t)}function s(e){return"object"==typeof e&&!!e&&a(e,"family")&&a(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}function c(e,t,r){var n=P.get(r)||new Map;n.set(e,t),P.set(r,n)}function u(e,t){var r=P.get(t);return r?r.get(e):void 0}function l(e,t,r){c(e,t,r),function(e,t){if(window.sessionStorage)try{window.sessionStorage.setItem(e,t)}catch(e){}}(e,t)}function f(e,t){var r=function(e){if(window.sessionStorage)try{var t=window.sessionStorage.getItem(e);return null===t?void 0:t}catch(e){}}(e);return void 0!==r?r:u(e,t)}function d(e,t){!function(e,t){var r=P.get(t);r&&r.delete(e)}(e,t),function(e){if(window.sessionStorage)try{window.sessionStorage.removeItem(e)}catch(e){}}(e)}function p(e){return e.family===N&&e.code in _?e.code:void 0}function h(e){return{family:N,code:e}}function g(e){return Boolean(e&&("string"==typeof e||Object.keys((t=e,i(t,function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)}))).length));var t}function v(e){return!!(s(e)&&p(e)&&q[e.code])}function m(e){return!!(s(e)&&p(e)&&(v(e)||j[e.code]||G[e.code]))}function y(e){switch(e){case"Blackforest":return B;case"GccModerate":return K;case"GccHigh":return V;case"DoD":return z;case"Gallatin":return Q;case"Prod":return X;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}function T(e){return{family:ne,code:e}}function C(e){return null===e?null:void 0!==e?"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:Array.isArray(e)?e.map(C):Object.keys(e).reduce(function(t,r){var n=""+r[0].toUpperCase()+r.slice(1);return"object"==typeof e[r]?t[n]=C(e[r]):t[n]=e[r],t},{}):void 0}function E(e){return Boolean(e&&e.qosTagId&&["get_configuration","get_livepersonacardconfiguration","get_livepersonapickerconfiguration","get_officefeedconfiguration","get_searchconfiguration","get_groupsmanagementconfiguration"].indexOf(e.qosTagId)>-1)}function S(e,t){return"ppe"===e||"df"===e||"msit"===e?"https://{0}.loki.delve.office.com".replace("{0}",e):y(t)}function b(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),n=t.decodeURIComponent||window.decodeURIComponent;return null===r?"":n&&n(r[1].replace(/\+/g," "))||""}function O(e,t,r){return k(function(e,t){var r=t||e.culture,n=S(e.region,e.complianceEnvironment);return ue.replace("{0}",n).replace("{1}",r)}(t,b(ve,r)),e,pe(pe({},t),{clientFeature:"LivePersonaCard"}),r)}function R(e,t,r){return k(function(e,t){var r=t||e.culture,n=S(e.region,e.complianceEnvironment);return le.replace("{0}",n).replace("{1}",r)}(t,b(ve,r)),e,pe(pe({},t),{clientFeature:"OfficeFeed"}),r)}function k(e,t,r,n){return new Promise(function(i,o){var a=new XMLHttpRequest;a.open("GET",e,!0),a.setRequestHeader("authToken",t),a.setRequestHeader("Accept","application/json");var s=de.replace(/[xy]/g,function(e){var t;if(window.crypto){var r=new Uint8Array(1);window.crypto.getRandomValues(r),t=r[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});a.setRequestHeader("X-RootCorrelationId",s),a.setRequestHeader("X-CorrelationId",s),a.setRequestHeader("X-ClientCorrelationId",r.clientCorrelationId),a.setRequestHeader("X-ClientType",r.clientType),a.setRequestHeader("X-ClientFeature",r.clientFeature),r.hostAppRing&&a.setRequestHeader("X-HostAppRing",r.hostAppRing),r.hostAppVersion&&a.setRequestHeader("X-HostAppVersion",r.hostAppVersion),n&&n.React&&n.React.version&&n.ReactDOM&&a.setRequestHeader("X-HostAppReactVersion",n.React.version);var c=b(me,n)||b(ge,n);c&&(a.setRequestHeader(ge,c),a.setRequestHeader(me,c));var u=b(ye,n);u&&a.setRequestHeader(ye,u),a.addEventListener("load",function(){if(200===a.status)try{var e=JSON.parse(a.response);e.RootCorrelationId=s,e.LokiVersion=a.getResponseHeader("x-serverversion")||"",i(e)}catch(e){o(new fe.a("GetLokiConfigError","Failed to parse initialization config.",s))}else o(new fe.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+a.status,s,a.status))}),a.addEventListener("error",function(){o(new fe.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",s))}),a.addEventListener("timeout",function(){o(new fe.a("GetLokiConfigError","Loki config request timed out after "+he+" ms.",s))}),a.timeout=he,a.send()})}r.d(t,"a",function(){return O}),r.d(t,"b",function(){return R});var A,w="caching-request";!function(e){e[e.CACHE_MISS=0]="CACHE_MISS",e[e.EXPIRED=1]="EXPIRED",e[e.VERSION_MISMATCH=2]="VERSION_MISMATCH",e[e.UNKNOWN_ERROR=3]="UNKNOWN_ERROR"}(A||(A={}));var P=new Map;n(A.CACHE_MISS),n(A.UNKNOWN_ERROR),n(A.VERSION_MISMATCH),n(A.EXPIRED),new Map,"undefined"!=typeof window&&window.performance;var _,I=function(){function e(e,t){this.rateLimit=e,this.slidingWindowDuration=t,this.currentRate=0,this.throttledRetryAfter=new Map}return e.prototype.updateRateLimit=function(){var e,t,r=this;this.currentRate++,e=function(){return r.currentRate=Math.max(r.currentRate-1,0)},t=this.slidingWindowDuration,window.setTimeout(function(){return e()},t)},e.prototype.execute=function(e){if(this.currentRate>=this.rateLimit)throw new Error("Rate limit reached");this.updateRateLimit(),e()},e.prototype.executeWithThrottling=function(e,t){var r,n=this,i=this.currentRate>=this.rateLimit;if(!i&&t&&(i=(r=this.throttledRetryAfter.get(t))&&r>Date.now()||!1),i)throw new Error("Rate limit reached");return this.updateRateLimit(),t?new Promise(function(i,o){e().then(function(e){void 0!==r&&t&&n.throttledRetryAfter.delete(t),i(e)}).catch(function(e){var r;if(429===e.statusCode&&(null===(r=e.headers)||void 0===r?void 0:r["Retry-After"])){var i=Number(e.headers["Retry-After"]);if(NaN!==i&&i>0){var a=Date.now()+1e3*i;n.throttledRetryAfter.set(t,a)}}o(e)})}):e()},e}(),N="loki-auth-token";!function(e){e[e.AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE=0]="AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE",e[e.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS=1]="AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS",e[e.EXPECTED_ERROR=2]="EXPECTED_ERROR",e[e.EXPECTED_TOKEN_INVALIDATED_ERROR=3]="EXPECTED_TOKEN_INVALIDATED_ERROR",e[e.GET_AUTH_TOKEN_TIMEOUT=4]="GET_AUTH_TOKEN_TIMEOUT",e[e.INVALID_AUTH_TOKEN=5]="INVALID_AUTH_TOKEN",e[e.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED=6]="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED",e[e.DEVICE_CONNECTION_IS_NOT_AVAILABLE=7]="DEVICE_CONNECTION_IS_NOT_AVAILABLE",e[e.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN=8]="BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN",e[e.TIMEOUT_FETCHING_TOKEN=9]="TIMEOUT_FETCHING_TOKEN",e[e.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED=10]="AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED",e[e.AD_ERROR_SERVER_USER_INPUT_NEEDED=11]="AD_ERROR_SERVER_USER_INPUT_NEEDED",e[e.kCFURLErrorTimedOut=12]="kCFURLErrorTimedOut",e[e.kCFURLErrorCannotFindHost=13]="kCFURLErrorCannotFindHost",e[e.kCFURLErrorCannotConnectToHost=14]="kCFURLErrorCannotConnectToHost",e[e.kCFURLErrorNetworkConnectionLost=15]="kCFURLErrorNetworkConnectionLost",e[e.kCFURLErrorNotConnectedToInternet=16]="kCFURLErrorNotConnectedToInternet",e[e.kCFURLErrorInternationalRoamingOff=17]="kCFURLErrorInternationalRoamingOff",e[e.kCFURLErrorCallIsActive=18]="kCFURLErrorCallIsActive",e[e.kCFURLErrorDataNotAllowed=19]="kCFURLErrorDataNotAllowed",e[e.kCFURLErrorSecureConnectionFailed=20]="kCFURLErrorSecureConnectionFailed",e[e.UNKNOWN_ERROR=21]="UNKNOWN_ERROR",e[e.UNKNOWN_200_ERROR=22]="UNKNOWN_200_ERROR",e[e.UNKNOWN_203_ERROR=23]="UNKNOWN_203_ERROR",e[e.UNKNOWN_STRING_ERROR=24]="UNKNOWN_STRING_ERROR",e[e.UNKNOWN_ERROR_CAUGHT_IN_PROMISE=25]="UNKNOWN_ERROR_CAUGHT_IN_PROMISE",e[e.BROKER_AUTHENTICATOR_NOT_RESPONDING=26]="BROKER_AUTHENTICATOR_NOT_RESPONDING",e[e.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION=27]="NO_NETWORK_CONNECTION_POWER_OPTIMIZATION",e[e.BROKER_AUTHENTICATOR_IO_EXCEPTION=28]="BROKER_AUTHENTICATOR_IO_EXCEPTION",e[e.IO_EXCEPTION=29]="IO_EXCEPTION",e[e.NO_ACCOUNTS_FOUND=30]="NO_ACCOUNTS_FOUND",e[e.DISALLOWED_MSA_ACCOUNT=31]="DISALLOWED_MSA_ACCOUNT",e[e.NO_M365_ACCOUNT=32]="NO_M365_ACCOUNT"}(_||(_={}));var L,U,D,x,F=function(){return(F=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},M=10,H=3e5,W="LokiAuthToken",q=((L={})[_.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED]=1,L[_.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS]=1,L[_.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED]=1,L[_.AD_ERROR_SERVER_USER_INPUT_NEEDED]=1,L),j=((U={})[_.DEVICE_CONNECTION_IS_NOT_AVAILABLE]=1,U[_.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN]=1,U[_.TIMEOUT_FETCHING_TOKEN]=1,U[_.BROKER_AUTHENTICATOR_NOT_RESPONDING]=1,U[_.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION]=1,U[_.BROKER_AUTHENTICATOR_IO_EXCEPTION]=1,U[_.kCFURLErrorTimedOut]=1,U[_.kCFURLErrorCannotFindHost]=1,U[_.kCFURLErrorCannotConnectToHost]=1,U[_.kCFURLErrorNetworkConnectionLost]=1,U[_.kCFURLErrorNotConnectedToInternet]=1,U[_.kCFURLErrorInternationalRoamingOff]=1,U[_.kCFURLErrorCallIsActive]=1,U[_.kCFURLErrorDataNotAllowed]=1,U[_.kCFURLErrorSecureConnectionFailed]=1,U),G=((D={})[_.EXPECTED_ERROR]=1,D[_.EXPECTED_TOKEN_INVALIDATED_ERROR]=1,D[_.GET_AUTH_TOKEN_TIMEOUT]=1,D),X="https://loki.delve.office.com",B="https://loki.delve.office.de",K="https://gcc.loki.delve.office.com",V="https://gcchigh.loki.office365.us",z="https://dod.loki.office365.us",Q="https://loki.office365.cn",J=Number.MAX_SAFE_INTEGER,Z=function(){function e(e,t,r,n){this.value=e,this.featureName=t,this.logger=r,this.expirationTimeEpoch=n||J}return e.prototype.isApproachingExpiration=function(){return!!this.isValid()&&Date.now()>this.expirationTimeEpoch-24e4},e.prototype.isValid=function(){return!(!this.value||(this.expirationTimeEpoch<=0?(this.logger&&this.logger.logError({eventId:"InvalidTokenExpirationValue",featureName:this.featureName,properties:{expiryTime:this.expirationTimeEpoch.toString()}}),1):Date.now()>this.expirationTimeEpoch-12e4))},e.prototype.getValue=function(){return this.value},e.prototype.getLoggableProps=function(){return{expirationTime:this.expirationTimeEpoch,expiresIn:this.expirationTimeEpoch-Date.now(),notBefore:0,localClockOffset:0}},e.prototype.getExpirationTimeEpoch=function(){return this.expirationTimeEpoch},e}(),Y=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n},$=function(){return($=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ee=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},te=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},re=(function(){function e(e){this.authTokenProviderState="Initial";var t=e.getAppId,r=e.refreshAuthToken,n=e.logger,i=e.runWithLogMonitor,o=e.authTokenType,a=e.featureName,s=e.rateLimiter,c=void 0===s?new I(M,H):s;n&&n.registerErrors(N,_),this.getAppId=t,this.refreshAuthToken=r,this.logger=n,this.runWithLogMonitor=i,this.authTokenType=o||Z,this.featureName=a||"RESTAuthToken",this.rateLimiter=c;var u,l=(u=this.getAppId(),f(W,u||"")||"");l&&(this.authToken=new this.authTokenType(l,this.featureName,this.logger,void 0)),this.getAuthToken(void 0).catch(function(e){})}e.prototype.getAuthToken=function(e){return ee(this,void 0,void 0,function(){var t;return te(this,function(r){switch(r.label){case 0:if(t=this.checkAndGetAuthTokenIfValid())return[2,{token:t,request:{fromCache:!0,duration:0}}];if("DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:h(_.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return[4,this.getAuthTokenPromise({relatedRootCorrelationId:e,isForced:!1})];case 1:return[2,r.sent()]}})})},e.prototype.invalidateAuthToken=function(){var e;this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=void 0,e=this.getAppId(),d(W,e||"")},e.prototype.isTokenInvalidated=function(e){return e!==this.authPromise},e.prototype.forceRefreshAuthToken=function(e){return ee(this,void 0,void 0,function(){var t;return te(this,function(r){switch(r.label){case 0:if("DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:h(_.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};r.label=1;case 1:return r.trys.push([1,4,,5]),"RequestPending"===this.authTokenProviderState?[3,3]:(t=this.authToken&&o(this.authToken,{}),this.authToken=void 0,[4,this.getAuthTokenPromise({relatedRootCorrelationId:e,isForced:!0,existingToken:t})]);case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return r.sent(),[3,5];case 5:return[2]}})})},e.prototype.updateAuthTokenTtl=function(e){this.authToken&&(this.authToken=new this.authTokenType(this.authToken.getValue(),this.featureName,this.logger,Date.now()+1e3*e))},e.prototype.checkAndGetAuthTokenIfValid=function(){var e=this.authToken;if(e&&e.isValid())return e.isApproachingExpiration()&&this.getAuthTokenPromise({relatedRootCorrelationId:void 0,isForced:!1}).catch(function(){}),e},e.prototype.requestNewAuthToken=function(e,t){var r=this;return new Promise(function(n,i){var o=!1,a=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,Y([e,t],r))}(function(){o=!0,i({midgardError:h(_.GET_AUTH_TOKEN_TIMEOUT)})},3e4);e(function(e,s,c,u){var l,f=g(s);if(!o||!f){clearTimeout(a);var d=function(e,t){var r=void 0;return t&&(r={authRequestCorrelationId:t}),e&&"object"==typeof e&&(r=F(F(F(F({},r),e.statusCode&&{statusCode:e.statusCode}||{}),e.errorCode&&{errorCode:e.errorCode}||{}),e.protocolCode&&{protocolCode:e.protocolCode}||{})),r}(s,c);if(f&&s){var p=function(e){if("string"==typeof e)return h(e.indexOf("AuthTokenInternetConnectionNotAvailable")>=0?_.DEVICE_CONNECTION_IS_NOT_AVAILABLE:e.indexOf("AuthTokenDisabledConditionalAccess")>=0?_.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS:"AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED"===e?_.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED:_.UNKNOWN_STRING_ERROR);switch(e.errorCode){case"203":return h("interaction_required"===e.protocolCode&&"200"===e.statusCode?_.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED:_.UNKNOWN_203_ERROR);case"200":return h("200"===e.statusCode?_.AD_ERROR_SERVER_USER_INPUT_NEEDED:_.UNKNOWN_200_ERROR);case"DEVICE_CONNECTION_IS_NOT_AVAILABLE":return h(_.DEVICE_CONNECTION_IS_NOT_AVAILABLE);case"BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN":return h(_.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN);case"BROKER_AUTHENTICATOR_NOT_RESPONDING":return h(_.BROKER_AUTHENTICATOR_NOT_RESPONDING);case"AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED":return h(_.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED);case"NO_NETWORK_CONNECTION_POWER_OPTIMIZATION":return h(_.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION);case"BROKER_AUTHENTICATOR_IO_EXCEPTION":return h(_.BROKER_AUTHENTICATOR_IO_EXCEPTION);case"IO_EXCEPTION":return h(_.IO_EXCEPTION);case"Timeout: getting the token timed out":return h(_.TIMEOUT_FETCHING_TOKEN);case"NO_ACCOUNTS_FOUND":return h(_.NO_ACCOUNTS_FOUND);case"DISALLOWED_MSA_ACCOUNT":return h(_.DISALLOWED_MSA_ACCOUNT);case"NO_M365_ACCOUNT":return h(_.NO_M365_ACCOUNT);case"-1001":return h(_.kCFURLErrorTimedOut);case"-1003":return h(_.kCFURLErrorCannotFindHost);case"-1004":return h(_.kCFURLErrorCannotConnectToHost);case"-1005":return h(_.kCFURLErrorNetworkConnectionLost);case"-1009":return h(_.kCFURLErrorNotConnectedToInternet);case"-1018":return h(_.kCFURLErrorInternationalRoamingOff);case"-1019":return h(_.kCFURLErrorCallIsActive);case"-1020":return h(_.kCFURLErrorDataNotAllowed);case"-1200":return h(_.kCFURLErrorSecureConnectionFailed);default:var t=parseInt(e.errorCode||"",10);return!isNaN(t)&&{family:N,code:1e4+t}||h(_.UNKNOWN_ERROR)}}(s);i(v(p)?{midgardError:p,extraLogProps:$($({},d),{authTokenDisabledForThisSession:"true"})}:{midgardError:p,extraLogProps:d})}else if(e){var m=u&&Date.now()+1e3*u;t&&(null===(l=t.getValue)||void 0===l?void 0:l.call(t))===e&&void 0===m&&(m=t.getExpirationTimeEpoch());var y=new r.authTokenType(e,r.featureName,r.logger,m);n(y)}else i({midgardError:h(_.EXPECTED_ERROR),extraLogProps:d})}})})},e.prototype.getAuthTokenPromise=function(e){return ee(this,void 0,void 0,function(){var t,r,n,i,c,u,l,f=this;return te(this,function(d){switch(d.label){case 0:if(t=e.existingToken,r=e.isForced,n=e.relatedRootCorrelationId,"DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:h(_.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return i=(new Date).valueOf(),this.authPromise&&"RequestPending"===this.authTokenProviderState||(this.authTokenProviderState="RequestPending",c=new Promise(function(e,i){try{f.rateLimiter.execute(function(){var o;if(f.runWithLogMonitor){var a=void 0;n&&((o={}).relatedRootCorrelationId=n,o.isForced=r.toString(),a=o),f.runWithLogMonitor({scenarioName:"LokiGetAuthToken",featureName:f.featureName,operation:function(){return f.requestNewAuthToken(f.refreshAuthToken,t)},extraLogPropsOnFinish:{success:function(){return{}},failure:function(e){return e.extraLogProps||{}}},successAction:function(t){f.isTokenInvalidated(c)&&i({midgardError:h(_.EXPECTED_TOKEN_INVALIDATED_ERROR)}),t?e({token:t,request:{fromCache:!1,duration:0}}):i({midgardError:h(_.INVALID_AUTH_TOKEN)})},errorAction:function(e){return i(e)},treatAsExpectedError:function(e){return m(e.midgardError)||!!navigator&&!1===navigator.onLine},extraProps:a})}else f.requestNewAuthToken(f.refreshAuthToken,t).then(function(t){f.isTokenInvalidated(c)&&i({midgardError:h(_.EXPECTED_TOKEN_INVALIDATED_ERROR)}),e({token:t,request:{fromCache:!1,duration:0}})}).catch(function(e){return i(e)})})}catch(e){i(e)}}).then(function(e){return f.onRefreshAuthTokenSuccess(e),e}).catch(function(e){throw f.onRefreshAuthTokenError("object"==typeof e&&e&&a(e,"midgardError")&&s(e.midgardError)?e.midgardError:h(_.UNKNOWN_ERROR_CAUGHT_IN_PROMISE)),e}),this.authPromise=c),[4,this.authPromise];case 1:return u=d.sent(),l=Date.now(),[2,o(u,{request:o(u.request,{duration:l-i})})]}})})},e.prototype.onRefreshAuthTokenSuccess=function(e){var t,r;this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=e.token,t=this.getAppId(),(r=e.token.getValue()||"")&&l(W,r,t||"")},e.prototype.onRefreshAuthTokenError=function(e){var t;this.authTokenProviderState=v(e)?"DisabledConditionalAccess":"Initial",this.authPromise=void 0,null===(t=this.logger)||void 0===t||t.logError({eventId:"LokiGetAuthTokenFailed",featureName:this.featureName,properties:{midgardError:e,authTokenDisabled:"DisabledConditionalAccess"===this.authTokenProviderState}})}}(),r(15)),ne="loki-rest-utils";!function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.INVALID_RESPONSE=1]="INVALID_RESPONSE",e[e.REQUEST_FAILED=2]="REQUEST_FAILED",e[e.CONFIG_FAILED=3]="CONFIG_FAILED",e[e.AUTH_TOKEN_FAILED=4]="AUTH_TOKEN_FAILED",e[e.GCC_USER=5]="GCC_USER",e[e.REQUEST_FACTORY_UNDEFINED=6]="REQUEST_FACTORY_UNDEFINED",e[e.MISSING_REQUIRED_PARAMETER=7]="MISSING_REQUIRED_PARAMETER"}(x||(x={}));var ie=function(){return(ie=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},oe=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},ae=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};!function(){function e(e,t,r){this.config=e,this.getDomain=t,this.ignoreWebSockets=r,this.initialize(),this.config.logger.registerErrors(ne,x)}e.prototype.initialize=function(){return oe(this,void 0,void 0,function(){var e=this;return ae(this,function(t){return this.requestFactory?[2]:[2,this.getDomainOrLogErrorAndThrow("").then(function(t){var r=t.domain.replace("https://","wss://").replace("http://localhost:44342","ws://localhost:44342/").replace(/loki\.delve\.office\.([A-Za-z]+)/,"loki.delve.office.$1/stikkontakt.ws").replace("localhost:44342/","localhost:44342/stikkontakt.ws"),n=!e.config.settings.isGetPostConversionDisabled;e.requestFactory=new re.StikkontaktRequestFactory(function(t,r){return e.config.logger.logTrace({eventId:t,featureName:"Stikkontakt",properties:r})},function(t,r){return e.config.logger.logError({eventId:t,featureName:"StikkontaktError",properties:r})},e.config.settings.isStikkontaktEnabled&&!e.ignoreWebSockets&&!0,n,r,e.config.settings.isStikkontaktDebugEnabled,e.config.hostAppConfiguration.source)}).catch(function(){e.config.logger.logError({eventId:"DomainOrAuthTokenFailure",featureName:"LokiRestProvider"})})]})})},e.prototype.request=function(e,t,r,n,i,o,a,c,u){return void 0===u&&(u={convertPropertiesToPascalCase:!0,defaultResponseObject:!0}),oe(this,void 0,void 0,function(){var l,f,d,p,h,g,v,m,y,E,S=this;return ae(this,function(b){switch(b.label){case 0:return this.config.settings.isOfflineMode?[2,Promise.reject({message:"OFFLINE_MODE",isExpected:!0})]:[4,this.getDomainOrLogErrorAndThrow(e)];case 1:l=b.sent(),f=a.requestId,d=a.ignoreWebSockets,p=a.timeoutOverride,h=a.clientScenario,g=function(){return oe(S,void 0,void 0,function(){var e,a,s,g,v;return ae(this,function(m){switch(m.label){case 0:return[4,this.doRequest({method:t,domain:l.domain,path:r,body:n,headers:i,queryParameters:o,requestId:f,ignoreWebSockets:d,timeoutOverride:p,clientScenario:h,domainRequiredRequest:l.domainRequiredRequest})];case 1:return e=m.sent(),a=e.Headers?Number(e.Headers["x-tokenttl"]):NaN,!isNaN(a)&&this.config.updateAuthTokenTtl(a),s=""===e.Body||"null"===e.Body.toLowerCase(),e.Body=s&&u.defaultResponseObject?"{}":e.Body,g=u.convertPropertiesToPascalCase?C:function(e){return e},v=c(!s||u.defaultResponseObject?g(JSON.parse(e.Body)):e.Body),[2,ie({parsedResponse:v},e)]}})})},b.label=2;case 2:return b.trys.push([2,4,,11]),[4,g()];case 3:return[2,b.sent()];case 4:if(v=b.sent(),!(m=v)||401!==m.statusCode)return[3,9];this.config.forceRefreshAuthToken(a.requestId),b.label=5;case 5:return b.trys.push([5,7,,8]),[4,g()];case 6:return[2,b.sent()];case 7:throw y=b.sent(),ce({qosTagId:e,statusCode:null==(E=y)?void 0:E.statusCode,isExpected:(null==E?void 0:E.isExpected)||!1,headers:null==E?void 0:E.headers,midgardError:E&&s(E.midgardError)?E.midgardError:T(x.REQUEST_FAILED)});case 8:return[3,10];case 9:throw se({qosTagId:e,statusCode:null==m?void 0:m.statusCode,isExpected:(null==m?void 0:m.isExpected)||!1,headers:null==m?void 0:m.headers,midgardError:m&&s(m.midgardError)?m.midgardError:T(x.REQUEST_FAILED)});case 10:return[3,11];case 11:return[2]}})})},e.prototype.configuration=function(){return this.config},e.prototype.getDomainOrLogErrorAndThrow=function(e){return oe(this,void 0,void 0,function(){var t,r,n,i,o,a;return ae(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.getDomain()];case 1:return[2,c.sent()];case 2:throw t=c.sent(),n=(r=t)&&function(e){return 403===e.statusCode&&E(e)}(r),i=E(r),o=i?x.CONFIG_FAILED:n?x.GCC_USER:x.UNKNOWN_ERROR,a=void 0,a=i?T(o):r&&s(r.midgardError)?r.midgardError:T(o),o===x.UNKNOWN_ERROR&&this.config.logger.logError({eventId:"GetDomainFailure",featureName:"LokiRestProvider"}),se({qosTagId:e,statusCode:null==r?void 0:r.statusCode,isExpected:i,headers:void 0,midgardError:a});case 3:return[2]}})})},e.prototype.doRequest=function(e){var t=e.method,r=e.domain,n=e.path,i=e.body,o=e.headers,a=e.queryParameters,c=e.requestId,u=e.ignoreWebSockets,l=e.timeoutOverride,f=e.clientScenario,d=e.domainRequiredRequest;return oe(this,void 0,void 0,function(){var e,p,h,g,v,y,C,E,S,b,O,R;return ae(this,function(k){switch(k.label){case 0:return k.trys.push([0,2,,3]),[4,this.config.getAuthToken(c)];case 1:return p=k.sent(),e=p.token.getValue(),[3,3];case 2:throw h=k.sent(),se({qosTagId:"getAuthTokenPromise",statusCode:void 0,isExpected:!(!(g=h)||!s(g.midgardError))&&m(g.midgardError),headers:void 0,midgardError:g&&s(g.midgardError)?g.midgardError:T(x.AUTH_TOKEN_FAILED)});case 3:return A=this.config,v={isLinkedInEnabledInHostApp:A.hostAppConfiguration.options.isLinkedInEnabledInHostApp},this.config.settings.isGetPostConversionDisabled?(o["X-RootCorrelationId"]=c,o["X-CorrelationId"]=c,o["X-ClientCorrelationId"]=this.config.hostAppConfiguration.consumerCorrelationId):(a.RootCorrelationId=c,a.CorrelationId=c,a.ClientCorrelationId=this.config.hostAppConfiguration.consumerCorrelationId),o["X-ClientType"]=this.config.hostAppConfiguration.source,o["X-ClientFeature"]=this.config.clientFeature,o["X-ClientScenario"]=f,o["X-LPCVersion"]=this.config.BUILD_VERSION,o.authorization="Bearer "+e,y=this.config.hostAppConfiguration.options,C=y.hostAppRing,E=y.hostAppVersion,S=y.sharedMailboxAadObjectId,C&&(o["X-HostAppRing"]=C),E&&(o["X-HostAppVersion"]=E),this.config.settings.isSharedMailboxEnabled&&S&&(o["X-MailboxContextAadObjectId"]=S),o["X-HostAppCapabilities"]=JSON.stringify(v),i&&(i=JSON.stringify(i)),[4,this.initialize()];case 4:if(k.sent(),!this.requestFactory)throw se({qosTagId:"noRequestFactory",statusCode:void 0,isExpected:!1,headers:void 0,midgardError:T(x.REQUEST_FACTORY_UNDEFINED)});return b=function(e,t){var r=Object.keys(t);return r.length<=0?e:e+"?"+r.filter(function(e){return void 0!==t[e]&&null!==t[e]}).map(function(e){return Array.isArray(t[e])?t[e].map(function(t){return e+"="+t}).join("&"):e+"="+encodeURIComponent(t[e])}).join("&")}(b="/"===r.substring(r.length-1)&&"/"===n.substring(0,1)?""+r+n.substring(1):""+r+n,a),O=this.requestFactory.getRequestExecutor(b,t,i,u,l),Object.keys(o).forEach(function(e){O.setHeader(e,o[e]||"")}),"object"==typeof i&&"Buffer"!==i.constructor.name&&O.setHeader("Content-Type","application/json"),[4,O.go()];case 5:return R=k.sent(),[2,ie({additionalRequestInformation:{didMakeAuthTokenRequest:!p.request.fromCache,durationWaitingOnAuthToken:p.request.duration,didMakeConfigRequest:Boolean(d)}},R)]}var A})})}}();var se=function(e){return e},ce=function(e){return ie(ie({},e),{retryAttemptedAfterAuthFailure:!0})};new I(20,1e4);var ue="{0}/api/v1/livepersonacard/configuration?cultureName={1}",le="{0}/api/v1/officefeed/configuration?cultureName={1}&returnResources=true",fe=r(0),de="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",pe=function(){return(pe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},he=6e4,ge="LivePersonaCardVersionOverride",ve="LivePersonaCardCultureOverride",me="MidgardVersion",ye="MidgardBranch"},function(e,t,r){"use strict";function n(e){return void 0===e||"string"!=typeof e||""===e||null===e}function i(e){return void 0===e||"function"!=typeof e}function o(e){var t="";if(e){var r=[];n(e.culture)&&r.push("culture"),n(e.clientType)&&r.push("clientType"),n(e.clientContextType)&&r.push("clientContextType"),n(e.clientCorrelationId)&&r.push("clientCorrelationId"),i(e.logMessage)&&r.push("logMessage"),i(e.getAuthToken)&&r.push("getAuthToken"),r.length>0&&(t="Invalid required parameter(s): "+r.join(", ")+". Check the values and types you're passing. "),e.region&&-1===s.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+s.join(", ")+" for pre-production environments. "),-1===c.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+c.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new a.a("ValidateBootstrapperConfigError",t)}r.d(t,"a",function(){return o});var a=r(0),s=["msit","df","ppe"],c=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin"]},function(e,t){},function(e,t,r){"use strict";function n(e,t){if(e&&t&&0!==t)return Math.ceil(t-e)}function i(){try{if("function"==typeof CustomEvent)return new CustomEvent("Event").timeStamp;if("undefined"!=typeof document)return document.createEvent("Event").timeStamp}catch(e){}}function o(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_"+t,statusCode:e.status,responseText:e.responseText,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:a(e.getAllResponseHeaders())}}function a(e){if(e){var t={};return e.split("\r\n").forEach(function(e){var r=e.indexOf(": ");t[e.substr(0,r).toLowerCase()]=e.substr(r+2)}),t}return{}}function s(e){var t={};return Object.keys(e).forEach(function(r){t[r.toLowerCase()]=e[r]}),t}function c(e){return new WebSocket(e)}r.d(t,"a",function(){return O});var u=Promise.resolve({inflateRaw:function(e,t){return"object"==typeof t?"":new Uint8Array(0)},deflateRaw:function(e,t){return"object"==typeof t?"":new Uint8Array(0)}}),l=function(){return u},f=/\?/,d="ConvertGetPost",p=function(){function e(e,t,r,n,i,o){if(this.url=e,this.verb=t,this.timeout=r,this.body=i,this.withCredentials=o,this.isConvertGetPostRequest=!1,this.headers={},n&&"GET"===this.verb){this.isConvertGetPostRequest=!0,this.verb="POST";var a=f.test(this.url);this.url=this.url+(a?"&":"?")+d+"=true"}}return e.prototype.setHeader=function(e,t){this.headers[e]=t},e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.go=function(e){var t,r=this;return void 0===e&&(e="REST"),new Promise(function(a,s){var c=new XMLHttpRequest;if(c.open(r.verb,r.url),c.timeout=r.timeout,c.withCredentials=r.withCredentials||!1,r.isConvertGetPostRequest)r.body=JSON.stringify(r.headers);else for(var u in r.headers)r.headers.hasOwnProperty(u)&&c.setRequestHeader(u,r.headers[u]);c.onload=function(i){if(c.status>=200&&c.status<300){var u=n(t,i.timeStamp);a(r.getResponseObjectFromRequest(c,u))}else s(o(c,e))},c.onerror=function(){s(o(c,e))},c.ontimeout=function(){s({statusCode:c.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0})},c.onabort=function(){s({statusCode:c.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0})},t=i(),c.send(r.body)})},e.prototype.getResponseObjectFromRequest=function(e,t){return{Body:e.responseText,StatusCode:e.status,Headers:a(e.getAllResponseHeaders()),ResponseUrl:e.responseURL,RequestDurationFromEvents:t}},e}(),h=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},g=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},v=function(){function e(e,t,r,n,i,o){this.webSocketConnection=e,this.url=t,this.verb=r,this.timeout=n,this.body=o,this.headers={},this.fallbackXMLHttpRequestExecutor=new p(t,r,n,i,o,!0)}return e.prototype.setHeader=function(e,t){this.headers[e]=t,this.fallbackXMLHttpRequestExecutor.setHeader(e,t)},e.prototype.setTimeout=function(e){this.timeout=e,this.fallbackXMLHttpRequestExecutor.setTimeout(e)},e.prototype.go=function(){var e=this;return new Promise(function(t,r){e.webSocketConnection.send({Verb:e.verb,Body:e.body,Url:e.url,Headers:e.headers},function(e){e.StatusCode>=200&&e.StatusCode<300?t(e):r({message:e.StatusCode?"":"UndefinedOrAbortedRequestStatus_WS",statusCode:e.StatusCode,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:e.Headers})},function(n){return h(e,void 0,void 0,function(){var e,i;return g(this,function(o){switch(o.label){case 0:if(!n.shouldRetryAsXhrRequest)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fallbackXMLHttpRequestExecutor.go("RESTFallbackFromWs")];case 2:return e=o.sent(),t(e),[2];case 3:return i=o.sent(),r(i),[2];case 4:return r(n),[2]}})})},e.timeout).catch(function(n){return h(e,void 0,void 0,function(){var e,n;return g(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.fallbackXMLHttpRequestExecutor.go("RESTFallbackFromWs")];case 1:return e=i.sent(),t(e),[3,3];case 2:return n=i.sent(),r(n),[3,3];case 3:return[2]}})})})})},e}(),m=function(){return(m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},T=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},C=1e4,E=2,S=500,b=function(){function e(e,t,r,n,i,o,a,s){void 0===a&&(a=C),void 0===s&&(s=S),this.url=e,this.compressionDisabled=t,this.logTrace=r,this.logError=n,this.disableWebSockets=i,this.clientType=o,this.everOpened=!1,this.tryCount=0,this.inactivityTimer=0,this.serverPingTimer=0,this.wasClosedDueToInactivity=!1,this.wasClosedDueToMissingServerPings=!1,this.didClientInitiateClose=!1,this.sequenceNumber=0,this.activeRequestsMap={},this.serverPingTimeout=a*E+s,this.compressionDisabled||l().catch(function(){})}return e.prototype.isOpenOrConnecting=function(){return!!this.ws&&(this.ws.readyState===WebSocket.OPEN||this.ws.readyState===WebSocket.CONNECTING)},e.prototype.initializeWebSocket=function(e,t){return void 0===t&&(t=c),y(this,void 0,void 0,function(){var r=this;return T(this,function(n){return this.webSocketPromise&&this.isOpenOrConnecting()?[2,this.webSocketPromise]:[2,this.webSocketPromise=new Promise(function(n,i){return y(r,void 0,void 0,function(){var r,o,a=this;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),this.logTrace("WebSocket-initializeWebSocket"),this.wasClosedDueToInactivity=!1,this.wasClosedDueToMissingServerPings=!1,r=this.url+"?clientType="+this.clientType+(this.compressionDisabled?"&debug=1":""),this.ws=t(r),this.compressionDisabled||(this.ws.binaryType="arraybuffer"),this.ws.onerror=function(e){return a.onWebSocketError(e,i)},this.ws.onclose=function(e){return a.onWebSocketClose(e)},this.ws.onmessage=function(e){return a.onMessage(e)},this.ws.onopen=function(t){return a.onWebSocketOpen(e,n)},this.compressionDisabled?[3,2]:[4,this.preparePako()];case 1:s.sent(),s.label=2;case 2:return[3,4];case 3:return o=s.sent(),this.logError("WebSocket-initializeWebSocket-Exception",{Exception:o}),this.disableWebSockets(),i("WebSocket-initializeWebSocket-Exception"),[3,4];case 4:return[2]}})})})]})})},e.prototype.preparePako=function(){return y(this,void 0,void 0,function(){var e=this;return T(this,function(t){return this.promiseToPako=l().catch(function(){throw e.disableWebSockets(),e.closeConnection(4006,"PreparePakoChunkFailed"),new Error("PreparePakoChunkFailed")}),[2,this.promiseToPako]})})},e.prototype.getPako=function(){return this.promiseToPako?this.promiseToPako:Promise.reject("FailedToGetPako")},e.prototype.send=function(e,t,r,o){return void 0===o&&(o=3e4),y(this,void 0,void 0,function(){var a,s,c,u=this;return T(this,function(l){switch(l.label){case 0:return o=o<=0?3e4:o,a=this.sequenceNumber,this.sequenceNumber++,s={Key:a.toString(),Url:e.Url,Verb:e.Verb,Headers:e.Headers,Body:e.Body},c={onSuccess:function(e,r){t(m(m({},e),{RequestDurationFromEvents:n(c.requestStartTimeStamp,r)}))},onError:r,timeout:window.setTimeout(function(){return u.onRequestTimeout(a.toString())},o),protocolRequest:s,requestStartTimeStamp:i()},this.activeRequestsMap[c.protocolRequest.Key]=c,[4,this.initializeWebSocket(c.protocolRequest)];case 1:return l.sent(),this.sendProtocolRequest(c.protocolRequest),[2]}})})},e.prototype.sendProtocolRequest=function(e){return y(this,void 0,void 0,function(){var t,r,n;return T(this,function(i){switch(i.label){case 0:if(this.ws)return[3,1];throw Error("Websocket-send-ws-undefined");case 1:return t=JSON.stringify(e),this.compressionDisabled?(this.sendWebSocketRequestOrLogError(this.ws,t),[3,5]):[3,2];case 2:return i.trys.push([2,4,,5]),[4,this.getPako()];case 3:return r=i.sent(),n=r.deflateRaw(t),this.sendWebSocketRequestOrLogError(this.ws,n),[3,5];case 4:return i.sent(),this.disableWebSockets(),[3,5];case 5:return this.setInactivityTimer(),[2]}})})},e.prototype.sendWebSocketRequestOrLogError=function(e,t){try{e.send(t)}catch(e){this.logError("WebSocket-Send-Exception",{Exception:e.message})}},e.prototype.onMessage=function(e){var t=this;this.inflateData(e.data,function(r){try{t.setServerPingTimerIfEnabled();var n=JSON.parse(r),i=parseInt(n.Key,10);if(-1===i)return;if(n.Headers=n.Headers&&s(n.Headers),i in t.activeRequestsMap){var o=t.activeRequestsMap[i];o&&(clearTimeout(o.timeout),setTimeout(function(){return o.onSuccess(n,e.timeStamp)},0)),delete t.activeRequestsMap[i]}else t.logError("WebSocket-onMessage-UnableToFindResponseKey",{Key:i.toString()})}catch(e){t.logError("WebSocket-onMessage-ReceiveFailure",{Exception:e.message})}})},e.prototype.inflateData=function(e,t){return y(this,void 0,void 0,function(){var r,n,i;return T(this,function(o){switch(o.label){case 0:return this.compressionDisabled?(t(e),[3,4]):[3,1];case 1:return o.trys.push([1,3,,4]),[4,this.getPako()];case 2:return r=o.sent(),n=r.inflateRaw(new Uint8Array(e),{to:"string"}),t(n),[3,4];case 3:return i=o.sent(),this.logError("WebSocket-inflateData-PakoInflateFailure",{Exception:i}),t(""),[3,4];case 4:return[2]}})})},e.prototype.onWebSocketError=function(e,t){if(!this.wasClosedDueToInactivity&&!this.wasClosedDueToMissingServerPings){this.didClientInitiateClose=!1;try{this.logError("WebSocket-onError",{EventType:e.type,WSReadyState:this.ws&&this.ws.readyState.toString()}),this.isOpenOrConnecting()&&(this.logTrace("WebSocket-onError-ClosingExistingConnection"),this.closeConnection(4006,"onError"))}catch(e){this.logError("WebSocket-onError-Exception",{Exception:e})}this.disableWebSockets(),t("WebSocket-onError"),this.webSocketPromise=void 0}},e.prototype.onWebSocketClose=function(e){return y(this,void 0,void 0,function(){var t,r,n=this;return T(this,function(i){switch(i.label){case 0:this.stopListeningForServerPings(),i.label=1;case 1:if(i.trys.push([1,9,,10]),this.logTrace("WebSocket-onClose",{EventType:e?e.type:void 0,Code:e&&e.code?e.code.toString():void 0,Reason:e?e.reason:void 0,ClientInitiated:this.didClientInitiateClose,ClosedDueToInactivity:this.wasClosedDueToInactivity,ClosedDueToMissingServerPings:this.wasClosedDueToMissingServerPings,OutstandingRequestCount:Object.keys(this.activeRequestsMap).length.toString(),EverOpened:this.everOpened?"yes":"no",RetryCount:this.tryCount.toString()}),this.didClientInitiateClose=!1,!this.latestOpenTime||Date.now()-this.latestOpenTime<5e3)return this.logTrace("WebSocket-onClose-ClosedBeforeMinimalExpectedWebsocketLifetimeWasReached"),this.latestOpenTime=void 0,this.disableWebSockets(),this.markOutstandingRequestsAsFailure(),[2];if(this.wasClosedDueToInactivity||!(this.tryCount<2))return[3,7];this.tryCount++,i.label=2;case 2:return i.trys.push([2,5,,6]),this.webSocketPromise=void 0,[4,this.initializeWebSocket(void 0)];case 3:return i.sent(),[4,Promise.all(Object.keys(this.activeRequestsMap).map(function(e){return n.activeRequestsMap[e]}).map(function(e){return e?n.sendProtocolRequest(e.protocolRequest):Promise.resolve()}))];case 4:return i.sent(),[2];case 5:return t=i.sent(),this.logError("WebSocket-onClose-initializeException",{Exception:t}),this.markOutstandingRequestsAsFailure(),[3,6];case 6:return[3,8];case 7:this.markOutstandingRequestsAsFailure(),i.label=8;case 8:return[3,10];case 9:return r=i.sent(),this.logError("WebSocket-onClose-Exception",{Exception:r}),[3,10];case 10:return this.webSocketPromise=void 0,[2]}})})},e.prototype.markOutstandingRequestsAsFailure=function(){var e=this,t=this.hasInternetConnection()?{message:"TransportError - WebSocket closed",statusCode:-2,isExpected:!1,shouldRetryAsXhrRequest:!0,headers:void 0}:{message:"TransportError - WebSocket closed - no internet connection",statusCode:-3,isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0};Object.keys(this.activeRequestsMap).forEach(function(r){var n=e.activeRequestsMap[r];void 0!==n&&(n.onError(t),clearTimeout(n.timeout))}),this.activeRequestsMap={}},e.prototype.hasInternetConnection=function(){try{return window.navigator.onLine}catch(e){return!0}},e.prototype.onRequestTimeout=function(e){this.logError("WebSocket-request-onTimeout",{SequenceNumber:e});var t=this.activeRequestsMap[e];void 0!==t&&t.onError({message:"RequestTimeout",statusCode:-4,isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0}),delete this.activeRequestsMap[e]},e.prototype.onWebSocketOpen=function(e,t){e&&(e.Headers=s(e.Headers)),this.logTrace("WebSocket-initializeWebSocket-Success",{rootCorrelationId:e?e.Headers["x-rootcorrelationid"]:"",correlationId:e?e.Headers["x-correlationid"]:""}),this.latestOpenTime=Date.now(),this.everOpened=!0,this.setInactivityTimer(),this.setServerPingTimerIfEnabled(),t&&t()},e.prototype.closeConnection=function(e,t){this.didClientInitiateClose=!0,this.ws&&this.ws.close(e,t)},e.prototype.setInactivityTimer=function(){var e=this;this.inactivityTimer&&window.clearTimeout(this.inactivityTimer),this.inactivityTimer=window.setTimeout(function(){e.logTrace("WebSocket-InactivityTimeout"),e.isOpenOrConnecting()&&(e.wasClosedDueToInactivity=!0,e.closeConnection(1e3,"Inactivity"))},18e5)},e.prototype.setServerPingTimerIfEnabled=function(){var e=this;this.stopListeningForServerPings(),this.serverPingTimer=window.setTimeout(function(){e.wasClosedDueToMissingServerPings=!0,e.closeConnection(1e3,"MissingServerPings")},this.serverPingTimeout)},e.prototype.stopListeningForServerPings=function(){this.serverPingTimer&&(window.clearTimeout(this.serverPingTimer),this.serverPingTimer=0)},e}(),O=function(){function e(e,t,r,n,i,o,a){var s=this;this.logTrace=e,this.logError=t,this.tryToUseWebSockets=r,this.useGetPostConversion=n,this.tryToUseWebSockets=this.tryToUseWebSockets&&!this.isBrowserSafariOnMac(),this.tryToUseWebSockets&&(this.webSocketConnection=new b(i,o,function(e,t){return s.logTrace(e,t)},function(e,t){return s.logError(e,t)},function(){return s.tryToUseWebSockets=!1},a),this.webSocketConnection.initializeWebSocket().catch(function(){}))}return e.prototype.getRequestExecutor=function(e,t,r,n,i){var o=i&&i>0?i:4e4;return this.tryToUseWebSockets&&this.webSocketConnection&&!n?new v(this.webSocketConnection,e,t,o,this.useGetPostConversion,r):new p(e,t,o,this.useGetPostConversion,r,!0)},e.prototype.isBrowserSafariOnMac=function(){if(window&&window.navigator&&window.navigator.userAgent){var e=window.navigator.userAgent;return-1!==e.indexOf("Macintosh")&&-1!==e.indexOf("AppleWebKit/")&&-1!==e.indexOf("(KHTML, like Gecko) Version/")&&-1!==e.indexOf("Safari/")}return!1},e}()},function(e,t,r){"use strict";r(13);var n=r(14);r.d(t,"StikkontaktRequestFactory",function(){return n.a})},,,function(e,t,r){"use strict";function n(e,t,r){return m(this,void 0,void 0,function(){var n,o;return y(this,function(a){switch(a.label){case 0:return(o=Object(v.b)(t)).lpcConfig?(n=o.lpcConfig,[3,3]):[3,1];case 1:return[4,i(e,t,r)];case 2:n=a.sent(),o.lpcConfig=n,a.label=3;case 3:return[2,n]}})})}function i(e,t,r){return m(this,void 0,void 0,function(){var n,o;return y(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,Object(g.a)(e,t,r)];case 1:return n=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,Object(h.a)(void 0,t.getAuthToken,r)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return C<T?(C++,[4,i(e,t,r)]):[3,6];case 5:return n=a.sent(),[3,7];case 6:throw o.numberOfRetries=C,o;case 7:return[3,8];case 8:return[2,n]}})})}function o(e,t){var r=e.ResourceUrls||[];if(0===r.length){var n=e.Resources[O],i=e.Resources[S];"OwaPeopleHub"===e.Workload&&(i=e.Resources[b]),r=[n,i]}return Promise.all(r.map(function(e){return Object(E.a)(e,t)})).then(function(){return r})}function a(e,t){var r=t.targetWindow;return new Promise(function(n,i){setTimeout(function(){try{r.LPC||i(new R.a("StartLivePersonaCardError","targetWindow.LPC is undefined.")),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||i(new R.a("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var o=function(e,t){var r=t.targetWindow;return{refreshAuthToken:s(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);r.LPC.start(o),n()}catch(e){i(new R.a("StartLivePersonaCardError",e.name))}},0)})}function s(e){return function(t){e.getAuthToken(function(e,r){t(e,"",r,void 0)},function(e,r){t("",e,r,void 0)})}}function c(e){return N(this,void 0,void 0,function(){var t,r,i,s,c=this;return L(this,function(u){return t=Object(v.b)(e),r=function(){return Object(v.b)(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(i=t.bootstrapperConfig.targetWindow,s=new P.a(i),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(u,l){return N(c,void 0,void 0,function(){var c,f,d,p,g,v;return L(this,function(m){switch(m.label){case 0:c=Object(k.a)(e),m.label=1;case 1:return m.trys.push([1,7,,8]),Object(_.a)(e),s.startCustomTiming(P.b.getAuthToken),[4,Object(h.a)(e.authToken,e.getAuthToken,i)];case 2:return f=m.sent(),s.endCustomTiming(P.b.getAuthToken),s.measureFromStart(P.b.getAuthTokenFromStart),s.startCustomTiming(P.b.getLokiConfig),[4,n(f,e,i)];case 3:return d=m.sent(),s.endCustomTiming(P.b.getLokiConfig),s.measureFromStart(P.b.getLokiConfigFromStart),s.startCustomTiming(P.b.getLpcBundles),[4,o(d,i)];case 4:return m.sent(),s.endCustomTiming(P.b.getLpcBundles),s.measureFromStart(P.b.getLpcBundlesFromStart),s.startCustomTiming(P.b.startLpc),[4,a(d,t.bootstrapperConfig)];case 5:return m.sent(),s.endCustomTiming(P.b.startLpc),s.measureFromStart(P.b.startLpcFromStart),[4,r().updateContextWithLokiDataAsync(d,c).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return m.sent(),(p=Object(w.a)(s.getAllTimings())).RootCorrelationId=d.RootCorrelationId,p.isConsumer=e.isConsumer,r().logEventAsync({name:"initializeLivePersonaCard_success",properties:p},c),u(),[3,8];case 7:return g=m.sent(),v=Object(w.a)(s.getAllTimings()),r().logEventAsync({name:"initializeLivePersonaCard_failure",properties:I(I(I({},Object(A.a)(g)),v),{isConsumer:e.isConsumer})},c),l("Failed to initialize Live Persona Card: "+g.name+" "+g.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},p.a)}),[2,t.initializationPromise])})})}function u(e){Object(v.a)(e)}function l(e){return N(this,void 0,void 0,function(){var t;return L(this,function(r){switch(r.label){case 0:return t=Object(v.b)(e),[4,Object(h.a)(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,n(r.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}function f(e){return N(this,void 0,void 0,function(){var t;return L(this,function(n){return t=Object(v.b)(e),[2,r.e(2).then(r.bind(null,51)).then(function(e){return(0,e.initializeTopicCardAsync)(t.bootstrapperConfig)})]})})}function d(e){return N(this,void 0,void 0,function(){return L(this,function(t){switch(t.label){case 0:return[4,r.e(0).then(r.bind(null,50))];case 1:return[2,(0,t.sent().initializeOfficeFeedAsync)(e)]}})})}r.r(t),r.d(t,"initializeLivePersonaCardAsync",function(){return c}),r.d(t,"freeBootstrapperMemory",function(){return u}),r.d(t,"fetchLokiConfigAsync",function(){return l}),r.d(t,"lazyInitializeTopicCardAsync",function(){return f}),r.d(t,"lazyInitializeOfficeFeedAsync",function(){return d});var p=r(7),h=r(4),g=r(11),v=r(2),m=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},y=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},T=2,C=0,E=r(8),S="livepersonacard_with-react",b="livepersonacard_without-react",O="livepersonacardstrings",R=r(0),k=r(9),A=r(10),w=r(6),P=r(1),_=r(12),I=function(){return(I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},N=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},L=function(e,t){function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};try{var U=window.document.createElement("link"),D=Boolean("onmscontentzoom"in window.document);U.rel=D?"dns-prefetch":"preconnect",U.href="https://lpcres.delve.office.com/",window.document.head.appendChild(U)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}}])})},1984:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){c.label=r[1];break}if(6===r[0]&&c.label<a[1]){c.label=a[1],a=r;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(r);break}a[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=this;Object.defineProperty(t,"__esModule",{value:!0});var a=r(58),s=function(e,t,r){return function(n){var i={slug:n.peopleSlug||n.slug,groupName:n.groupName||n.teamName,middlePane:n.middlePane,threadId:n.threadId,messageId:void 0,ctx:n.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return r.navigatePromise(t,e.states.appConversation,i)}},c=function(e,t){return function(r,a){return void 0===a&&(a=!1),n(o,void 0,void 0,function(){var n;return i(this,function(i){return(n=e.getChatConversationWith(r))?[2,t.placeCall({conversationId:n.id,withVideo:a,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},u=function(e,t){return function(r,n){var i=e.getChatConversationWith(r);if(!i)return Promise.reject("Cannot find the chat");var o=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:n,messagePreview:n,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:o,externalId:null,draftObjectId:null,inlineImages:null})}},l=function(e,t,r,s,c,u){return function(l,f){var d=l.persona;return n(o,void 0,void 0,function(){var n,o,l,p,h;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),n=e.scenarios.people.livePersonaCardStartChat,[4,r.getAllLatestPeopleProfile([d.HostAppPersonaId],n,!1)];case 1:return o=i.sent()[0],l=s.getPrivateChatUserMri(o,n),[4,c({groupName:o.displayName,peopleSlug:l,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),f(!0),u(a.LpcCallbackTelemetryType.chatAction),[3,4];case 3:return p=i.sent(),h="Failed to navigate to chat",t.error(h),f(!1,h),[3,4];case 4:return[2]}})})}},f=function(e,t,r,s,c,u){return function(s,l){return n(o,void 0,void 0,function(){var n,o,f,d;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),n=e.scenarios.people.livePersonaCardOrgChart,[4,r.getAllLatestPeopleProfile([s.HostAppPersonaId],n,!1)];case 1:return o=i.sent()[0],[4,c({groupName:o.displayName,slug:s.HostAppPersonaId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),l(!0),u(a.LpcCallbackTelemetryType.orgChartAction),[3,4];case 3:return f=i.sent(),d="Failed to navigate to org chat",t.error(d),l(!1,d),[3,4];case 4:return[2]}})})}},d=function(e,t,r){return function(s,c){return n(o,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(s.HostAppPersonaId)];case 1:return i.sent(),c(!0),r(a.LpcCallbackTelemetryType.audioCallAction),[3,3];case 2:return n=i.sent(),o="Failed to start audio call with",e.error(o),c(!1,o),[3,3];case 3:return[2]}})})}},p=function(e,t,r){return function(s,c){return n(o,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(s.HostAppPersonaId,!0)];case 1:return i.sent(),c(!0),r(a.LpcCallbackTelemetryType.videoCallAction),[3,3];case 2:return n=i.sent(),o="Failed to start video call with",e.error(o),c(!1,o),[3,3];case 3:return[2]}})})}},h=function(e,t,r){return function(s,c,u){return n(o,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",c&&c.length),[4,t(s.HostAppPersonaId,c)];case 1:return i.sent(),u(!0),r(a.LpcCallbackTelemetryType.quickMessageAction),[3,3];case 2:return n=i.sent(),o="Failed to send message",e.error(o),u(!1,o),[3,3];case 3:return[2]}})})}};t.LPCActionCallbackFactory=function(e,t,r,n,i,o,a,g,v){var m=s(t,e,o),y=c(i,a),T=u(i,g);return{startChat:l(t,r,n,i,m,v),showOrgChart:f(t,r,n,0,m,v),sendQuickMessage:h(r,T,v),startVideoCall:p(r,y,v),startAudioCall:d(r,y,v)}}},1985:function(e,t,r){"use strict";function n(e,t){var r=this;return function(n,i){return o(r,void 0,void 0,function(){var r,o,s,c,l;return a(this,function(a){switch(a.label){case 0:r=n.TeamsMri||n.Smtp||n.Upn,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.getAllPeopleProfile([r],"lpc-data-callback",!Boolean(n.TeamsMri))];case 2:return(o=a.sent()[0])?(s=o,c={hostAppPersonaId:n.HostAppPersonaId,aadObjectId:s.objectId,email:{Address:s.email},upn:s.userPrincipalName,userType:u.determineLPCPersonaType(s.role,s.type),displayName:s.displayName,skypeId:s.skypeId,teamsMri:n.TeamsMri||s.mri},i(c,void 0)):(t.error("getAllPeopleProfile returned no profile in LPC data callback"),i(void 0,"No profile returned")),[3,4];case 3:return l=a.sent(),t.error("getAllPeopleProfile failed in LPC data callback"),i(void 0,"Exception in profile call"),[3,4];case 4:return[2]}})})}}var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){c.label=r[1];break}if(6===r[0]&&c.label<a[1]){c.label=a[1],a=r;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(r);break}a[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=this;Object.defineProperty(t,"__esModule",{value:!0});var c=r(58),u=r(232);t.unescapeHtmlEntities=function(e){if(!e)return e;var t=document.createElement("textarea");return t.innerHTML=e,t.value};var l=function(e,t,r,n){return function(c,u){return o(s,void 0,void 0,function(){var o,s,l,f;return a(this,function(a){switch(a.label){case 0:if(o={mri:c.TeamsMri,principalName:c.Upn||c.Smtp||c.TeamsMri,displayName:c.DisplayName||"",size:r.profilePictureSizes.medium},c.DisplayName)return[3,4];s=c.TeamsMri||c.Smtp||c.Upn,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.getAllShortPeopleProfile([s],"lpc-image-data-callback",!Boolean(c.TeamsMri))];case 2:return(l=a.sent()[0])&&(o=i({},o,{displayName:l.displayName})),[3,4];case 3:return f=a.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,4];case 4:return t.loadImage(o,!1,!1,!1,"lpc-data-callbacks").then(function(e){var t=e&&e.imgUrl||"";u(t,{})}).catch(function(e){u(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,r){var n=t.findConversationWith(r);if(n&&n.isSfC())return n.InteropConversationStatus()===e.interopConversationStatus.blocked?c.PersonaPresence.blocked:c.PersonaPresence.none};var f=function(e,r,n,i,o){var a=t.getSkypeConsumerChatStatus(n,i,o);if(void 0!==a)return a;var s=e.status,u=e.flwPresence;if(r.valueAsBoolean(n.settings.names.enableFlwPresence)){if(u===SkypeX.Services.UserFlwPresence.OffShift)return c.PersonaPresence.offline;if(u===SkypeX.Services.UserFlwPresence.OnShift)switch(s){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return c.PersonaPresence.busy;default:return c.PersonaPresence.online}}switch(s){case SkypeX.Services.UserStatus.Online:return c.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return c.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return c.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return c.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return c.PersonaPresence.dnd;default:return c.PersonaPresence.offline}},d=function(e,t,r,n,i,o,a){if(!t||0===t.length)return e;var s=n.getLocalTimezone();if(r&&s!==r){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),u=c.length>0?c[c.length-1]:null;u&&(t=o.instant(a.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:u}))}return o.instant(a.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},p=function(e,t,r,n,i,o,a,s,c){var u=e.status,l=e.calendarData,f=e.lastSeenAt,p=e.flwPresence,h=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(p===SkypeX.Services.UserFlwPresence.OffShift)return r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(p===SkypeX.Services.UserFlwPresence.OnShift){var g=void 0,v=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(h);switch(m&&m.currentShift&&(g=c.getDate(new Date(m.currentShift.endTime),"shortTime"),v=m.currentShift.teamOlsonCode),u){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=n.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:r.GetTranslatedStatusText(u),secondaryStatus:r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return d(y,g,v,s,c,n,o);default:var T=r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return d(T,g,v,s,c,n,o)}}}var C=f&&(new Date).getTime()-f.getTime()<=i.timeInMiliseconds.year;if(l&&l.isOutOfOffice)switch(u){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return n.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:r.GetTranslatedStatusText(u),secondaryStatus:r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?a.transformIntoTimeago(f):r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return r.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(u){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?a.transformIntoTimeago(f):r.GetTranslatedStatusText(u);default:return r.GetTranslatedStatusText(u)}},h=function(e,t,r,n,i){var o="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=n.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o},g=function(e,t,r,n,i,o){var a={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var u=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(u)}if(s){var l=n.stripHtml(i.sanitizeHtml(s)).trim(),f=h(e,0,0,n,i);l.length&&!f.length&&(a.message=l)}}return a.message&&a.publishTime?a:void 0},v=function(e,r,n,i){var o=[],a=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===r.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=n.DomUtils.getText(i),c=JSON.parse(e.decodeHtml(i.attribs["data-itemprops"])).mri;o.push({text:t.unescapeHtmlEntities(s),hostAppPersonaId:c})}else"text"===i.type?o.push({text:t.unescapeHtmlEntities(n.DomUtils.getText(i)),hostAppPersonaId:void 0}):"br"===i.name?o.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&a(i.children)})};return a(i),o},m=function(e,t,r,n,i,o){if(t.valueAsBoolean(r.settings.names.enableStatusNoteV2)&&e.note){var a={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var u=i.sanitizeHtml(s).trim(),l=window.htmlparser2,f=l.parseDOM("<div>"+u+"</div>"),d=v(n,r,l,f);a.message=d}if(c&&c.trim()){var p=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(p)}return a.message.length&&a.publishTime?a:void 0}},y=function(e,t,r,n,i,o,a,s,c,u,l,d,v){return function(y,T){var C=e.getPresence(y,T);return{presence:f(C,i,o,v,y),isOutOfOffice:C&&!!C.calendarData&&!!C.calendarData.isOutOfOffice,oofMessage:C&&h(C,0,0,t,r),presenceText:C&&p(C,i,a,s,o,c,u,l,d),statusNote:C&&g(C,0,0,t,r,n),statusNoteV2:C&&m(C,i,o,t,r,n)}}},T=function(e){return function(t){var r=e.findConversationWith(t);return r&&r.isInteropChat()?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS}},C=function(e,t,r,n,i,o,a,s,c,u,l,f,d){return function(p,h){var g=T(e);h(y(t,r,n,i,o,a,s,c,u,l,f,d,e)(p.TeamsMri,g(p.TeamsMri)),void 0)}},E=function(e,t,r,n,i){return function(c){return o(s,void 0,void 0,function(){var o,s,u,l,f,d,p,h,g,v,m;return a(this,function(a){switch(a.label){case 0:o={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1},s=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),o.disableCall=!s,o.disableVideo=!s,u=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.getAllPeopleProfile([c.TeamsMri],"lpc-header-action-callback",!c.TeamsMri)];case 2:return(l=a.sent()[0])&&(f=l.featureSettings,d=l.type,p=l.userType,h=f&&f.isPrivateChatEnabled,g=d&&d.toLowerCase()===i.userTypes.person.toLowerCase(),v=p&&p.toLowerCase()===i.userTypes.guest.toLowerCase(),o.disableChat=!1===h||!u,o.disableOrg=!(g&&!v)),[3,4];case 3:return m=a.sent(),n.error("Failed to fetch persona profile in LPC data callbacks"),[3,4];case 4:return[2,o]}})})}};t.GetPresenceSourceFunction=T,t.GetRichPresenceFunction=y,t.LPCDataCallbackFactory=function(e,t,r,i,o,a,s,c,u,f,d,p,h,g,v,m,y,T){return{getAndPrefetchPersonaImageUri:l(e,m,u,i),getRichPresence:C(t,r,o,a,s,c,u,f,d,p,h,g,v),getHeaderActionsPolicyAsync:E(y,T,i,e,u),getPersonaInfo:n(i,e)}}},1986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1987);t.defaultTheme=n.defaultTheme;var i=r(1988);t.darkTheme=i.darkTheme;var o=r(1989);t.highContrastTheme=o.highContrastTheme},1987:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="rgba(37,36,36,0.75)",i={themePrimary:n,themeSecondary:n,neutralPrimary:"#252424",neutralSecondary:n,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},1988:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},1989:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="#000000",i="#ffffff",o={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:n,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:n,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:n,neutralQuaternary:n,neutralQuaternaryAlt:i,white:n,black:i,purple:"#ffff00",magenta:i,magentaDark:n};t.highContrastTheme={palette:o}},1990:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,o=teamspace.components.PanelActionScenario,a=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,u=r(58),l=function(){function e(e,t){this.analyticsService=e,this.loggingService=t}return e.prototype.logPanelActionEvent=function(e){var t,r,l,f,d=this,p=c.people,h=i.nav,g=a.people,v=teamspace.PanelRegion.popover;switch(e){case u.LpcCallbackTelemetryType.audioCallAction:r=n.click,l=o.navCalling,f=s.lpcAudioCall,t="AudioCallLpc";break;case u.LpcCallbackTelemetryType.chatAction:r=n.click,l=o.navChat,f=s.lpcStartChat,t="ChatLpc";break;case u.LpcCallbackTelemetryType.orgChartAction:r=n.click,l=o.orgChart,f=s.lpcOrgChart,t="OrgChartLpc";break;case u.LpcCallbackTelemetryType.quickMessageAction:r=n.click,h=i.submit,l=o.quickIM,f=s.lpcQuickIM,t="QuickIMLpc";break;case u.LpcCallbackTelemetryType.videoCallAction:r=n.click,l=o.navCalling,f=s.lpcVideoCall,t="VideoCallLpc";break;default:return}var m={action:{gesture:r,outcome:h,scenario:l?teamspace.shared.AttributeHelper.tryGetEnum(l.toString(),o,this.loggingService):null,scenarioType:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),a,this.loggingService):null},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(f.toString(),s,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(p.toString(),c,this.loggingService),summary:t}};this.analyticsService.getAnalyticsPanelActionEventData(m,v).then(function(e){d.analyticsService.sendPanelAction(e)})},e}();t.LpcTelemetryHelper=l},232:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e}},58:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.audioCallAction=0]="audioCallAction",e[e.chatAction=1]="chatAction",e[e.orgChartAction=2]="orgChartAction",e[e.quickMessageAction=3]="quickMessageAction",e[e.videoCallAction=4]="videoCallAction",e[e.personImageCallback=5]="personImageCallback",e[e.richPresenceCallback=6]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[1981]);