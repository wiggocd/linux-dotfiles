(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[24],{"348426a60b7cb4dbeb31":function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i("11e808f62b4fe6e70870"),r=i("d200c08d057f868315fd"),s=i("5f0dbee501b8046e840c"),a=i("2118c0654cdae82c146d"),o=function(){function t(){var t=this;this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=function(){return t.telemetryProvider.flush()},this.telemetryProvider=Object(n.b)(),Object(r.a)(function(){t.initialized=!1,t.eventDecoratorCallbacks=[]})}return t.prototype.initialize=function(t,e,i){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),a.a.getInstance().initialize(i),this.telemetryProvider.initialize(t,this.consoleLogger),this._tablePostfix=t.documentInfo.tablePostfix||"",this.initialized=!0)},t.getInstance=function(){return this.telemetrySender||(this.telemetrySender=new t),this.telemetrySender},t.prototype.registerEventDecorator=function(t){this.eventDecoratorCallbacks.push(t)},t.prototype.sendTelemetry=function(t,e,i,r){if(void 0===i&&(i={}),this.initialized){e=e.replace(/\-/g,"_").toLowerCase();var o=(""+s.a[t]+this._tablePostfix).toLowerCase(),c=t===s.a.Scenario?i["Scenario.Status"]:t===s.a.Http?i.resultCode:void 0,u=a.a.getInstance().getSampleRate(o,e,c);if(u!==a.b){this.decorateEvent(e,i);var p=this.telemetryProvider.createEvent(o,e,i,r);p.setProperty("sampleRate",u);var h=t===s.a.UserBI?n.a.userBi:n.a.default;this.telemetryProvider.logEvent(h,p)}}},t.prototype.decorateEvent=function(t,e){this.eventDecoratorCallbacks.forEach(function(i){return i(t,e)})},t}();function c(t,e,i,n){o.getInstance().sendTelemetry(t,e,i,n)}},"5f0dbee501b8046e840c":function(t,e,i){"use strict";var n;i.d(e,"a",function(){return n}),function(t){t[t.Perf=0]="Perf",t[t.Scenario=1]="Scenario",t[t.Logging=2]="Logging",t[t.Tracking=3]="Tracking",t[t.Heartbeat=4]="Heartbeat",t[t.Http=5]="Http",t[t.UserBI=6]="UserBI"}(n||(n={}))},"9c02356a8a4ea0c6b9d5":function(t,e,i){"use strict";var n=i("64328bb588b46459132d"),r=12e4,s={"cdl-request":!0},a=i("f9a6412761c79a080418"),o=i("348426a60b7cb4dbeb31"),c=i("e4015b2ea28f962ed7da"),u=i("5f0dbee501b8046e840c"),p=i("94a755535d135f12850c"),h=function(){function t(t,e,i,n,r,s,a,o,u,p,h,l){var f=this;void 0===u&&(u=!1),void 0===p&&(p=!1),void 0===h&&(h=!1),this._id=t,this._name=e,this._eventData=i,this.scenarioFactory=n,this.logger=r,this.timeout=s,this.callback=a,this.memoryAnalyzer=o,this.enableDiagnostics=u,this.markStepsInTrace=p,this.showAllConsoleLogs=h,this.reportActivity=l,this._sequence=0,this.getTotalPauseDuration=function(){return f.pauseInfo.totalTime},this._currentStep=c.b.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0};var m=0;if(i.overrideTimestamp?(m=i.overrideTimestamp-Date.now(),i.overrideTimestamp=void 0):i.offsetCurrentTimeInMs&&(m=-i.offsetCurrentTimeInMs,i.offsetCurrentTimeInMs=void 0),this._absoluteStartTime=Date.now()+m,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp()+m,this.memoryAnalyzer){var g=this.memoryAnalyzer.snapshotMemoryUsage();g&&(this.workingSetInitial=g.workingSetKb,this.privateBytesInitial=g.privateBytesKb)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"absoluteStartTime",{get:function(){return this._absoluteStartTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delta",{get:function(){return this.scenarioFactory.timestamp()-this.relativeTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeoutMs",{get:function(){return this.timeout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventData",{get:function(){return this._eventData},set:function(t){this._eventData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamps",{get:function(){return this._timestamps},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentStep",{get:function(){return this._currentStep},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPaused",{get:function(){return!!this.pauseInfo.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHoisted",{get:function(){return this._isHoisted},set:function(t){this._isHoisted=t},enumerable:!0,configurable:!0}),t.prototype.appendEventData=function(t){this.eventData=Object(n.__assign)(Object(n.__assign)({},this.eventData),t)},t.prototype.markAggregateStart=function(t){this.active?(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[t]||(this.aggregateStepStartTime[t]=performance.now())):this.logger.debug("Scenario '"+this.name+"' set to inactive")},t.prototype.markAggregateStop=function(t){this.active&&this.aggregateStepStartTime[t]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[t]||(this.aggregateStepTotalTime[t]=0),this.aggregateStepTotalTime[t]+=performance.now()-this.aggregateStepStartTime[t],this.aggregateStepStartTime[t]=void 0)},t.prototype.pause=function(t,e){if(this.active&&!this.isPaused){this._currentStep!==c.b.Unknown&&this.mark(this._currentStep);var i=t.reason,r=Object(n.__rest)(t,["reason"]);this.mark(c.b.Pause,Object(n.__assign)({pauseReason:i},r),void 0,e),this.pauseInfo=Object(n.__assign)(Object(n.__assign)({},this.pauseInfo),{reason:i,startTime:Date.now()})}},t.prototype.resume=function(t,e){if(this.active&&this.isPaused){var i=this.pauseInfo.startTime?Date.now()-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+i,this.mark(c.b.Resume,Object(n.__assign)(Object(n.__assign)({},t),{pauseReason:this.pauseInfo.reason}),void 0,e),this.pauseInfo.reason="",this.pauseInfo.startTime=0}},t.prototype.stop=function(t,e,i){var n=this;void 0===e&&(e="success"),this._currentStep!==c.b.Unknown&&this.mark(this._currentStep,void 0,e,i),this.aggregateStepTotalTime&&(Object(p.each)(Object.keys(this.aggregateStepTotalTime),function(t){var e=parseInt(n.aggregateStepTotalTime[t].toString(),10);n.mark(c.b[t],{stepDelta:e},void 0,i)}),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(c.b.Stop,t,e,!0,i).then(function(){n.active&&(n.active=!1),n.callback&&n.callback(e),n.scenarioFactory.clearScenario(n)})},t.prototype.fail=function(t,e){this.stop(t,"failure",e)},t.prototype.cancel=function(t,e){this.stop(t,"abandoned",e)},t.prototype.incomplete=function(t,e){this.stop(t,"incomplete",e)},t.prototype.mark=function(t,e,i,n){void 0===i&&(i="success"),this.createMark(t,e,i,!1,n),this._currentStep=c.b.Unknown},t.prototype.startStep=function(t){this._currentStep!==c.b.Unknown&&t!==this._currentStep&&this.mark(this._currentStep),this._currentStep=t},t.prototype.prepareAndSendTelemetry=function(t,e){this.eventData&&this.eventData!==t&&(t=Object(n.__assign)(Object(n.__assign)({},this.eventData),t)),t.InstanceId=this.id,this.updateEventDataMemory(t),t=this.getEventDataWithComutedValues(t),this.enableDiagnostics&&Object(a.a)().pushTelemetryEvent(u.a[u.a.Scenario],t),"start"!==t["Scenario.Step"]&&Object(o.a)(u.a.Scenario,this.name,t,e),this.logScenarioPerf(t)},t.prototype.logScenarioPerf=function(t){if(this.showAllConsoleLogs){var e=t["Scenario.Step"],i=e===c.b.Start?"[step]("+this._sequence+")"+e:e===c.b.Stop?"[step]("+this._sequence+")"+e+" ("+t.stepDelta+"ms/"+t.delta+"ms)":"[step]("+this._sequence+")"+e+" ("+t.stepDelta+"ms)";this.logger&&this.logger.log("[Scenario]"+this.name+" "+i)}},t.prototype.updateEventDataMemory=function(t){if(this.memoryAnalyzer){var e=this.memoryAnalyzer.snapshotMemoryUsage();e&&(t.workingSet=e.workingSetKb,t.privateBytes=e.privateBytesKb,t.workingSetDelta=this.workingSetInitial?this.workingSetInitial-e.workingSetKb:void 0,t.privateBytesDelta=this.privateBytesInitial?this.privateBytesInitial-e.privateBytesKb:void 0)}},t.prototype.getEventDataWithComutedValues=function(t){var e,i=this.intervalTimestamp;Object(p.isNumber)(t.overrideTimestamp)?(e=this.relativeTimestamp+t.overrideTimestamp-this._absoluteStartTime,t.overrideTimestamp=void 0):t.offsetCurrentTimeInMs?(e=this.scenarioFactory.timestamp()-t.offsetCurrentTimeInMs,t.offsetCurrentTimeInMs=void 0):e=t["Scenario.Step"]===c.b.Start?this.relativeTimestamp:this.scenarioFactory.timestamp(),this._timestamps.push(e),this.intervalTimestamp=e;var r=Object(p.isNumber)(t.stepDelta)?t.stepDelta:e-i,s=Object(p.isNumber)(t.delta)?t.delta:e-this.relativeTimestamp-this.getTotalPauseDuration(),a=Object(p.isNumber)(t.elapsed)?t.elapsed:e,o=Object(p.isNumber)(t.elapsedSinceCoreInit)?t.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),u=!!this.scenarioFactory.findScenario(c.a.WindowLaunchTime);return Object(n.__assign)(Object(n.__assign)({},t),{isInEst:u,stepDelta:r,delta:s,elapsed:a,elapsedSinceCoreInit:o})},t.prototype.getMonitoringDataOverride=function(t){var e=t;return this.name!==c.a.WindowLaunchTime&&this.name!==c.a.ExperienceReady||(e=t?Object(p.cloneDeep)(t):{scenarioPriority:"P0",data:[]}).data.push({key:"App",value:this.eventData.contentSlotApp}),e},t.prototype.createMark=function(t,e,i,r,a){return void 0===e&&(e={}),Object(n.__awaiter)(this,void 0,void 0,function(){var o,c,u,p;return Object(n.__generator)(this,function(n){return t&&this.active?(e["Scenario.Status"]=i,e["Scenario.Step"]=t,e["Scenario.Name"]=this.name,o=this.getMonitoringDataOverride(a),performance&&performance.mark&&performance.measure&&!s.hasOwnProperty(e["Scenario.Name"])&&(c=e["Scenario.Step"]+" "+e["Scenario.Name"]+"-"+this.id,performance.mark(c),"stop"===e["Scenario.Step"]&&(u="start "+e["Scenario.Name"]+"-"+this.id,0===(performance.getEntriesByName(u,"mark")||[]).length&&(u="navigationStart"),p=this.clientName?" ("+this.clientName+")":"",performance.measure(""+e["Scenario.Name"]+p,u,c)),this.markStepsInTrace&&(this.previousMark&&performance.measure(e["Scenario.Name"]+" ["+this.previousMark+" <=> "+e["Scenario.Step"]+"]",this.previousMark+" "+e["Scenario.Name"]+"-"+this.id,e["Scenario.Step"]+" "+e["Scenario.Name"]+"-"+this.id),this.previousMark=e["Scenario.Step"])),this.prepareAndSendTelemetry(e,o),this.active=this.active&&!r,this.reportActivity&&this.reportActivity(e),this._sequence+=1,[2]):[2]})})},t}(),l=i("3e9c7e5351d86134f5f6"),f=function(){function t(t){this._name=t}return Object.defineProperty(t.prototype,"id",{get:function(){return"noop"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delta",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeoutMs",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventData",{get:function(){return{}},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamps",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPaused",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHoisted",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.appendEventData=function(t){},t.prototype.pause=function(t){},t.prototype.resume=function(t){},t.prototype.cancel=function(t){},t.prototype.mark=function(t,e,i){},t.prototype.startStep=function(t){},t.prototype.stop=function(t,e){},t.prototype.fail=function(t){},t.prototype.incomplete=function(t){},t.prototype.markAggregateStart=function(t){},t.prototype.markAggregateStop=function(t){},t.prototype.getTotalPauseDuration=function(){return 0},t}();i.d(e,"a",function(){return m});var m=function(){function t(t,e,i,n,s,a,o){var c=this;void 0===e&&(e=0),void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===s&&(s=!1),this.appStartTimestamp=e,this.enableDiagnostics=i,this.markStepsInTrace=n,this.showAllConsoleLogs=s,this.memoryAnalyzer=o,this.activeScenarios=[],this.scenarioTimeoutMs=r,this.markStep=function(t,e,i){var n=c.findScenario(t);n&&n.mark(e,i&&i.eventData,i&&i.status,i&&i.monitoringData)},this.startStep=function(t,e){var i=c.findScenario(t);i&&i.startStep(e)},this.timestamp=function(){return Date.now()-c.appStartTimestamp},this.setTimeoutCallback=(null==a?void 0:a.setTimeout)||setTimeout,this.clearTimeoutCallback=(null==a?void 0:a.clearTimeout)||clearTimeout,this.logger=t.newLogger("Telemetry"),this.logger.debug("Initialized ScenarioFactory")}return t.prototype.newScenario=function(t,e){var i=this.createScenarioWithoutStarting(t,e);return i.mark("start",void 0,void 0,e&&e.monitoringData),i},t.prototype.createScenarioWithoutStarting=function(t,e){if(void 0===e&&(e={}),0===this.appStartTimestamp)return new f(t);var i=void 0===e.captureMemoryUsage||e.captureMemoryUsage,n={};isNaN(e.startTime)||null===e.startTime||(n.overrideTimestamp=e.startTime);var r=Object(l.v4)(),s=new h(r,t,n,this,this.logger,e.timeoutMs||this.scenarioTimeoutMs,e.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics,this.markStepsInTrace,this.showAllConsoleLogs),a=this.setupScenarioTimeout(s);return this.activeScenarios.push({scenario:s,timeoutId:a}),s},t.prototype.cancelExistingAndCreateScenario=function(t,e,i,n,r){var s=this.findScenario(t);if(s){var a=[{reason:e}];s.cancel({errors:JSON.stringify(a)})}return s=this.newScenario(t,{timeoutMs:i,callback:n,monitoringData:r})},t.prototype.stopScenarioIfActive=function(t,e,i,n){var r=this.findScenario(t);r&&r.stop(e,i,n)},t.prototype.findScenario=function(t){if(!t)return null;var e=Object(p.findLast)(this.activeScenarios,function(e){return e&&e.scenario.name===t||e.scenario.clientId===t})||null;return e?e.scenario:null},t.prototype.findScenarioByNameAndId=function(t,e){var i=Object(p.findLast)(this.activeScenarios,function(i){return i.scenario.name===t&&i.scenario.clientId===e})||null;return i?i.scenario:null},t.prototype.clearScenario=function(t){var e=Object(p.findIndex)(this.activeScenarios,function(e){return e.scenario===t});if(e>-1){var i=this.activeScenarios.splice(e,1)[0];this.clearTimeoutCallback(i.timeoutId)}},t.prototype.setContext=function(){},t.prototype.setupScenarioTimeout=function(t,e){var i=t.timeoutMs;return this.setTimeoutCallback(function(){t.stop(t.eventData,"timeout",e)},i)},t}()},e0ae79cd8630f9b39623:function(t,e,i){"use strict";i.d(e,"b",function(){return r}),i.d(e,"a",function(){return s}),i.d(e,"c",function(){return o});var n=i("94a755535d135f12850c");function r(t,e,i){return t=a(t,e,i=i||s),1===e.length&&"object"==typeof e[0]&&(t=a(t,e[0],i)),t}function s(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=typeof t;if("string"===e)return t;if("number"===e||"boolean"===e)return String(t);if("function"===e)return"";if(Object(n.isDate)(t))return t.toISOString();try{return JSON.stringify(t)}catch(e){return function(t){var e=[];return JSON.stringify(t,function(t,i){if("object"==typeof i){if(-1!==e.indexOf(i))return;e.push(i)}return i})}(t)}}function a(t,e,i){for(var n in e)e.hasOwnProperty(n)&&(t=t.replace("{"+n+"}",i(e[n])));return o(t)}function o(t){return null==t||0===t.length?t:(" "+t).substr(1)}},f9a6412761c79a080418:function(t,e,i){"use strict";var n,r=i("64328bb588b46459132d"),s=i("56e93fab5efcffbf24fb"),a=i("e88a8106e72c3f2e7fd4"),o=i("2a5dd11255f151c25fd3"),c=i("e4015b2ea28f962ed7da"),u=function(){function t(e){this.maxQueueLength=e,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:t.QUEUE_CAPACITY}return t.prototype.setQueueCapacity=function(t){t<1||this.queueCapacity===t||(this.queueCapacity=t,this.diagnosticEvents.length>t&&(this.diagnosticEvents=this.diagnosticEvents.slice(this.diagnosticEvents.length-t)))},t.prototype.getEvents=function(){return this.diagnosticEvents},t.prototype.enqueueEvent=function(t){this.diagnosticEvents.length<this.queueCapacity?this.diagnosticEvents.push(t):(this.dequeueEvent(),this.diagnosticEvents.push(t))},t.prototype.enqueueEvents=function(t){var e=this;t&&t.length>0&&t.forEach(function(t){e.enqueueEvent(t)})},t.prototype.flush=function(){this.diagnosticEvents=[]},t.prototype.dequeueEvent=function(){return this.diagnosticEvents.shift()},t.QUEUE_CAPACITY=1e3,t}(),p=i("4044e44e608d1baef794"),h=i("e0ae79cd8630f9b39623"),l=i("4df2f88bb138194c8ced"),f=function(){function t(e,i,n,s){var a=this;this.opener=e,this.setTimeoutCallback=i,this.clearTimeoutCallback=n,this.diagnosticsEventsBuffer=[],this.report=function(){if(a.diagnosticsEventsBuffer.length>0)try{a.opener.postMessage(l.a.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:Object(r.__spreadArrays)(a.diagnosticsEventsBuffer)})}catch(t){console.error("DiagnosticsBackupService failed to send a message")}a.reset()},this.backupTimeoutMs=s&&s>0?s:t.DefaultBackupTimeoutMs,this.reset()}return t.prototype.pushDiagnosticsEvent=function(e){e&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(e)),this.diagnosticsEventsBuffer.length===t.BufferCapacity&&this.report())},t.prototype.dispose=function(){this.report(),this.stopTimer()},t.prototype.reset=function(){this.diagnosticsEventsBuffer=[],this.stopTimer(),this.startTimer()},t.prototype.stopTimer=function(){this.backupTimer&&(this.clearTimeoutCallback(this.backupTimer),this.backupTimer=void 0)},t.prototype.startTimer=function(){this.backupTimer=this.setTimeoutCallback(this.report,this.backupTimeoutMs)},t.prototype.stringifyEvent=function(t){return Object(h.b)("{0} {1}\t{2}\r\n",[t.timeStamp,t.levelName.slice(0,3),t.message])},t.BufferCapacity=50,t.DefaultBackupTimeoutMs=100,t}(),m=i("94a755535d135f12850c");i.d(e,"a",function(){return d});var g=function(){function t(t){this.diagnosticsInstances=new Map,this.diagnosticsBackupEnabled=!1,this.diagnosticsEventComparer=function(t,e){return t.timeStamp>e.timeStamp?1:t.timeStamp<e.timeStamp?-1:0},this.telemetryEvents=new Map,this.diagnosticsEvents=new u,this.scriptStepWhiteList=new Set([c.b.DownloadScripts,c.b.DownloadMainJs]),this.eventWhiteList=new Set([c.a.AppStart,c.a.ChatSendMessage,c.a.RenderChatList,c.a.RenderComposeChat,c.a.RenderShareForm,c.a.SubmitShareForm]),this.environmentDependencies=t,this.storageKey="persistedDiagnostics",this.loadPersistedDiagnostics(!0),this.diagnosticsBackupService=void 0}return t.prototype.updateSettings=function(t){var e=t.get(s.a.Diagnostics),i=e.enableDiagnosticsBackup,n=e.diagnosticsBackupSyncCycleMs,r=e.diagnosticsEventQueueMaxSize;this.setDiagnosticsBackupEnabled(!!i,n||void 0),Object(m.isNumber)(r)&&this.diagnosticsEvents.setQueueCapacity(r)},t.prototype.pushTelemetryEvent=function(e,i){if(this.eventWhiteList.has(i.name)){var n=i&&i.step||"",r=i&&i.elapsed||0;if(this.scriptStepWhiteList.has(n)){var s=t.extractTimeValue(i.stepDelta);this.telemetryEvents.set(n,{delta:s,name:n,telemetryType:e,step:n,elapsed:r})}else{s=t.extractTimeValue(i&&i.delta);this.telemetryEvents.set(i.name,{delta:s,name:i.name,step:n,telemetryType:e,elapsed:r})}}},t.prototype.getTelemetryEvents=function(){return Array.from(this.telemetryEvents.values())},t.prototype.pushDiagnosticsEvent=function(e,i){i.length>t.MAX_MESSAGE_SIZE&&(i=i.substring(0,t.MAX_MESSAGE_SIZE)+t.longMessageEndingPattern);var n={message:i=Object(h.c)(i),level:e,levelName:a.e[e],timeStamp:new Date};this.diagnosticsEvents.enqueueEvent(n),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(n)},t.prototype.getDiagnosticsEvents=function(t){var e=t&&Math.floor(t/(1+this.diagnosticsInstances.size)),i=[];try{i=this.getDiagnosticsInstancesEvents(e)||[]}catch(t){this.pushDiagnosticsEvent(a.e.Error,"Failed to fetch logs from diagnostic instances: "+t)}var n=[];try{if(n=this.diagnosticsEvents.getEvents()||[],t){var s=t-i.length;s>0&&s<n.length&&(n=n.slice(n.length-s))}}catch(t){this.pushDiagnosticsEvent(a.e.Error,"Failed to fetch diagnostic logs: "+t)}return Object(r.__spreadArrays)(n,i).sort(this.diagnosticsEventComparer)},t.prototype.flush=function(){this.diagnosticsEvents.flush(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.report()},t.prototype.persistDiagnostics=function(t){this.pushDiagnosticsEvent(a.e.Warn,"Persisting diagnostic events for next load. Key: "+this.storageKey),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.report(),this.environmentDependencies.localStorage.setItem(this.storageKey,JSON.stringify(this.getDiagnosticsEvents(t)))},t.prototype.loadPersistedDiagnostics=function(t){void 0===t&&(t=!0);var e=this.environmentDependencies.localStorage,i=e.getItem(this.storageKey);if(i){var n=void 0;try{n=JSON.parse(i),Array.isArray(n)&&n.length>0&&this.diagnosticsEvents.enqueueEvents(n),t&&e.removeItem(this.storageKey)}catch(t){this.pushDiagnosticsEvent(a.e.Error,"Failed to load persisted logs from store with error: "+t),e.removeItem(this.storageKey)}}},t.prototype.registerDiagnosticsInstance=function(t,e){this.diagnosticsInstances.set(t,e)},t.prototype.unregisterDiagnosticsInstance=function(t){this.diagnosticsInstances.delete(t)},t.prototype.setDiagnosticsBackupEnabled=function(t,e){void 0===t&&(t=!1),this.diagnosticsBackupEnabled=t,t?!this.diagnosticsBackupService&&this.environmentDependencies.opener&&this.environmentDependencies.setTimeout&&this.environmentDependencies.clearTimeout&&(this.diagnosticsBackupService=new f(this.environmentDependencies.opener,this.environmentDependencies.setTimeout,this.environmentDependencies.clearTimeout,e)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)},t.prototype.getDiagnosticsInstancesEvents=function(t){var e,i=this,n=Array.from(this.diagnosticsInstances.keys());return!n||n.length<1?[]:n.reduce(function(n,s){if(!(e=i.diagnosticsInstances.get(s)))return n;try{var o=e.getDiagnosticsEvents()||[];return t&&t<o.length&&(o=o.sort(i.diagnosticsEventComparer).slice(o.length-t)),Object(r.__spreadArrays)(n,o)}catch(t){return i.pushDiagnosticsEvent(a.e.Error,"Error in collecting diagnostics events from "+s+": "+t),n}},[])},t.extractTimeValue=function(t){return Math.round(parseFloat(t||"0"))},t.MAX_MESSAGE_SIZE=512,t.longMessageEndingPattern="...",t}(),d=function(){if(!n){var t=void 0;try{t=Object(p.a)()}catch(i){t={getHostedWindowContext:function(){return{panelContext:o.a.worker,startReason:o.b.userInitiated}},localStorage:{getItem:function(t){var i=e.get(t);return void 0===i?null:i},clear:function(){return e.clear()},key:function(t){return Array.from(e.keys())[t]},length:(e=new Map).size,removeItem:function(t){return e.delete(t)},setItem:function(t,i){return e.set(t,i)}}}}n=new g(t)}var e;return n}}}]);