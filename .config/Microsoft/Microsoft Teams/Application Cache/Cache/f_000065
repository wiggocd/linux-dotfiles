webpackJsonp([23],{2371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2372),n(2375),n(2377),n(2379),n(120)},2372:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(76),o=n(2373),r=n(2374),a=function(e){function t(t,n,i,s,o,r,a,l,c,d,u,m,p,h,v,g,f,x,C,b,w,y,k,M){var _=e.call(this,t,n,i,s,o,r,l,d,a,m,p,g,f,C,b,w,h,v,k,"inputExtensionList","inputExtensionListPickerButton",y)||this;return _.$scope=t,_.ariaLiveService=n,_.resources=i,_.constants=s,_.settingsService=o,_.eventingService=r,_.emojiEmoticonCategoryService=a,_.commandsService=l,_.inputExtensionService=c,_.loggingService=d,_.analyticsService=u,_.channelService=m,_.tenantSettingsStore=p,_.tooltipService=h,_.utilityService=v,_.sxConfig=g,_.$translate=f,_.$timeout=x,_.$q=C,_.$popover=b,_.$element=w,_.$ocLazyLoad=y,_.channelMembershipPropertiesService=k,_.localizationService=M,_.searchPreviewResults=[],_.popoverTemplateUrl="components/fun-stuff-picker/input-extension-list.html",_}return i(t,e),t.$inject=["$scope","ariaLiveService","resources","constants","settingsService","eventingService","emojiEmoticonCategoryService","commandsService","inputExtensionService","loggingService","analyticsService","channelService","tenantSettingsStore","tooltipService","utilityService","sxConfig","$translate","$timeout","$q","$popover","$element","$ocLazyLoad","channelMembershipPropertiesService","localizationService"],t.prototype.customLoadPopoverAssets=function(){this.searchPreviewResults=[],this.viewModel=new s.InputExtensionViewModel(this.inputExtension,this.skypeConversationId,this.newMessageControllerObjId,this.inputExtensionService,this.utilityService,this.eventingService,this.constants,this.$q,this.loggingService,this.analyticsService,this.$translate,this.resources,this.ariaLiveService,this.localizationService,this.settingsService)},t}(teamspace.components.BaseInputExtension);t.InputExtensionListController=a,angular.module("teamspace.inputExtensionList",["focusOn","teamspace.localizationService"]).directive("inputExtensionList",[function(){return{restrict:"E",scope:{ctrlid:"@"},transclude:!0,bindToController:{messageType:"=?",avoidScreenEdge:"<?",skypeConversationId:"=?",teamName:"=?",inputExtension:"=?"},controllerAs:"listCtrl",templateUrl:"components/fun-stuff-picker/input-extension-list-button.html",controller:a}}]).run(["$templateCache",function(e){e.put("components/fun-stuff-picker/input-extension-list.html",o),e.put("components/fun-stuff-picker/input-extension-list-button.html",r)}])},2373:function(e,t){e.exports='<div class="popover list-input-extension-popover input-extension-popover top">\n  <div class="loading" ng-if="listCtrl.loading">\n    <div translate-once="{{::$root.resources.strings.funStuffPicker_loadingDataLabel}}"></div>\n    <busy-animation></busy-animation>\n  </div>\n  <div class="fun-stuff-content" ng-if="!listCtrl.loading" ng-mousedown="listCtrl.clearBanner()" acc-role="dialog">\n    <input-extension-search-list view-model="listCtrl.viewModel"></input-extension-search-list>\n  </div>\n</div>'},2374:function(e,t){e.exports='\x3c!-- We need the high padding to prevent the popover overlaying on new-message area on non-expanded state.--\x3e\n<button type="button" class="ts-sym pull-right icons-emoji app-icons-fill-hover shortcuts-funstuff" data-template-url="components/fun-stuff-picker/input-extension-list.html" ng-click="listCtrl.loadPopoverAssets()" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.composeOpenFunPicker}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.composeMsg}}" track-name="{{::$root.trackConstants.trackModuleName.funStuffPicker}}" track-type="{{::$root.trackConstants.trackType.compose}}" track-summary="list picker" data-prevent-refocus="true" ts-event-class="{ \'tooltip.show\': \'selected\', \'tooltip.hide\': \'-selected\' }" data-tid="listPickerButton">\n  <ng-transclude></ng-transclude>\n</button>\n'},2375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(120),s=n(2376),o=n(22),r=n(249),a=function(){function e(t,n,i,s,o,r,a,l,c){var d=this;this.$scope=t,this.constants=n,this.eventingService=i,this.utilityService=s,this.resources=o,this.loggingService=r,this.analyticsService=a,this.$popover=l,this.$timeout=c,this.currentViewModelIndex=0,this.debouncedSearchTextChanged=_.debounce(function(){d.executeCommandRequest()},e.debounceSearchWaitTime),this.viewModel&&!this.viewModel.useExternalInputSource&&this.loadDefaultItems(),this.viewModel&&this.viewModel.inputExtensionItem&&this.viewModel.inputExtensionItem.commands&&this.viewModel.inputExtensionItem.commands.length>0&&(this.selectedCommandId=this.viewModel.inputExtensionItem.commands[this.currentViewModelIndex].id),this.initialRunHasBeenRun=!1}return e.$inject=["$scope","constants","eventingService","utilityService","resources","loggingService","analyticsService","$popover","$timeout"],Object.defineProperty(e.prototype,"viewModel",{get:function(){return this.viewModels[this.currentViewModelIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noInitialRunLoading",{get:function(){return this.viewModel&&(this.viewModel.noInitialRunLoadingText||this.initialRunHasBeenRun)},enumerable:!0,configurable:!0}),e.prototype.handleSearchKeyPress=function(e){e.which===this.constants.keyCodes.enter&&this.executeCommandRequest()},e.prototype.searchTextChanged=function(){this.debouncedSearchTextChanged()},e.prototype.onItemClicked=function(e,t){this.viewModel&&this.viewModel.itemSelected(e);var n=this.viewModel.inputExtensionItem.externalId?"<retracted_sideloaded_or_custombot>":this.viewModel.inputExtensionItem.name;o.ComposeExtensionTelemetryHelper.logTelemetryForInputExtensionResult(this.loggingService,this.analyticsService,"selectComposeBoxSearchResult",this.viewModel.inputExtensionItem.appId,n,t)},e.prototype.loadDefaultItems=function(){var e=this;this.viewModel&&this.viewModel.loadDefaultItems().finally(function(){return e.initialRunHasBeenRun=!0})},e.prototype.onSearchListClicked=function(){this.eventingService.$emit(this.constants.events.inputExtension.dismissContextMenu)},e.prototype.executeCommandRequest=function(){this.viewModel&&this.viewModel.executeCommand()},e.prototype.loadMore=function(){this.viewModel&&this.viewModel.loadMore()},e.prototype.onCommandTabClicked=function(e){this.selectedCommandId=e,this.currentViewModelIndex=_.findIndex(this.viewModels,function(t){return t.currentCommandId===e}),this.viewModel.onCommandExecuted()},Object.defineProperty(e.prototype,"createDropdown",{get:function(){return this.createDropdownHelper||(this.createDropdownHelper=new i.InputExtensionCreateDropdown(this.$scope,this.constants,this.eventingService,this.$popover,this.$timeout)),this.createDropdownHelper},enumerable:!0,configurable:!0}),e.prototype.onCreateCommandDropdown=function(){this.createDropdown.show($(event.currentTarget),"right","input-extensions-create-dropdown-right")},e.debounceSearchWaitTime=500,e}();t.InputExtensionSearchListController=a,angular.module("teamspace.inputExtensionSearchList",["focusOn"]).directive("inputExtensionSearchList",[function(){return{restrict:"E",scope:!0,bindToController:{viewModels:"=",isTooltipVisible:"=",selectedItem:"="},controllerAs:"searchCtrl",templateUrl:"components/fun-stuff-picker/input-extension-search-list.html",controller:a}}]).run(["$templateCache",function(e){e.put("components/fun-stuff-picker/input-extension-search-list.html",s),e.put(i.InputExtensionCreateDropdown.createDropdownTempalte,r)}])},2376:function(e,t){e.exports='<div class="search-list-input-extension-popover input-extension-popover top normal-space" data-tid="composeExtensionSearchList" acc-role="tab-handler-input-extension-search-list" ng-click="searchCtrl.onSearchListClicked()">\n  <div ng-if="!searchCtrl.viewModel.useExternalInputSource">\n      <div class="branded-search-box">\n          <div class="image-container" ng-style="{ \'background\': searchCtrl.viewModel.inputExtensionItem.accentColor }">\n            <ng-include src="::searchCtrl.viewModel.inputExtensionItem.imageUrl" ng-if="::searchCtrl.utilityService.useNgIncludeForIcon(searchCtrl.viewModel.inputExtensionItem.imageUrl)"></ng-include>\n            <img ng-src="{{::searchCtrl.viewModel.inputExtensionItem.imageUrl}}" ng-if="::!searchCtrl.utilityService.useNgIncludeForIcon(searchCtrl.viewModel.inputExtensionItem.imageUrl)"/>\n          </div>\n          <span class="input-extensions-branded-search-name" ng-bind="searchCtrl.viewModel.inputExtensionItem.name"></span>\n          <button ng-if="ctrl.createViewModels.length > 0" type="button" title="{{::$root.resources.strings.inputExtension_action_tooltip|translate}}" class="ts-sym app-icons-fill-hover input-extensions-create-button" id="compose-extension-create-button" data-tid="composeExtensionCreateButton" ng-click="searchCtrl.onCreateCommandDropdown()" aria-haspopup="true" aria-label="{{::$root.resources.strings.inputExtension_create_more_commands |translate}}">\n            <ng-include src="\'svg/icons-add.html\'"></ng-include>\n          </button>\n        </div>\n\n        <div class="branded-search-input">\n          <input sanitized type="search" class="form-control input-extension-search-box ts-header-search" id="compose-search-list-input" ng-model="searchCtrl.viewModel.searchText" ng-model-options="{ updateOn: \'keyup\'}" translate-once="{{::$root.resources.strings.funStuffPicker_search_placeholderText}}" set-focus="searchCtrl.isTooltipVisible" ng-keypress="searchCtrl.handleSearchKeyPress($event)" data-tid="composeSearchListInput" ng-change="searchCtrl.searchTextChanged()" placeholder="{{searchCtrl.viewModel.currentParameterDesscription}}"/>\n          <ng-include src="\'svg/icons-search.html\'"></ng-include>\n        </div>\n        <input-extensions-command-tab ng-if="searchCtrl.viewModels.length > 1" selected-command-id="searchCtrl.selectedCommandId" selected-item="searchCtrl.selectedItem" on-command-tab-clicked-callback="searchCtrl.onCommandTabClicked($id)"></input-extensions-command-tab>\n  </div>\n\n  <div class="input-extension-scroll-search-results" ng-if="!searchCtrl.viewModel.openUrl && !searchCtrl.viewModel.responseText && searchCtrl.viewModel.responseErrorCode === 0" easy-scrollbar=".scroll-wrapper" on-edge-callback="searchCtrl.loadMore()" ng-class="{\'list-scroll-search-results-no-input-box\': searchCtrl.viewModel.useExternalInputSource}">\n    <div class="scroll-wrapper">\n      <div class="search-list-content" ng-if="searchCtrl.viewModel.searchText || searchCtrl.viewModel.initialRun" ng-switch on="searchCtrl.viewModel.layout">\n        <ul class="input-extension-tile search-list-list-tile" acc-role="sub-menu" ng-switch-when="list">\n          <li class="input-extension-item" ng-repeat="item in searchCtrl.viewModel.previewResults track by item.cardClientId" ng-class="{\'ts-selectedRow\': $index === searchCtrl.viewModel.currentIndex}" ng-mouseenter="searchCtrl.viewModel.hoverRow($index)">\n            <div class="left-rail-item left-rail-item-hover input-extension-search-pane" id="compose-search-list-items" ng-click="searchCtrl.onItemClicked(item, ctrl.teamId); $hide()" data-tid="composeSearchListItems" acc-role="sub-menu-item" track-click-silent="true">\n              <hero-card card="item"></hero-card>\n            </div>\n          </li>\n        </ul>\n        <ul class="input-extension-tile search-list-grid-tile" acc-role="listgrid-horizontal" ng-switch-when="grid">\n          <li ng-repeat="item in searchCtrl.viewModel.previewResults track by item.cardClientId" ng-class="{\'ts-selectedRow\': $index === searchCtrl.viewModel.currentIndex}" ng-mouseenter="searchCtrl.viewModel.hoverRow($index)" ng-click="searchCtrl.onItemClicked(item, ctrl.teamId); $hide()" track-click-silent="true">\n              <div acc-role="listgrid-item" data-tid="composeSearchListItems" aria-label="{{::item.arialLabelTitle}}" tabindex="-1">\n                <img ng-src="{{::item.heroImageSrc}}" alt="{{::item.title}}" title="{{::item.title}}"/>\n              </div>\n            </li>\n          </ul>\n          <div ng-if="searchCtrl.viewModel.displayNoResults" class="center-container" translate-once="{{::$root.resources.strings.funStuffPicker_search_noResults}}">\n          </div>\n        </div>\n      </div>\n    <div ng-if="searchCtrl.viewModel.isLoading" class="center-progress-spinner">\n      <div ng-class="{ \'bottom-container\': searchCtrl.viewModel.isLoadingMore,\n          \'center-container\': !searchCtrl.viewModel.isLoadingMore,\n          \'extra-padding-multi-command\': searchCtrl.viewModels.length > 1}">\n        <busy-animation size="medium"></busy-animation>\n        <p ng-if="!searchCtrl.noInitialRunLoading" translate-once="{{::$root.resources.strings.inputExtension_initialRun_progress}}" translate-values="{appName: searchCtrl.viewModel.inputExtensionItem.name}"></p>\n      </div>\n    </div>\n    <div ng-if="searchCtrl.viewModel.showDescription" class="bottom-container">\n      <span>{{searchCtrl.viewModel.currentCommandDesscription}}</span>\n    </div>\n  </div>\n\n  <div ng-if="!searchCtrl.viewModel.openUrl && searchCtrl.viewModel.responseText && searchCtrl.viewModel.responseErrorCode === 0" class="center-container">\n    {{searchCtrl.viewModel.responseText}}\n  </div>\n\n  <div ng-if="searchCtrl.viewModel.responseErrorCode === 1" class="center-container">\n    <span class="link-text" translate-with-html-params translate-id="inputExtension_invoke_failure_bots" translate-values=\'{"linkText": "<br/> <a tabindex=\\"1\\" id=\\"compose-extension-retry\\" data-tid=\\"composeExtensionRetry\\" set-focus=\\"true\\" ng-click=\\"searchCtrl.viewModel.retryExecuteCommand()\\" translate-once=\\"{{searchCtrl.resources.strings.inputExtension_retry_link_text}}\\" title=\\"{{searchCtrl.viewModel.retryErrorLabel}}\\" aria-label=\\"{{searchCtrl.viewModel.retryErrorLabel}}\\"></a>"}\'></span>\n  </div>\n\n  <div ng-if="searchCtrl.viewModel.responseErrorCode === 3" class="center-container">\n    <span class="link-text" translate-with-html-params translate-id="inputExtension_invoke_failure_nonbots" translate-values=\'{"linkText": "<br/> <a tabindex=\\"1\\" id=\\"compose-extension-retry\\" data-tid=\\"composeExtensionRetry\\" set-focus=\\"true\\" ng-click=\\"searchCtrl.viewModel.retryExecuteCommand()\\" translate-once=\\"{{searchCtrl.resources.strings.inputExtension_retry_link_text}}\\" title=\\"{{searchCtrl.viewModel.retryErrorLabel}}\\" aria-label=\\"{{searchCtrl.viewModel.retryErrorLabel}}\\"></a>"}\'></span>\n  </div>\n\n  <div ng-if="searchCtrl.viewModel.openUrl && searchCtrl.viewModel.responseErrorCode === 0" class="input-extension-openUrl">\n    <div class="input-extension-openUrl-title">\n      <img ng-if="searchCtrl.viewModel.useExternalInputSource" class="media-object" ng-style="{ \'background\': searchCtrl.viewModel.inputExtensionItem.accentColor }" ng-src="{{searchCtrl.viewModel.inputExtensionItem.imageUrl}}"/>\n      <div ng-class="{\'text-search\': searchCtrl.viewModel.useExternalInputSource}">\n        <span class="input-extension-openUrl-text app-max-2-lines-base">{{searchCtrl.viewModel.openUrlTitle}}</span>\n      </div>\n    </div>\n    <span class="input-extension-openUrl-text" ng-if="searchCtrl.viewModel.openUrlLinkAuthType || searchCtrl.viewModel.openUrlLinkSilentAuthType" translate-with-html-params translate-id="inputExtension_auth_description" translate-values=\'{"appName": "{{searchCtrl.viewModel.inputExtensionItem.name}}", "linkText": "<a tabindex=\\"1\\" id=\\"compose-extension-auth\\" data-tid=\\"composeExtensionAuth\\" set-focus=\\"true\\" ng-click=\\"searchCtrl.viewModel.launchWebFlow(searchCtrl.$scope, $event)\\" translate-once=\\"{{searchCtrl.resources.strings.inputExtension_auth_link_text}}\\" title=\\"{{::$root.resources.strings.inputExtension_auth_link_ariaLabel|translate}}\\" aria-label=\\"{{::$root.resources.strings.inputExtension_auth_link_ariaLabel|translate}}\\"></a>"}\'></span>\n    <span class="input-extension-openUrl-text" ng-if="!searchCtrl.viewModel.openUrlLinkAuthType && !searchCtrl.viewModel.openUrlLinkSilentAuthType" translate-with-html-params translate-id="inputExtension_config_description" translate-values=\'{"appName": "{{searchCtrl.viewModel.inputExtensionItem.name}}", "linkText": "<a tabindex=\\"1\\" id=\\"compose-extension-config\\" data-tid=\\"composeExtensionConfig\\" set-focus=\\"true\\" ng-click=\\"searchCtrl.viewModel.launchWebFlow(searchCtrl.$scope, $event)\\" translate-once=\\"{{searchCtrl.resources.strings.inputExtension_config_link_text}}\\" title=\\"{{::$root.resources.strings.inputExtension_config_link_ariaLabel|translate}}\\" aria-label=\\"{{::$root.resources.strings.inputExtension_config_link_ariaLabel|translate}}\\"></a>"}\'></span>\n    <span class="errorText input-extension-openUrl-text" ng-if="searchCtrl.viewModel.openUrlError" translate-once="{{::searchCtrl.resources.strings.inputExtension_auth_error}}"></span>\n  </div>\n</div>'},2377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2378);angular.module("teamspace.inputExtensionsFlyoutList",["focusOn"]).directive("inputExtensionsFlyoutList",[function(){return{restrict:"E",scope:{extensions:"=",selectorController:"=",isSuggested:"@?",listLayout:"@?"},templateUrl:"components/fun-stuff-picker/input-extensions-flyout-list.html"}}]).run(["$templateCache",function(e){e.put("components/fun-stuff-picker/input-extensions-flyout-list.html",i)}])},2378:function(e,t){e.exports='<ul class="input-extension-tile" ng-class="{\'input-extensions-flyout-list-v2\': selectorController.enableMessagingExtensionFlyoutV2}" acc-role="listgrid-horizontal-and-vertical" aria-label="{{::selectorController.announceCategory(isSuggested)}}" role="listbox">\n  <li class="input-extension-item" ng-if="!selectorController.enableMessagingExtensionFlyoutV2" ng-repeat="item in extensions track by $index">\n\n    <a class="left-rail-item left-rail-item-hover input-extension-search-pane" acc-role="menu-item focus-default tab-handler-input-extension-selector-list" aria-label="{{isSuggested ? ($root.resources.strings.inputExtension_suggested_section_title|translate) + \' \' : \'\'}}{{item.name + \' \' + item.description + \' \' + ($root.resources.strings.inputExtension_additional_info|translate)}}" data-tid="composeItems" ng-click="selectorController.onInputExtensionClicked($event, item, false)" ts-right-click="selectorController.contextMenuHandler($event, this, item)" ng-keydown="selectorController.handleMenuKeyDown($event, this, item)" track-click-silent="true" do-not-decorate-click-for-acc>\n      <div class="image-container" ng-style="{ \'background\': item.accentColor }">\n        <ng-include src="item.imageUrl" ng-if="::selectorController.utilityService.useNgIncludeForIcon(item.imageUrl)"></ng-include>\n        <img alt="{{::($root.resources.strings.extensibility_app_icon_alt|translate:{appName:item.name})}}" fallback-src="{{::selectorController.appFallbackIcon}}" ng-src="{{item.imageUrl}}" ng-if="::!selectorController.utilityService.useNgIncludeForIcon(item.imageUrl)"/>\n      </div>\n      <div ng-class="{\'text-search\': true, \'featured-text\': item.isFeatured}">\n        <span class="input-extension-name" title="{{item.name}}">{{item.name}}\n          <new-tab-badge ng-if="item.isNewToUser"></new-tab-badge>\n        </span>\n        <span class="input-extension-description" title="{{item.description}}">{{item.description}}</span>\n      </div>\n      <input-extensions-settings ng-if="selectorController.enablePinningComposeExtensions" skype-conversation-id="selectorController.skypeConversationId" input-extension-item="item" team-id="selectorController.teamId" class="show-context-menu-on-hover"></input-extensions-settings>\n    </a>\n  </li>\n\n  <li class="input-extension-item" ng-class="{\'v2-active\': selectorController.searchResultFocusIndex === $index}" ng-if="selectorController.enableMessagingExtensionFlyoutV2 && listLayout" ng-repeat="item in extensions track by $index">\n\n    <a class="left-rail-item left-rail-item-hover input-extension-search-pane" acc-role="menu-item focus-default tab-handler-input-extension-selector-list" aria-label="{{isSuggested ? ($root.resources.strings.inputExtension_suggested_section_title|translate) + \' \' : \'\'}}{{item.name + \' \' + item.description + \' \' + ($root.resources.strings.inputExtension_additional_info|translate)}}" data-tid="composeItems" ng-click="selectorController.onInputExtensionClicked($event, item, false)" ng-keydown="selectorController.handleMenuKeyDown($event, this, item)" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.openApp}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.composeExtensionFlyout}}" track-type="{{::$root.trackConstants.trackType.nav}}" track-summary="{{::item.name}}" track-data="{{selectorController.getSearchAppTelemetryData(item, $index)}}" do-not-decorate-click-for-acc>\n      <div class="image-container" ng-style="{ \'background\': item.accentColor }">\n        <ng-include src="item.imageUrl" ng-if="::selectorController.utilityService.useNgIncludeForIcon(item.imageUrl)"></ng-include>\n        <img alt="{{::($root.resources.strings.extensibility_app_icon_alt|translate:{appName:item.name})}}" fallback-src="{{::selectorController.appFallbackIcon}}" ng-src="{{item.imageUrl}}" ng-if="::!selectorController.utilityService.useNgIncludeForIcon(item.imageUrl)"/>\n      </div>\n      <div class="text-search">\n        <span class="input-extension-name" title="{{item.name}}">{{item.name}}\n        </span>\n        <span class="input-extension-description" title="{{item.description}}">{{item.description}}</span>\n      </div>\n    </a>\n  </li>\n\n  <li class="input-extension-item grid-item" ng-if="selectorController.enableMessagingExtensionFlyoutV2 && !listLayout" ng-repeat="item in extensions track by $index" ng-class="{\'input-extensions-selector-v2\': selectorController.enableMessagingExtensionFlyoutV2}" ng-click="selectorController.onInputExtensionClicked($event, item, false)" acc-role="listgrid-item" role="option" aria-label="{{($root.resources.strings.extensibility_aria_label_more_options|translate:{appName:item.name})}}" ts-right-click="selectorController.contextMenuHandler($event, this, item)">\n    <div class="app-grid-item-container">\n      <div class="app-icon" title="{{::item.name}}" ng-style="{ \'background\': item.accentColor }">\n        <div class="new-app-flyout-badge" ng-if="item.isNewToUser">\n          {{::$root.resources.strings.tabs_newBadge|translate}}\n        </div>\n        <ng-include src="item.imageUrl" ng-if="::selectorController.utilityService.useNgIncludeForIcon(item.imageUrl)"></ng-include>\n        <img role="img" alt="{{::($root.resources.strings.extensibility_app_icon_alt|translate:{appName:item.name})}}" aria-label="{{::($root.resources.strings.extensibility_app_icon_alt|translate:{appName:item.name})}}" fallback-src="{{::selectorController.appFallbackIcon}}" ng-src="{{item.imageUrl}}"/>\n      </div>\n      <div dir="auto" id="apps-flyout-name-{{::item.name}}" class="app-name">\n        {{item.name}}\n      </div>\n    </div>\n  </li>\n</ul>'},2379:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2380),s=n(2381),o=n(22),r=function(){return function(e,t){this.title=t,this.id=e,this.isSelected=!1,this.isOverflow=!1}}();t.InputExtensionCommand=r;var a=3,l=function(){function e(e,t,n,i,s,o,l,c,d){var u=this;this.$scope=e,this.constants=t,this.utilityService=n,this.loggingService=i,this.eventingService=s,this.resources=o,this.$popover=l,this.$timeout=c,this.analyticsService=d,this.visibleCommands=[],this.overflowCommands=[],this.commands=[],this.commands=_.map(_.filter(this.selectedItem.commands,function(e){return e.type!==t.inputExtensionConstants.createCommandType}),function(e){return new r(e.id,e.title)});var m;_.each(this.commands,function(e,t){e.isSelected=e.id===u.selectedCommandId,e.isSelected&&(m=e),e.isOverflow=t>=a}),this.recalculateTabs(m),s.$on(e,t.events.inputExtension.dismissContextMenu,function(e,t){u.dismissPopover()})}return e.$inject=["$scope","constants","utilityService","loggingService","eventingService","resources","$popover","$timeout","analyticsService"],e.prototype.onCommandTabClicked=function(e){if(this.selectedCommandId!==e.id){_.find(this.commands,function(e){return e.isSelected}).isSelected=!1,this.selectedCommandId=e.id,e.isSelected=!0,this.recalculateTabs(e),this.$scope.onCommandTabClickedCallback({$id:e.id}),this.dismissPopover();var t=this.selectedItem.externalId?"<retracted_sideloaded_or_custombot>":this.selectedItem.name;o.ComposeExtensionTelemetryHelper.logTelemetryForInputExtensionQueryCommandClickAction(this.loggingService,this.analyticsService,this.selectedItem.appId,t,e.title,teamspace.components.PanelActionScenario.composeExtentionSwitchCommand,teamspace.components.PanelModuleType.commanding)}},e.prototype.showOverflowCommands=function(e){var t=this,n=$(e.currentTarget);n.hasClass("ts-tabs-chevron")&&(n=n.parent()),this.popover||(this.popover=this.$popover(n,{animation:"",contentTemplate:"components/fun-stuff-picker/input-extensions-command-tab-dropdown.html",container:"body",customClass:"input-extensions-command-overflow",target:n,trigger:"manual",placement:"bottom",scope:this.$scope,autoClose:!0,prefixEvent:"input-extension-command-tab"})),this.$timeout(function(){t.popover.toggle()},0,!1)},e.prototype.dismissPopover=function(){this.popover&&this.popover.hide()},e.prototype.handleMenuKeyDown=function(e){e.stopPropagation(),e.which===this.constants.keyCodes.escape&&this.dismissPopover()},e.prototype.recalculateTabs=function(e){if(this.updateVisiableAndOverflowCommands(),e.isOverflow){var t=this.visibleCommands[this.visibleCommands.length-1];this.visibleCommands.splice(this.visibleCommands.length-1,1,e),_.remove(this.overflowCommands,function(t){return t.id===e.id}),this.overflowCommands.splice(0,0,t)}},e.prototype.updateVisiableAndOverflowCommands=function(){this.commands.length>a?(this.visibleCommands=this.commands.slice(0,a),this.overflowCommands=this.commands.slice(a,this.commands.length)):(this.visibleCommands=this.commands,this.overflowCommands=[])},e}();t.InputExtensionsCommandTabController=l,angular.module("teamspace.inputExtensionsCommandTab",["focusOn"]).directive("inputExtensionsCommandTab",[function(){return{restrict:"E",scope:{onCommandTabClickedCallback:"&"},bindToController:{selectedItem:"=",selectedCommandId:"="},controllerAs:"ctrl",templateUrl:"components/fun-stuff-picker/input-extensions-command-tab.html",controller:l}}]).run(["$templateCache",function(e){e.put("components/fun-stuff-picker/input-extensions-command-tab.html",i),e.put("components/fun-stuff-picker/input-extensions-command-tab-dropdown.html",s)}])},2380:function(e,t){e.exports='<ul class="input-extension-command-tab" acc-role="sub-menu">\n  <li class="input-extension-command-tab-item" title="{{command.title}}" ng-repeat="command in ctrl.visibleCommands track by $index" role="none">\n    <button class="btn btn-default" id="compose-extension-command-tab" data-tid="composeExtensionCommandTab" ng-class="{\'tabs-selected\': command.id === ctrl.selectedCommandId}" ng-bind="command.title" ng-click="ctrl.onCommandTabClicked(command)" acc-role="sub-menu-item"></button>\n  </li>\n  <li class="input-extension-command-tab-item input-extension-command-tab-overflow" ng-if="ctrl.overflowCommands.length > 0" aria-label="{{ctrl.overflowCommands.length == 1 ? ($root.resources.strings.channel_moreTabsButton_singular_aria|translate:{num:ctrl.overflowCommands.length}) : ($root.resources.strings.channel_moreTabsButton_plural_aria|translate:{num:ctrl.overflowCommands.length}) }}" role="none">\n    <button class="btn btn-default btn-overflow" id="compose-extension-command-tab" acc-role="sub-menu-item" ng-bind="ctrl.overflowCommands.length == 1 ? ($root.resources.strings.channel_moreTabsButton_singular|translate:{num:ctrl.overflowCommands.length}) : ($root.resources.strings.channel_moreTabsButton_plural|translate:{num:ctrl.overflowCommands.length})" ng-click="ctrl.showOverflowCommands($event)">\n    </button>\n    <button type="button" class="ts-sym ts-svg-small icons-more app-icons-fill-hover" ng-click="ctrl.showOverflowCommands($event)">\n      <ng-include src="\'svg/icons-chevron-right.html\'"></ng-include>\n    </button>\n  </li>\n</ul>'},2381:function(e,t){e.exports='<div class="input-extensions-command-overflow-popover app-default-menu" role="application" ng-keydown="ctrl.handleMenuKeyDown($event);">\n  <ul acc-role="sub-menu" class="command-list left-rail-item">\n    <li class="command-item actions-menu-border" ng-repeat="command in ctrl.overflowCommands" title="{{command.title}}" acc-role="sub-menu-item focus-default">\n      <button acc-focus-default class="ts-sym has-icon actions-menu-border" ng-click="ctrl.onCommandTabClicked(command);$event.stopPropagation();">\n        <span class="popover-label">{{command.title}}</span>\n      </button>\n    </li>\n  </ul>\n</div>'}},[2371]);