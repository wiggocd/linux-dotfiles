(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[49],{"348426a60b7cb4dbeb31":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("11e808f62b4fe6e70870"),a=i("d200c08d057f868315fd"),r=i("5f0dbee501b8046e840c"),s=i("2118c0654cdae82c146d"),o=function(){function e(){var e=this;this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=function(){return e.telemetryProvider.flush()},this.telemetryProvider=Object(n.b)(),Object(a.a)(function(){e.initialized=!1,e.eventDecoratorCallbacks=[]})}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.telemetryProvider.sessionId},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e,t,i){this.initialized||(this.consoleLogger=t,this.consoleLogger.debug("TelemetrySender initialized."),s.a.getInstance().initialize(i),this.telemetryProvider.initialize(e,this.consoleLogger),this._tablePostfix=e.documentInfo.tablePostfix||"",this.initialized=!0)},e.getInstance=function(){return this.telemetrySender||(this.telemetrySender=new e),this.telemetrySender},e.prototype.registerEventDecorator=function(e){this.eventDecoratorCallbacks.push(e)},e.prototype.sendTelemetry=function(e,t,i,a){if(void 0===i&&(i={}),this.initialized){t=t.replace(/\-/g,"_").toLowerCase();var o=(""+r.a[e]+this._tablePostfix).toLowerCase(),c=e===r.a.Scenario?i["Scenario.Status"]:e===r.a.Http?i.resultCode:void 0,l=s.a.getInstance().getSampleRate(o,t,c);if(l!==s.b){this.decorateEvent(t,i);var p=this.telemetryProvider.createEvent(o,t,i,a);p.setProperty("sampleRate",l);var u=e===r.a.UserBI?n.a.userBi:n.a.default;this.telemetryProvider.logEvent(u,p)}}},e.prototype.decorateEvent=function(e,t){this.eventDecoratorCallbacks.forEach(function(i){return i(e,t)})},e}();function c(e,t,i,n){o.getInstance().sendTelemetry(e,t,i,n)}},"5f0dbee501b8046e840c":function(e,t,i){"use strict";var n;i.d(t,"a",function(){return n}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Tracking=3]="Tracking",e[e.Heartbeat=4]="Heartbeat",e[e.Http=5]="Http",e[e.UserBI=6]="UserBI"}(n||(n={}))},"9c09065bd76afcf0a959":function(e,t,i){"use strict";i.r(t);var n,a=i("275976081ce1abf67779"),r=i("298834ef555136219449"),s=i("c4e5d556b9dfef6082b0"),o=i("66ed9b0e2e19f957591e"),c=i("2fb8223a0230e17c2ea9"),l=i("9b08f2e86f0e0f9ec656"),p=i("a689a10faf924dde39cc"),u=i("68ad756829a3e387be42"),g=i("4240efd871ae15138fcf"),h=i("3a3917c057079b816e70"),d=i("56e93fab5efcffbf24fb"),m=i("cf694d8109b055738d55"),f=i("d3bb8f02f954659262db"),S=i("64328bb588b46459132d"),b=12e4,v={"cdl-request":!0},y=i("f9a6412761c79a080418"),C=i("348426a60b7cb4dbeb31"),T=i("e4015b2ea28f962ed7da"),E=i("5f0dbee501b8046e840c"),P=i("94a755535d135f12850c"),k="Scenario.Step",w=function(){function e(e,t,i,n,a,r,s,o,c,l,p,u,g){var h=this;void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===u&&(u=T.a.Expanded),this._id=e,this._name=t,this._eventData=i,this.scenarioFactory=n,this.logger=a,this.timeout=r,this.callback=s,this.memoryAnalyzer=o,this.enableDiagnostics=c,this.markStepsInTrace=l,this.showAllConsoleLogs=p,this.scenarioMode=u,this.reportActivity=g,this.steps=[],this.stepsEx=[],this._sequence=0,this.__stepsPerfInfo__=[],this.getTotalPauseDuration=function(){return h.pauseInfo.totalTime},this._currentStep=T.c.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0};var d=0;if(i.overrideTimestamp?(d=i.overrideTimestamp-Date.now(),i.overrideTimestamp=void 0):i.offsetCurrentTimeInMs&&(d=-i.offsetCurrentTimeInMs,i.offsetCurrentTimeInMs=void 0),this._absoluteStartTime=Date.now()+d,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp()+d,this.memoryAnalyzer){var m=this.memoryAnalyzer.snapshotMemoryUsage();m&&(this.workingSetInitial=m.workingSetKb,this.privateBytesInitial=m.privateBytesKb)}}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"absoluteStartTime",{get:function(){return this._absoluteStartTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.scenarioFactory.timestamp()-this.relativeTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return this.timeout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return this._eventData},set:function(e){this._eventData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return this._timestamps},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentStep",{get:function(){return this._currentStep},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!!this.pauseInfo.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHoisted",{get:function(){return this._isHoisted},set:function(e){this._isHoisted=e},enumerable:!0,configurable:!0}),e.prototype.appendEventData=function(e){this.eventData=Object(S.__assign)(Object(S.__assign)({},this.eventData),e)},e.prototype.markAggregateStart=function(e){this.active?(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug("Scenario '"+this.name+"' set to inactive")},e.prototype.markAggregateStop=function(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)},e.prototype.pause=function(e,t){if(this.active&&!this.isPaused){this._currentStep!==T.c.Unknown&&this.mark(this._currentStep);var i=e.reason,n=Object(S.__rest)(e,["reason"]);this.mark(T.c.Pause,Object(S.__assign)({pauseReason:i},n),void 0,t),this.pauseInfo=Object(S.__assign)(Object(S.__assign)({},this.pauseInfo),{reason:i,startTime:Date.now()})}},e.prototype.resume=function(e,t){if(this.active&&this.isPaused){var i=this.pauseInfo.startTime?Date.now()-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+i,this.mark(T.c.Resume,Object(S.__assign)(Object(S.__assign)({},e),{pauseReason:this.pauseInfo.reason}),void 0,t),this.pauseInfo.reason="",this.pauseInfo.startTime=0}},e.prototype.stop=function(e,t,i){var n=this;void 0===t&&(t="success"),this._currentStep!==T.c.Unknown&&this.mark(this._currentStep,void 0,t,i),this.aggregateStepTotalTime&&(Object(P.each)(Object.keys(this.aggregateStepTotalTime),function(e){var t=parseInt(n.aggregateStepTotalTime[e].toString(),10);n.mark(e,{stepDelta:t},void 0,i)}),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(T.c.Stop,e,t,!0,i).then(function(){n.active&&(n.active=!1),n.callback&&n.callback(t),n.scenarioFactory.clearScenario(n)})},e.prototype.fail=function(e,t){this.stop(e,"failure",t)},e.prototype.cancel=function(e,t){this.stop(e,"abandoned",t)},e.prototype.incomplete=function(e,t){this.stop(e,"incomplete",t)},e.prototype.mark=function(e,t,i,n){void 0===i&&(i="success"),this.createMark(e,t,i,!1,n),this._currentStep=T.c.Unknown},e.prototype.startStep=function(e){this._currentStep!==T.c.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e},e.prototype.prepareAndSendTelemetry=function(e,t){this.eventData&&this.eventData!==e&&(e=Object(S.__assign)(Object(S.__assign)({},this.eventData),e)),e.InstanceId=this.id,this.updateEventDataMemory(e),e=this.getEventDataWithComutedValues(e),this.enableDiagnostics&&Object(y.a)().pushTelemetryEvent(E.a[E.a.Scenario],e),e["Scenario.Mode"]=this.scenarioMode;var i=e[k];i!==T.c.Start&&(this.scenarioMode!==T.a.Expanded&&(this.packStandardAttributes(e),i===T.c.Stop&&(e["Scenario.Steps"]=JSON.stringify(this.steps),e["Scenario.StepsEx"]=JSON.stringify(this.stepsEx))),this.scenarioMode===T.a.Packed&&i!==T.c.Stop||Object(C.a)(E.a.Scenario,this.name,e,t)),this.logScenarioPerf(e)},e.prototype.logScenarioPerf=function(e){if(this.showAllConsoleLogs){var t=e[k],i=t===T.c.Start?"[step]("+this._sequence+")"+t:t===T.c.Stop?"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms/"+e.delta+"ms)":"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms)";this.logger&&this.logger.log("[Scenario]"+this.name+" "+i),this.__stepsPerfInfo__.push({name:t,stepDelta:e.stepDelta,delta:e.delta})}},e.prototype.updateEventDataMemory=function(e){if(this.memoryAnalyzer){var t=this.memoryAnalyzer.snapshotMemoryUsage();t&&(e.workingSet=t.workingSetKb,e.privateBytes=t.privateBytesKb,e.workingSetDelta=this.workingSetInitial?this.workingSetInitial-t.workingSetKb:void 0,e.privateBytesDelta=this.privateBytesInitial?this.privateBytesInitial-t.privateBytesKb:void 0)}},e.prototype.getEventDataWithComutedValues=function(e){var t,i=this.intervalTimestamp;Object(P.isNumber)(e.overrideTimestamp)?(t=this.relativeTimestamp+e.overrideTimestamp-this._absoluteStartTime,e.overrideTimestamp=void 0):e.offsetCurrentTimeInMs?(t=this.scenarioFactory.timestamp()-e.offsetCurrentTimeInMs,e.offsetCurrentTimeInMs=void 0):t=e[k]===T.c.Start?this.relativeTimestamp:this.scenarioFactory.timestamp(),this._timestamps.push(t),this.intervalTimestamp=t;var n=Object(P.isNumber)(e.stepDelta)?e.stepDelta:t-i,a=Object(P.isNumber)(e.delta)?e.delta:t-this.relativeTimestamp-this.getTotalPauseDuration(),r=Object(P.isNumber)(e.elapsed)?e.elapsed:t,s=Object(P.isNumber)(e.elapsedSinceCoreInit)?e.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),o=this._sequence,c=!!this.scenarioFactory.findScenario(T.b.WindowLaunchTime);return Object(S.__assign)(Object(S.__assign)({},e),{isInEst:c,stepDelta:n,delta:a,elapsed:r,elapsedSinceCoreInit:s,sequence:o})},e.prototype.packStandardAttributes=function(e){var t={};t["Scenario.Status"]=e["Scenario.Status"],t[k]=e[k],t.stepDelta=e.stepDelta,t.elapsed=e.elapsed,t.delta=e.delta,t.sequence=e.sequence,this.steps.push(t)},e.prototype.getMonitoringDataOverride=function(e){var t=e;return this.name!==T.b.WindowLaunchTime&&this.name!==T.b.ExperienceReady||(t=e?Object(P.cloneDeep)(e):{scenarioPriority:"P0",data:[]}).data.push({key:"App",value:this.eventData.contentSlotApp}),t},e.prototype.createMark=function(e,t,i,n,a){return void 0===t&&(t={}),Object(S.__awaiter)(this,void 0,void 0,function(){var r,s,o,c;return Object(S.__generator)(this,function(l){return e&&this.active?(e!==T.c.Stop&&e!==T.c.Start&&this.scenarioMode!==T.a.Expanded&&void 0!==t&&this.stepsEx.push(Object(P.cloneDeep)(t)),t["Scenario.Status"]=i,t[k]=e,t["Scenario.Name"]=this.name,r=this.getMonitoringDataOverride(a),performance&&performance.mark&&performance.measure&&!v.hasOwnProperty(this.name)&&(s=t[k]+" "+t["Scenario.Name"]+"-"+this.id,performance.mark(s),t[k]===T.c.Stop&&(o="start "+t["Scenario.Name"]+"-"+this.id,0===(performance.getEntriesByName(o,"mark")||[]).length&&(o="navigationStart"),c=this.clientName?" ("+this.clientName+")":"",performance.measure(""+t["Scenario.Name"]+c,o,s)),this.markStepsInTrace&&(this.previousMark&&performance.measure(t["Scenario.Name"]+" ["+this.previousMark+" <=> "+t[k]+"]",this.previousMark+" "+t["Scenario.Name"]+"-"+this.id,t[k]+" "+t["Scenario.Name"]+"-"+this.id),this.previousMark=t[k])),this.prepareAndSendTelemetry(t,r),this.active=this.active&&!n,this.reportActivity&&this.reportActivity(t),this._sequence+=1,[2]):[2]})})},e}(),D=i("3e9c7e5351d86134f5f6"),I=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"id",{get:function(){return"noop"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return{}},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHoisted",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.appendEventData=function(e){},e.prototype.pause=function(e){},e.prototype.resume=function(e){},e.prototype.cancel=function(e){},e.prototype.mark=function(e,t,i){},e.prototype.startStep=function(e){},e.prototype.stop=function(e,t){},e.prototype.fail=function(e){},e.prototype.incomplete=function(e){},e.prototype.markAggregateStart=function(e){},e.prototype.markAggregateStop=function(e){},e.prototype.getTotalPauseDuration=function(){return 0},e}(),M=function(){function e(e,t,i,n,a,r,s){var o=this;void 0===t&&(t=0),void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===a&&(a=!1),this.appStartTimestamp=t,this.enableDiagnostics=i,this.markStepsInTrace=n,this.showAllConsoleLogs=a,this.memoryAnalyzer=s,this.activeScenarios=[],this.scenarioTimeoutMs=b,this.markStep=function(e,t,i){var n=o.findScenario(e);n&&n.mark(t,i&&i.eventData,i&&i.status,i&&i.monitoringData)},this.startStep=function(e,t){var i=o.findScenario(e);i&&i.startStep(t)},this.timestamp=function(){return Date.now()-o.appStartTimestamp},this.setTimeoutCallback=(null==r?void 0:r.setTimeout)||setTimeout,this.clearTimeoutCallback=(null==r?void 0:r.clearTimeout)||clearTimeout,this.logger=e.newLogger("Telemetry"),this.logger.debug("Initialized ScenarioFactory")}return e.prototype.newScenario=function(e,t){var i=this.createScenarioWithoutStarting(e,t);return i.mark("start",void 0,void 0,t&&t.monitoringData),i},e.prototype.createScenarioWithoutStarting=function(e,t){if(void 0===t&&(t={}),0===this.appStartTimestamp)return new I(e);var i=void 0===t.captureMemoryUsage||t.captureMemoryUsage,n={};isNaN(t.startTime)||null===t.startTime||(n.overrideTimestamp=t.startTime);var a=Object(D.v4)(),r=new w(a,e,n,this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,t.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics,this.markStepsInTrace,this.showAllConsoleLogs),s=this.setupScenarioTimeout(r);return this.activeScenarios.push({scenario:r,timeoutId:s}),r},e.prototype.cancelExistingAndCreateScenario=function(e,t,i,n,a){var r=this.findScenario(e);if(r){var s=[{reason:t}];r.cancel({errors:JSON.stringify(s)})}return r=this.newScenario(e,{timeoutMs:i,callback:n,monitoringData:a})},e.prototype.stopScenarioIfActive=function(e,t,i,n){var a=this.findScenario(e);a&&a.stop(t,i,n)},e.prototype.findScenario=function(e){if(!e)return null;var t=Object(P.findLast)(this.activeScenarios,function(t){return t&&t.scenario.name===e||t.scenario.clientId===e})||null;return t?t.scenario:null},e.prototype.findScenarioByNameAndId=function(e,t){var i=Object(P.findLast)(this.activeScenarios,function(i){return i.scenario.name===e&&i.scenario.clientId===t})||null;return i?i.scenario:null},e.prototype.clearScenario=function(e){var t=Object(P.findIndex)(this.activeScenarios,function(t){return t.scenario===e});if(t>-1){var i=this.activeScenarios.splice(t,1)[0];this.clearTimeoutCallback(i.timeoutId)}},e.prototype.setContext=function(){},e.prototype.setupScenarioTimeout=function(e,t){var i=e.timeoutMs;return this.setTimeoutCallback(function(){e.stop(e.eventData,"timeout",t)},i)},e}(),A=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),O=function(e){function t(t){var i=e.call(this,t)||this;i.enableChannelFilesTabDocLibBreadcrumb=!1,i.enableMountPointRenderOption=!1,i.newKeyIdentifierFlag=!1,i.changeTheme=function(e){i.setState({currentTheme:e})},i.changeUserPref=function(e){i.setState({currentUserPref:e})};var n=h.a.getAppState().currentTheme;i.state={currentTheme:n,currentUserPref:t.getUserFileOpenPreference&&t.getUserFileOpenPreference()||o.d.Teams},i.scenario=g.a.findScenario(o.H.getTeamFilesV2),i.serviceName=o.I.teams;var a=t.analyticsService,r=t.clientDatabaseProvider,s=t.settingsService;if(i.analyticsService=a||new u.a,r&&p.a.initialize(r),s){var c=new m.a(s);l.a.initialize(c,new M(g.a));var S=c.get(d.a.Telemetry).telemetryServer;i.ariaCollectorUrl=S;var b=c.get(d.a.Metadata).ring;i.userRing=null==b?void 0:b.id;var v=new f.a(s);i.filesScenarioTimeoutInSeconds=v.filesScenarioTimeoutInSeconds,i.newKeyIdentifierFlag=v.enableNewLocalStoreKeyIdentifier,i.clientType=v.clientType,i.enableChannelFilesTabDocLibBreadcrumb=v.enableChannelFilesTabDocLibBreadcrumb||!1,i.enableMountPointRenderOption=v.enableMountPointRenderOption||!1}return i}return A(t,e),t.prototype.render=function(){return a.createElement(r.b,{currentTheme:Object(c.a)(this.state.currentTheme),analyticsService:this.analyticsService},a.createElement(r.a,{compileIntoAngular:this.props.compileIntoAngular},a.createElement(s.b,{analyticsService:this.analyticsService},this.getSharePointLayout())))},t.prototype.getSharePointLayout=function(){return a.createElement(r.e,{onCopyLink:this.props.onCopyLink,addCloudStorage:this.props.addCloudStorage,addSPCloudStorageWithPromise:this.props.addSPCloudStorageWithPromise,deleteCloudStorage:this.props.deleteCloudStorage,siteInfo:this.props.siteInfo,threadId:this.props.threadId,teamThreadId:this.props.teamThreadId,isChannelOwner:this.props.isChannelOwner,acquireToken:this.props.acquireToken,downloadFiles:this.props.downloadFiles,scenario:this.scenario,loggingPrefix:o.H.channelFilesPrefix,pinToTabAction:this.props.pinToTabAction,changeDefaultAppAction:this.props.changeDefaultAppAction,moveFiles:this.props.moveFiles,copyFiles:this.props.copyFiles,serviceName:this.serviceName,currentTheme:Object(c.a)(this.state.currentTheme),getChannelCloudStorageFolders:this.props.getChannelCloudStorageFolders,isFreemium:this.props.isFreemium,enableFilesCopyShareLink:this.props.enableFilesCopyShareLink,enableNStarViewerExpInMainWindow:this.props.enableNStarViewerExpInMainWindow,provisionSpecialDocumentLibraries:this.props.provisionSpecialDocumentLibraries,enableChannelFilesPrefetchBridge:this.props.enableChannelFilesPrefetchBridge,filesScenarioTimeoutInSeconds:this.filesScenarioTimeoutInSeconds,renderedWindowsAhead:this.props.renderedWindowsAhead,renderedWindowsBehind:this.props.renderedWindowsBehind,createFolderAndRefreshSiteUrl:this.props.createFolderAndRefreshSiteUrl,enablePromoteChannelFolder:this.props.enablePromoteChannelFolder,newLocalStorageKeyIdentifierFlag:this.newKeyIdentifierFlag,userRing:this.userRing,clientVersion:this.props.clientVersion,isDownloadBlocked:this.props.isDownloadBlocked,isEditMetadataEnabled:this.props.isEditMetadataEnabled,enableDesktopUsePluginess:this.props.enableDesktopUsePluginess,enableWindowOpenForProtocolHandlerInvocation:this.props.enableWindowOpenForProtocolHandlerInvocation,enableWebAsDefaultFileOpenPreference:this.props.enableWebAsDefaultFileOpenPreference,handleFileOpenPreferenceUpdate:this.props.handleFileOpenPreferenceUpdate,currentUserPref:this.state.currentUserPref,isFileOpenExperimentEnabled:!!this.props.isFileOpenExperimentEnabled,clientType:this.clientType,isGeneralChannel:this.props.isGeneralChannel||!1,enableChannelFilesTabDocLibBreadcrumb:this.enableChannelFilesTabDocLibBreadcrumb,enableMountPointRenderOption:this.enableMountPointRenderOption,ariaCollectorUrl:this.ariaCollectorUrl})},t}(a.Component);i.d(t,"ChannelFilesRoot",function(){return O})},cf694d8109b055738d55:function(e,t,i){"use strict";var n=i("64328bb588b46459132d"),a=i("56e93fab5efcffbf24fb"),r=i("e88a8106e72c3f2e7fd4"),s=i("2cb027059b5fbe2cc8a6"),o=i("640a68d4e52093ac8444"),c=i("6871d1ea20c032a12e30"),l=i("06c58f420a0677aad466"),p=i("d3bb8f02f954659262db"),u=i("604f694397cd1f47d3c5"),g={allowBroadcastSchedulingPolicy:"allowBroadcastSchedulingPolicy",allowChannelMeetingSchedulingPolicy:"allowChannelMeetingSchedulingPolicy",allowPrivateMeetingSchedulingPolicy:"allowPrivateMeetingSchedulingPolicy",debounceSchedulingFormPeoplePickerGuestSearchinMillis:"debounceSchedulingFormPeoplePickerGuestSearchinMillis",disableCalendarApolloResultCaching:"disableCalendarApolloResultCaching",enableAppsGalleryinMeetingChat:"enableAppsGalleryinMeetingChat",enableCalendarAttachments:"enableCalendarAttachments",enableCalendarCategories:"enableCalendarCategories",enableCalendarCopyLink:"enableCalendarCopyLink",enableCalendarDialogBridge:"enableCalendarDialogBridge",enableCalendarEventGroupChiclet:"enableCalendarEventGroupChiclet",enableCalendarEventsBackgroundSync:"enableCalendarEventsBackgroundSync",enableCalendarSchedulingFormNewPeoplePill:"enableCalendarSchedulingFormNewPeoplePill",enableCalendarSchedulingFormPreReleaseFeatures:"enableCalendarSchedulingFormPreReleaseFeatures",enableCalendarShareLinkDialog:"enableCalendarShareLinkDialog",enableCalendarShareLinkDialogPostMeetingCreation:"enableCalendarShareLinkDialogPostMeetingCreation",enableMeetNowSharePanelInCalendar:"enableMeetNowSharePanelInCalendar",enableCalendarV2ApiService:"enableCalendarV2ApiService",enableCalendarV2EventForwarding:"enableCalendarV2EventForwarding",enableCalendarV2ShowAs:"enableCalendarV2ShowAs",enableCallTranscriptPostMeetingSpeakerAttribution:"enableCallTranscriptPostMeetingSpeakerAttribution",enableCallTranscriptPostMeetingSpeakerAttributionEdit:"enableCallTranscriptPostMeetingSpeakerAttributionEdit",enableFreemiumMeetingInviteWithDate:"enableFreemiumMeetingInviteWithDate",enableGetCalendarEventsFromRest:"enableGetCalendarEventsFromRest",enableMeetingArtifacts:"enableMeetingArtifacts",enableMeetingInfoDropdown:"enableMeetingInfoDropdown",enableMeetingOptionsButton:"enableMeetingOptionsButton",enableMultiWindowCalendarSchedulingForm:"enableMultiWindowCalendarSchedulingForm",enableOnlineAppointment:"enableOnlineAppointment",enableQuickCreateForFreemiumCalendar:"enableQuickCreateForFreemiumCalendar",enableRecordingPostMeeting:"enableRecordingPostMeeting",enableRequireRegistrationInMeetingSchedulingForm:"enableRequireRegistrationInMeetingSchedulingForm",enableRockfallCalendarMeetingSchedulingEnhancements:"enableRockfallCalendarMeetingSchedulingEnhancements",enableSchedulingFormTrackingViewSummary:"enableSchedulingFormTrackingViewSummary",enableSchedulingWebinars:"enableSchedulingWebinars",isConsumerWindow:"isConsumerWindow",meetingOptionsUrl:"meetingOptionsUrl",enableCalendarV2PreReleaseFeatures:"enableCalendarV2PreReleaseFeatures",calendarEventsPollIntervalInMs:"calendarEventsPollIntervalInMs",enableCalendarEventsPrefetchPrevNextWeek:"enableCalendarEventsPrefetchPrevNextWeek",enableGroupEventsInGeneralChannelCalendar:"enableGroupEventsInGeneralChannelCalendar",enableCalendarV2MeetingPrep:"enableCalendarV2MeetingPrep",enableFreemiumAgendaView:"enableFreemiumAgendaView",enableFreemiumCalendarShareViaOutlook:"enableFreemiumCalendarShareViaOutlook",enableFreemiumCalendarShareViaGoogle:"enableFreemiumCalendarShareViaGoogle",freemiumCalendarShareViaOutlookAllowedDomains:"freemiumCalendarShareViaOutlookAllowedDomains",freemiumCalendarShareViaGoogleAllowedDomains:"freemiumCalendarShareViaGoogleAllowedDomains",noOfAttendeesForShowingTrackingViewSummary:"noOfAttendeesForShowingTrackingViewSummary"},h=i("94a755535d135f12850c");i.d(t,"a",function(){return d});var d=function(){function e(e,t){this.settingsService=e,this.policySettingsStoreService=t,this.settingsCache={},this.itProSettings={isBroadcastSchedulingAllowed:!1,isPrivateMeetingSchedulingAllowed:!0,isChannelMeetingSchedulingAllowed:!0},this.settingsByCategoryMap=new Map([[a.a.Metadata,{getSettings:this.getMetadataSettings.bind(this),namespace:r.b}],[a.a.Test,{getSettings:this.getTestSettings.bind(this),namespace:r.b}],[a.a.Auth,{getSettings:this.getAuthSettings.bind(this),namespace:r.b}],[a.a.Telemetry,{getSettings:this.getTelemetrySettings.bind(this),namespace:r.b}],[a.a.Host,{getSettings:this.getHostSettings.bind(this),namespace:r.b}],[a.a.Localization,{getSettings:this.getLocalizationSettings.bind(this),namespace:r.b}],[a.a.Calendar,{getSettings:this.getCalendarSettings.bind(this),namespace:r.b}],[a.a.Platform,{getSettings:this.getPlatformSettings.bind(this),namespace:r.b}],[a.a.ChatList,{getSettings:this.getChatListSettings.bind(this),namespace:r.b}],[a.a.Shortcuts,{getSettings:this.getShortcutsSettings.bind(this),namespace:r.b}],[a.a.WebinarRegistration,{getSettings:this.getWebinarRegistrationSettings.bind(this),namespace:r.b}]])}return e.prototype.get=function(e){return this.getSubject(e).value},e.prototype.getObservable=function(e){return this.getSubject(e).asObservable()},e.prototype.getSubject=function(e){var t=this;if(this.settingsCache[e])return this.settingsCache[e];var i=this.getSettingsForCategory(e),n=i.subscriptionNamespace,r=i.settings,s=new l.a(r||{});this.settingsCache[e]=s;e===a.a.Calendar&&this.policySettingsStoreService&&this.getCalendarITProSettings(s);var o=new c.a("adapter-"+e+"-"+n,function(){var i=t.getSettingsForCategory(e).settings;s.next(i)},n);return this.settingsService.addListener(o),s},e.prototype.getSettingsForCategory=function(e){var t=this.settingsByCategoryMap.get(e),i=e.toString().toLowerCase(),n=t?t.getSettings():this.settingsService.getSettingsForNamespace(i)||{};return{subscriptionNamespace:t?t.namespace:i,settings:n}},e.prototype.getMetadataSettings=function(){var e,t=new p.a(this.settingsService).ring,i=this.settingsService.get(u.a.EnvironmentType,u.a.EnvironmentKey);return t&&(e={id:t.id||"general",friendlyName:t.friendlyName,shortName:t.shortName}),{ring:e,eTag:null==t?void 0:t.eTag,environment:i}},e.prototype.getTestSettings=function(){return{isRunningGlassjar:this.settingsService.getBoolean("isRunningGlassjar"),mtAuthResourceOverride:this.settingsService.getString("skypeAuthEndpointAddressV2"),mtOverrideBaseUrl:this.settingsService.getString("mtOverrideBaseURL")}},e.prototype.getAuthSettings=function(){var e=this.settingsService.get("authConstants");if(e){var t=e.skypeAuthEndpointAddressV2,i=Object(h.isArray)(e.resources)&&e.resources.length>0&&e.resources[0];return{authzEndpointUrl:t,mtResource:i,authzResource:this.settingsService.get("isConsumerWindow")?e.consumerAuthzResource:i}}return{}},e.prototype.getTelemetrySettings=function(){var e,t,i,n,a,r,o=this.settingsService.get("loggingConstants"),c=this.isScenarioMemorySnapshotEnabled();o&&(i=o.telemetryserver,n=null===(e=o.appTokens)||void 0===e?void 0:e.default,a=null===(t=o.appTokens)||void 0===t?void 0:t.userBi,r=!!o.silent&&o.silent,this.settingsService.get(u.a.EnvironmentType,u.a.EnvironmentKey)!==s.a.Prod&&o.appTokens&&o.appTokens.test&&(n=o.appTokens.test,a=o.appTokens.test));return{defaultToken:n,isSilent:r,telemetryServer:i,userBiToken:a,isScenarioMemorySnapshotEnabled:c}},e.prototype.getHostSettings=function(){return{keyboardLayoutLanguage:this.settingsService.getString("keyboardLayoutLanguage")}},e.prototype.getLocalizationSettings=function(){return{enableLocalizedKeyboardShortcuts:this.settingsService.getBoolean("enableLocalizedKeyboardShortcuts")}},e.prototype.getCalendarSettings=function(){var e=this,t=Object(h.mapValues)(g,function(t){return e.settingsService.get(t)}),i=this.itProSettings,a={allowChannelMeetingSchedulingPolicy:i.isChannelMeetingSchedulingAllowed,allowPrivateMeetingSchedulingPolicy:i.isPrivateMeetingSchedulingAllowed,allowBroadcastSchedulingPolicy:i.isBroadcastSchedulingAllowed};return Object(n.__assign)(Object(n.__assign)({},t),a)},e.prototype.getCalendarITProSettings=function(e){var t=this,i=this.policySettingsStoreService.isChannelMeetingSchedulingAllowed(),n=this.policySettingsStoreService.isPrivateMeetingSchedulingAllowed();this.policySettingsStoreService.getBroadcastPolicySettings().then(function(i){t.itProSettings.isBroadcastSchedulingAllowed=i.allowBroadcastScheduling;var n=t.getCalendarSettings();e.next(n)}).catch(function(){}),Promise.all([i,n]).then(function(i){var n=i[0],a=i[1];t.itProSettings.isChannelMeetingSchedulingAllowed=n,t.itProSettings.isPrivateMeetingSchedulingAllowed=a;var r=t.getCalendarSettings();e.next(r)}).catch(function(){t.itProSettings.isChannelMeetingSchedulingAllowed=!1,t.itProSettings.isPrivateMeetingSchedulingAllowed=!1;var i=t.getCalendarSettings();e.next(i)})},e.prototype.getPlatformSettings=function(){return{sessionId:this.settingsService.getString(u.a.SessionIdKey,u.a.PlatformKey)||this.settingsService.getString(u.a.SessionIdKey,u.a.CookiesKey)}},e.prototype.getChatListSettings=function(){return{enableBuddyList:this.settingsService.getBoolean(u.a.EnableBuddyList),hideSelectedChatLeftRailTypingIndicator:this.settingsService.getBoolean(u.a.HideSelectedChatLeftRailTypingIndicator)}},e.prototype.getShortcutsSettings=function(){var e=this.settingsService.get(u.a.ClientType,u.a.PlatformKey)===o.b.Desktop,t=this.settingsService.get(u.a.RingKey);return{applyDesktopKeymappingStrategy:e,enableDevShortcuts:!(!t||t.isPublic)}},e.prototype.isScenarioMemorySnapshotEnabled=function(){return this.settingsService.get(u.a.ClientType,u.a.PlatformKey)===o.b.Desktop&&this.settingsService.getBoolean(u.a.EnableMemoryDumpApi,u.a.DesktopSettingsKey)},e.prototype.getWebinarRegistrationSettings=function(){var e=this.settingsService.get("webinarSettings");return{webinarServiceEndpoint:e.serviceEndpoint,webinarServiceResource:e.serviceResource}},e}()},f9a6412761c79a080418:function(e,t,i){"use strict";var n,a=i("56e93fab5efcffbf24fb"),r=i("e88a8106e72c3f2e7fd4"),s=i("2a5dd11255f151c25fd3"),o=i("e4015b2ea28f962ed7da"),c=function(){function e(t){this.maxQueueLength=t,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:e.QUEUE_CAPACITY}return e.prototype.setQueueCapacity=function(e){e<1||this.queueCapacity===e||(this.queueCapacity=e,this.diagnosticEvents.length>e&&(this.diagnosticEvents=this.diagnosticEvents.slice(this.diagnosticEvents.length-e)))},e.prototype.getEvents=function(){return this.diagnosticEvents},e.prototype.enqueueEvent=function(e){this.diagnosticEvents.length<this.queueCapacity?this.diagnosticEvents.push(e):(this.dequeueEvent(),this.diagnosticEvents.push(e))},e.prototype.enqueueEvents=function(e){var t=this;e&&e.length>0&&e.forEach(function(e){t.enqueueEvent(e)})},e.prototype.flush=function(){this.diagnosticEvents=[]},e.prototype.dequeueEvent=function(){return this.diagnosticEvents.shift()},e.QUEUE_CAPACITY=1e3,e}(),l=i("4044e44e608d1baef794"),p=i("e0ae79cd8630f9b39623"),u=i("64328bb588b46459132d"),g=i("4df2f88bb138194c8ced"),h=function(){function e(t,i,n,a){var r=this;this.opener=t,this.setTimeoutCallback=i,this.clearTimeoutCallback=n,this.diagnosticsEventsBuffer=[],this.report=function(){if(r.diagnosticsEventsBuffer.length>0)try{r.opener.postMessage(g.a.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:Object(u.__spreadArrays)(r.diagnosticsEventsBuffer)})}catch(e){console.error("DiagnosticsBackupService failed to send a message")}r.reset()},this.backupTimeoutMs=a&&a>0?a:e.DefaultBackupTimeoutMs,this.reset()}return e.prototype.pushDiagnosticsEvent=function(t){t&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(t)),this.diagnosticsEventsBuffer.length===e.BufferCapacity&&this.report())},e.prototype.dispose=function(){this.report(),this.stopTimer()},e.prototype.reset=function(){this.diagnosticsEventsBuffer=[],this.stopTimer(),this.startTimer()},e.prototype.stopTimer=function(){this.backupTimer&&(this.clearTimeoutCallback(this.backupTimer),this.backupTimer=void 0)},e.prototype.startTimer=function(){this.backupTimer=this.setTimeoutCallback(this.report,this.backupTimeoutMs)},e.prototype.stringifyEvent=function(e){return Object(p.b)("{0} {1}\t{2}\r\n",[e.timeStamp,e.levelName.slice(0,3),e.message])},e.BufferCapacity=50,e.DefaultBackupTimeoutMs=100,e}(),d=i("94a755535d135f12850c");i.d(t,"a",function(){return f});var m=function(){function e(e){var t=this;this.diagnosticsInstances=new Map,this.diagnosticsBackupEnabled=!1,this.telemetryEvents=new Map,this.diagnosticsEvents=new c,this.scriptStepWhiteList=new Set([o.c.DownloadScripts,o.c.DownloadMainJs]),this.eventWhiteList=new Set([o.b.AppStart,o.b.ChatSendMessage,o.b.RenderChatList,o.b.RenderComposeChat,o.b.RenderShareForm,o.b.SubmitShareForm]),this.environmentDependencies=e,this.storageKey="persistedDiagnostics",this.previousSessionLogsStorageKey="tmp.previousSessionLogs",this.loadPersistedDiagnostics(!0),this.diagnosticsBackupService=void 0,e.addEventListener&&e.addEventListener("unload",function(){t.persistDiagnosticsAsPreviousSessionLogs()})}return e.prototype.updateSettings=function(e){var t=e.get(a.a.Diagnostics),i=t.enableDiagnosticsBackup,n=t.diagnosticsBackupSyncCycleMs,r=t.diagnosticsEventQueueMaxSize;this.setDiagnosticsBackupEnabled(!!i,n||void 0),Object(d.isNumber)(r)&&this.diagnosticsEvents.setQueueCapacity(r)},e.prototype.pushTelemetryEvent=function(t,i){if(this.eventWhiteList.has(i.name)){var n=i&&i.step||"",a=i&&i.elapsed||0;if(this.scriptStepWhiteList.has(n)){var r=e.extractTimeValue(i.stepDelta);this.telemetryEvents.set(n,{delta:r,name:n,telemetryType:t,step:n,elapsed:a})}else{r=e.extractTimeValue(i&&i.delta);this.telemetryEvents.set(i.name,{delta:r,name:i.name,step:n,telemetryType:t,elapsed:a})}}},e.prototype.getTelemetryEvents=function(){return Array.from(this.telemetryEvents.values())},e.prototype.pushDiagnosticsEvent=function(t,i){i.length>e.MAX_MESSAGE_SIZE&&(i=i.substring(0,e.MAX_MESSAGE_SIZE)+e.longMessageEndingPattern);var n={message:i=Object(p.d)(i),level:t,levelName:r.g[t],timeStamp:new Date};this.diagnosticsEvents.enqueueEvent(n),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(n)},e.prototype.getDiagnosticsEvents=function(e){var t=e&&Math.floor(e/(1+this.diagnosticsInstances.size)),i=[];try{i=this.getDiagnosticsInstancesEvents(t)||[]}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to fetch logs from diagnostic instances: "+e)}var n=[];try{if(n=this.diagnosticsEvents.getEvents()||[],e){var a=e-i.length;a>0&&a<n.length&&(n=n.slice(n.length-a))}}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to fetch diagnostic logs: "+e)}return n=n.reverse(),this.mergeSortedLogs(n,i)},e.prototype.flush=function(){this.diagnosticsEvents.flush(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.report()},e.prototype.persistDiagnostics=function(e){this.pushDiagnosticsEvent(r.g.Warn,"Persisting diagnostic events for next load. Key: "+this.storageKey),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.report(),this.environmentDependencies.localStorage.setItem(this.storageKey,JSON.stringify(this.getDiagnosticsEvents(e)))},e.prototype.loadPersistedDiagnostics=function(e){void 0===e&&(e=!0);var t=this.environmentDependencies.localStorage,i=t.getItem(this.storageKey);if(i){var n=void 0;try{n=JSON.parse(i),Array.isArray(n)&&n.length>0&&this.diagnosticsEvents.enqueueEvents(n),e&&t.removeItem(this.storageKey)}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to load persisted logs from store with error: "+e),t.removeItem(this.storageKey)}}},e.prototype.registerDiagnosticsInstance=function(e,t){this.diagnosticsInstances.set(e,t)},e.prototype.unregisterDiagnosticsInstance=function(e){this.diagnosticsInstances.delete(e)},e.prototype.setDiagnosticsBackupEnabled=function(e,t){void 0===e&&(e=!1),this.diagnosticsBackupEnabled=e,e?!this.diagnosticsBackupService&&this.environmentDependencies.opener&&this.environmentDependencies.setTimeout&&this.environmentDependencies.clearTimeout&&(this.diagnosticsBackupService=new h(this.environmentDependencies.opener,this.environmentDependencies.setTimeout,this.environmentDependencies.clearTimeout,t)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)},e.prototype.getDiagnosticsInstancesEvents=function(e){var t,i=this,n=Array.from(this.diagnosticsInstances.keys());return!n||n.length<1?[]:n.reduce(function(n,a){if(!(t=i.diagnosticsInstances.get(a)))return n;try{var s=t.getDiagnosticsEvents()||[];return s=Object(d.orderBy)(s,["timeStamp"],["desc"]),e&&e<s.length&&(s=s.slice(s.length-e)),i.mergeSortedLogs(n,s)}catch(e){return i.pushDiagnosticsEvent(r.g.Error,"Error in collecting diagnostics events from "+a+": "+e),n}},[])},e.extractTimeValue=function(e){return Math.round(parseFloat(e||"0"))},e.prototype.mergeSortedLogs=function(e,t){if(!e||0===e.length)return t;if(!t||0===t.length)return e;for(var i=[],n=0,a=0,r=e.length,s=t.length;n<r&&a<s;)e[n].timeStamp>=t[a].timeStamp?i.push(e[n++]):i.push(t[a++]);for(;n<r;)i.push(e[n++]);for(;a<s;)i.push(t[a++]);return i},e.prototype.persistDiagnosticsAsPreviousSessionLogs=function(){var e=this.getDiagnosticsEvents().reverse(),t=this.formatEvents(e);this.environmentDependencies.localStorage.setItem(this.previousSessionLogsStorageKey,t)},e.prototype.formatEvents=function(e){if(0===e.length)return"";var t="";return e.forEach(function(e){var i=e.timeStamp.toISOString(),n=e.levelName.substring(0,3);t+=i+" "+n+"\t"+e.message+"\r\n"}),Object(p.d)(t)},e.MAX_MESSAGE_SIZE=512,e.longMessageEndingPattern="...",e}(),f=function(){if(!n){var e=void 0;try{e=Object(l.a)()}catch(i){e={getHostedWindowContext:function(){return{panelContext:s.a.worker,startReason:s.b.userInitiated}},localStorage:{getItem:function(e){var i=t.get(e);return void 0===i?null:i},clear:function(){return t.clear()},key:function(e){return Array.from(t.keys())[e]},length:(t=new Map).size,removeItem:function(e){return t.delete(e)},setItem:function(e,i){return t.set(e,i)}}}}n=new m(e)}var t;return n}}}]);