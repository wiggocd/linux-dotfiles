webpackJsonp([19],{2186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2187)},2187:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2188),c=n(85),u=n(302),l=n(2189),f=n(2190),d=n(2192),p=n(2196),h=function(e){function t(t,n,r,i,a,o,s,c,u,l,f,d){var p=e.call(this,c)||this;return p.constants=t,p.utilityService=n,p.settingsService=r,p.authenticationService=i,p.sxConfig=a,p.localizationService=o,p.eventingService=s,p.loggingService=u,p.logger=l,p.actionCallbacks=f,p.dataCallbacks=d,p.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(p.getTheme(e))},p.initializeOnAppLaunchAndReinit("First Initialize"),p}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)})},t.prototype.initializeLPC=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,c,u,l,f,d,p,h,g,v;return o(this,function(o){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,a=this.settingsService.isInternalRing(),c=this.authenticationService.getUserTypeInTenant(),u=this.sxConfig.getCurrentSkypeMri(),l=c===teamspace.services.UserTypeInTenant.Guest,f=a&&!l?"df":"",d=this.getTeamsConfig(t,n,f),p=this.settingsService.getRing(),this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return h=p&&p.id?p.id:void 0,g=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},d),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:h,hostAppVersion:g,options:{hostAppRing:h,hostAppVersion:g,isLoggedInAsTeamsGuestUser:l},loggedInUserTeamsMri:u})),this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:f,userTypeInTenant:c})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:f,userTypeInTenant:c}),n}),[2,this.lpcPromise]}catch(n){throw v="Could not load live persona card: "+n,e.fail({message:v,clientCorrelationId:t,lpcRegion:f,userTypeInTenant:c}),new Error(v)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,a=t.ariaLabel,o=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,l=t.clientScenario,f=t.isSharedChannel,d=t.hostTenantId,p=t.hostConversationId;{if(this.isLivePersonaCardInitialized){var h=u.determineLPCPersonaType(n.role,n.type),g=u.getCleanUpn(n.userPrincipalName),v={personaInfo:{identifiers:{PersonaType:h,AadObjectId:n.objectId,TeamsMri:n.mri,HostAppPersonaId:u.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:f,hostTenantId:d,hostConversationId:p}),Upn:g,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:a,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:o,clientScenario:l};this.attachHoverTargetAsync(e,v);var m=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){m()}}}this.logger.error("Not initialized")}},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Dark:case c.LpcTheme.DarkV2:return d.darkTheme;case c.LpcTheme.HighContrast:return d.highContrastTheme;case c.LpcTheme.Default:case c.LpcTheme.DefaultV2:default:return d.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n){var r=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return a(t,void 0,void 0,function(){var t,i,a,s,c,u;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,a=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(a),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=o.sent())?n(c,e):r("Error retrieving auth token",e),[3,3];case 2:return u=o.sent(),this.logger.error("Error acquiring access token for LOKI"),r("Error retrieving auth token",e),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=h,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","sxConfig",function(e,t,n,r,i,a,o,s,c,u,d,g,v,m,y,b,S,C,P,T,k,w,A,L,O,I,x,M,U){var _=a.newLogger("LivePersonaCardService"),E=new p.LpcTelemetryHelper(x,a,u),D=E.logPanelActionEvent.bind(E),R=o.getUserTypeInTenant(),F=l.LPCActionCallbackFactory(s,e,_,m,u,c,b,v,M,y,D),j=f.LPCDataCallbackFactory(_,u,S,m,r,C,P,i,e,T,k,w,A,L,d,O,M,t,n,R,U);return new h(e,r,i,o,U,d,g,I,a,_,F,j)}])},2188:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,u=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"feed-bootstrapper",2:"topic-card-bootstrapper",3:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{0:"c07844ee995b75b027c0",2:"b2583c09f988cbab4e8b",3:"7c361ca8b46eea452880"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://lpcres.delve.office.com/lpc/versionless/",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;return n(n.s=11)}([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i}},function(e,t,n){"use strict";var r;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"}(r||(r={}));var i=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";function r(e){var t=e.targetWindow||window,n=u.get(t);return n||(n={bootstrapperConfig:c(c({},e),{targetWindow:t}),ariaLogger:new s(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshInitializationTimeout:void 0}),u.set(t,n),n}function i(e){var t=u.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.OfficeFeed,delete n.OfficeFeedStrings,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}u.delete(e)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},s=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return a(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return a(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return a(this,void 0,void 0,function(){var t,n,r;return o(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20200825.12.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return a(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlAsync=function(){return a(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:switch(e=t.sent(),this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,e.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,e.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,e.AWT_COLLECTOR_URL_USGOV_DOD];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]}})})},e.prototype.noOp=function(){},e}(),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=new Map},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,s){e?(r(o,e,n),i(e)):t(function(e,t){e?(r(o,e,n),i(e)):s(new a.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){var n=function(e){return/^AADSTS\d+?:/.test(e)}(e)?e:"";s(new a.a("GetAuthTokenError",n,t))})})}n.d(t,"a",function(){return i});var a=n(0),o="LokiAuthToken"},function(e,t,n){"use strict";function r(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=3e5},function(e,t,n){"use strict";function r(e,t){var n=this,r=0,a=function(e,t){return o(n,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,i(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),r<c?(r++,[4,a(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return a(e,t)}function i(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new a.a("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}n.d(t,"a",function(){return r});var a=n(0),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},s=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},c=2},function(e,t,n){"use strict";function r(e){switch(e.complianceEnvironment){case"Blackforest":return a;case"GccHigh":return o;case"DoD":return s;case"Gallatin":return c;case"GccModerate":case"Prod":default:return i}}n.d(t,"a",function(){return r});var i="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",a="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",o="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",s="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",c="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998"},function(e,t,n){"use strict";function r(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e,t){var n=function(e){return"df"===e?c.Dogfood:"msit"===e?c.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Blackforest":return c.Blackforest;case"GccModerate":return c.GccModerate;case"GccHigh":return c.GccHigh;case"DoD":return c.DOD;case"Gallatin":return c.Gallatin;case"Prod":return c.TopLevel;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}(t)),n}function i(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function a(e,t,n){return s(function(e,t){var n=t||e.culture,i=r(e.region,e.complianceEnvironment);return u.replace("{0}",i).replace("{1}",n)}(t,i(v,n)),e,p(p({},t),{clientFeature:"LivePersonaCard"}),n)}function o(e,t,n){return s(function(e,t){var n=t||e.culture,i=r(e.region,e.complianceEnvironment);return l.replace("{0}",i).replace("{1}",n)}(t,i(v,n)),e,p(p({},t),{clientFeature:"OfficeFeed"}),n)}function s(e,t,n,r){return new Promise(function(a,o){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("authToken",t),s.setRequestHeader("Accept","application/json");var c=d.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientType",n.clientType),s.setRequestHeader("X-ClientFeature",n.clientFeature),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var u=i(m,r)||i(g,r);u&&(s.setRequestHeader(g,u),s.setRequestHeader(m,u));var l=i(y,r);l&&s.setRequestHeader(y,l),s.addEventListener("load",function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",a(e)}catch(e){o(new f.a("GetLokiConfigError","Failed to parse initialization config.",c))}else o(new f.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,s.status))}),s.addEventListener("error",function(){o(new f.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),s.addEventListener("timeout",function(){o(new f.a("GetLokiConfigError","Loki config request timed out after "+h+" ms.",c))}),s.timeout=h,s.send()})}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var c;!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com"}(c||(c={}));var u="{0}/api/v1/livepersonacard/configuration?cultureName={1}",l="{0}/api/v1/officefeed/configuration?cultureName={1}&returnResources=true",f=n(0),d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},h=6e4,g="LivePersonaCardVersionOverride",v="LivePersonaCardCultureOverride",m="MidgardVersion",y="MidgardBranch"},function(e,t,n){"use strict";function r(e){return void 0===e||"string"!=typeof e||""===e||null===e}function i(e){return void 0===e||"function"!=typeof e}function a(e){var t="";if(e){var n=[];r(e.culture)&&n.push("culture"),r(e.clientType)&&n.push("clientType"),r(e.clientContextType)&&n.push("clientContextType"),r(e.clientCorrelationId)&&n.push("clientCorrelationId"),i(e.logMessage)&&n.push("logMessage"),i(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===s.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+s.join(", ")+" for pre-production environments. "),-1===c.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+c.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new o.a("ValidateBootstrapperConfigError",t)}n.d(t,"a",function(){return a});var o=n(0),s=["msit","df","ppe"],c=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin"]},function(e,t,n){"use strict";function r(e,t,n){return m(this,void 0,void 0,function(){var r,a;return y(this,function(o){switch(o.label){case 0:return(a=Object(v.b)(t)).lpcConfig?(r=a.lpcConfig,[3,3]):[3,1];case 1:return[4,i(e,t,n)];case 2:r=o.sent(),a.lpcConfig=r,o.label=3;case 3:return[2,r]}})})}function i(e,t,n){return m(this,void 0,void 0,function(){var r,a;return y(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,Object(g.a)(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,Object(h.a)(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return S<b?(S++,[4,i(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=S,a;case 7:return[3,8];case 8:return[2,r]}})})}function a(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[k],i=e.Resources[P];"OwaPeopleHub"===e.Workload&&(i=e.Resources[T]),n=[r,i]}return Promise.all(n.map(function(e){return Object(C.a)(e,t)})).then(function(){return n})}function o(e,t){var n=t.targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new w.a("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new w.a("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var a=function(e,t){var n=t.targetWindow;return{refreshAuthToken:s(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(a),r()}catch(e){i(new w.a("StartLivePersonaCardError",e.name))}},0)})}function s(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n,void 0)},function(e,n){t("",e,n,void 0)})}}function c(e){return U(this,void 0,void 0,function(){var t,n,i,s,c=this;return _(this,function(u){return t=Object(v.b)(e),n=function(){return Object(v.b)(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(i=t.bootstrapperConfig.targetWindow,s=new I.a(i),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(u,l){return U(c,void 0,void 0,function(){var c,f,d,p,g,v;return _(this,function(m){switch(m.label){case 0:c=Object(A.a)(e),m.label=1;case 1:return m.trys.push([1,7,,8]),Object(x.a)(e),s.startCustomTiming(I.b.getAuthToken),[4,Object(h.a)(e.authToken,e.getAuthToken,i)];case 2:return f=m.sent(),s.endCustomTiming(I.b.getAuthToken),s.measureFromStart(I.b.getAuthTokenFromStart),s.startCustomTiming(I.b.getLokiConfig),[4,r(f,e,i)];case 3:return d=m.sent(),s.endCustomTiming(I.b.getLokiConfig),s.measureFromStart(I.b.getLokiConfigFromStart),s.startCustomTiming(I.b.getLpcBundles),[4,a(d,i)];case 4:return m.sent(),s.endCustomTiming(I.b.getLpcBundles),s.measureFromStart(I.b.getLpcBundlesFromStart),s.startCustomTiming(I.b.startLpc),[4,o(d,t.bootstrapperConfig)];case 5:return m.sent(),s.endCustomTiming(I.b.startLpc),s.measureFromStart(I.b.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(d,c).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return m.sent(),(p=Object(O.a)(s.getAllTimings())).RootCorrelationId=d.RootCorrelationId,p.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:p},c),u(),[3,8];case 7:return g=m.sent(),v=Object(O.a)(s.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:M(M(M({},Object(L.a)(g)),v),{isConsumer:e.isConsumer})},c),l("Failed to initialize Live Persona Card: "+g.name+" "+g.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},p.a)}),[2,t.initializationPromise])})})}function u(e){Object(v.a)(e)}function l(e){return U(this,void 0,void 0,function(){var t;return _(this,function(n){switch(n.label){case 0:return t=Object(v.b)(e),[4,Object(h.a)(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,r(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}function f(e){return U(this,void 0,void 0,function(){var t;return _(this,function(r){return t=Object(v.b)(e),[2,n.e(2).then(n.bind(null,45)).then(function(e){return(0,e.initializeTopicCardAsync)(t.bootstrapperConfig)})]})})}function d(e){return U(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,n.e(0).then(n.bind(null,44))];case 1:return[2,(0,t.sent().initializeOfficeFeedAsync)(e)]}})})}n.r(t),n.d(t,"initializeLivePersonaCardAsync",function(){return c}),n.d(t,"freeBootstrapperMemory",function(){return u}),n.d(t,"fetchLokiConfigAsync",function(){return l}),n.d(t,"lazyInitializeTopicCardAsync",function(){return f}),n.d(t,"lazyInitializeOfficeFeedAsync",function(){return d});var p=n(5),h=n(3),g=n(9),v=n(2),m=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},y=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},b=2,S=0,C=n(6),P="livepersonacard_with-react",T="livepersonacard_without-react",k="livepersonacardstrings",w=n(0),A=n(7),L=n(8),O=n(4),I=n(1),x=n(10),M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},U=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},_=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};try{var E=window.document.createElement("link"),D=Boolean("onmscontentzoom"in window.document);E.rel=D?"dns-prefetch":"preconnect",E.href="https://lpcres.delve.office.com/",window.document.head.appendChild(E)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}}])})},2189:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=n(85),o=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},s=function(e,t){return function(n,a){return void 0===a&&(a=!1),r(void 0,void 0,void 0,function(){var r;return i(this,function(i){return(r=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:r.id,withVideo:a,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},c=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var a=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:a,externalId:null,draftObjectId:null,inlineImages:null})}},u=function(e,t,n,o,s,c){return function(u,l){var f=u.persona;return r(void 0,void 0,void 0,function(){var r,u,d,p,h,g;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),r=n.getFreshnessInMs(),u=e.scenarios.people.livePersonaCardStartChat,[4,n.getAllPeopleProfile([f.TeamsMri],u,!1,!1,r)];case 1:return d=i.sent()[0],p=o.getPrivateChatUserMri(d,u),[4,s({groupName:d.displayName,peopleSlug:p,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),l(!0),c(a.LpcCallbackTelemetryType.chatAction,f.TeamsMri),[3,4];case 3:return h=i.sent(),g="Failed to navigate to chat",t.error(g),l(!1,g),[3,4];case 4:return[2]}})})}},l=function(e,t,n,o,s,c){return function(o,u){return r(void 0,void 0,void 0,function(){var r,l,f,d,p;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),r=n.getFreshnessInMs(),l=e.scenarios.people.livePersonaCardOrgChart,[4,n.getAllPeopleProfile([o.TeamsMri],l,!1,!1,r)];case 1:return f=i.sent()[0],[4,s({groupName:f.displayName,slug:o.TeamsMri,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),u(!0),c(a.LpcCallbackTelemetryType.orgChartAction,o.TeamsMri),[3,4];case 3:return d=i.sent(),p="Failed to navigate to org chat",t.error(p),u(!1,p),[3,4];case 4:return[2]}})})}},f=function(e,t,n){return function(o,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(o.TeamsMri)];case 1:return i.sent(),s(!0),n(a.LpcCallbackTelemetryType.audioCallAction,o.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},d=function(e,t,n){return function(o,s){return r(void 0,void 0,void 0,function(){var r,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(o.TeamsMri,!0)];case 1:return i.sent(),s(!0),n(a.LpcCallbackTelemetryType.videoCallAction,o.TeamsMri),[3,3];case 2:return r=i.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},p=function(e,t,n){return function(o,s,c){return r(void 0,void 0,void 0,function(){var r,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",s&&s.length),[4,t(o.TeamsMri,s)];case 1:return i.sent(),c(!0),n(a.LpcCallbackTelemetryType.quickMessageAction,o.TeamsMri),[3,3];case 2:return r=i.sent(),u="Failed to send message",e.error(u),c(!1,u),[3,3];case 3:return[2]}})})}},h=function(e,t,n,o){return function(s,c){return r(void 0,void 0,void 0,function(){var r,u,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Blocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!1,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.addBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),o(a.LpcCallbackTelemetryType.quickMessageAction,s.TeamsMri),[3,6];case 5:return u=i.sent(),l="Failed to block contact",e.error(l),c(!1,l),[3,6];case 6:return[2]}})})}},g=function(e,t,n,o){return function(s,c){return r(void 0,void 0,void 0,function(){var r,u,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e.info("LPC::Unblocking contact"),(r=t.getChatConversationWith(s.TeamsMri))?[4,t.acceptBlockSfCChat(r.id,!0,"LivePersonaCard")]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,n.deleteBlockedMri(s.TeamsMri,"LivePersonaCard")];case 3:i.sent(),i.label=4;case 4:return c(!0),o(a.LpcCallbackTelemetryType.quickMessageAction,s.TeamsMri),[3,6];case 5:return u=i.sent(),l="Failed to unblock contact",e.error(l),c(!1,l),[3,6];case 6:return[2]}})})}},v=function(e,t,n,o,s){return function(c,u){return r(void 0,void 0,void 0,function(){var r,l,f,d;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,o.getMeMSAProfile("lpc-edit-profile-callback",!1)];case 1:return r=i.sent(),l=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[l],user:r,isMSAEditNameClick:!0}),u(!0),s(a.LpcCallbackTelemetryType.editMeProfileAction,c.TeamsMri),[3,3];case 2:return f=i.sent(),d="Failed to edit me user profile",e.error(d),u(!1,d),[3,3];case 3:return[2]}})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,a,m,y,b,S,C){var P=o(t,e,a),T=s(i,m),k=c(i,y);return{startChat:u(t,n,r,i,P,C),showOrgChart:l(t,n,r,0,P,C),sendQuickMessage:p(n,k,C),startVideoCall:d(n,T,C),startAudioCall:f(n,T,C),blockContact:h(n,i,b,C),unblockContact:g(n,i,b,C),editMeProfile:v(n,S,t,r,C)}}},2190:function(e,t,n){"use strict";function r(e,t){var n=this;return function(r,i,a){return s(n,void 0,void 0,function(){var n,i,o,s;return c(this,function(c){switch(c.label){case 0:n=r.TeamsMri||r.Smtp||r.Upn,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,e.getOrgChart(n)];case 2:return(i=c.sent())?(o=f.getDirectReportsAndManager(i.value),a(o,void 0)):(t.error("No orgChart returned"),a(void 0,"No orgChart returned")),[3,4];case 3:return s=c.sent(),t.error("getOrgChart failed in LPC data callback"),a(void 0,"Exception in orgChart call"),[3,4];case 4:return[2]}})})}}function i(e,t,n){var r=this;return function(i,a,o){return s(r,void 0,void 0,function(){var r,a,s,u,f,d,p,h,g,v,m,y,b;return c(this,function(c){switch(c.label){case 0:r=i.TeamsMri||i.Smtp||i.Upn,c.label=1;case 1:return c.trys.push([1,6,,7]),a=l.deserializeHostAppPersonaId(i.HostAppPersonaId),s=a.isSharedChannel,u=a.hostTenantId,f=a.hostConversationId,d=void 0,s?[4,e.getAllPeopleProfileForConversation([r],f,!1,"lpc-sc-data-callback",void 0,s,u)]:[3,3];case 2:return d=c.sent(),[3,5];case 3:return[4,e.getAllPeopleProfile([r],"lpc-data-callback",!Boolean(i.TeamsMri))];case 4:d=c.sent(),c.label=5;case 5:return(p=d[0])?(h=p,g=n.getCurrentSkypeMri(),v=g===i.TeamsMri,m=l.determineCardTypeForTargetUser(h.role,h.type,v),y=A(m,h),o(y,void 0)):(t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),o(void 0,"No profile returned")),[3,7];case 6:return b=c.sent(),t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),o(void 0,"Exception in profile call"),[3,7];case 7:return[2]}})})}}function a(e,t){var n=this;return function(r,i){return s(n,void 0,void 0,function(){var n,a,o,s,u,d,p,h,g,v,m;return c(this,function(c){switch(c.label){case 0:n=r.TeamsMri||r.Smtp||r.Upn,c.label=1;case 1:return c.trys.push([1,6,,7]),a=l.deserializeHostAppPersonaId(r.HostAppPersonaId),o=a.isSharedChannel,s=a.hostTenantId,u=a.hostConversationId,d=void 0,o?[4,e.getAllPeopleProfileForConversation([n],u,!1,"lpc-sc-data-callback",void 0,o,s)]:[3,3];case 2:return d=c.sent(),[3,5];case 3:return[4,e.getAllPeopleProfile([n],"lpc-data-callback",!Boolean(r.TeamsMri))];case 4:d=c.sent(),c.label=5;case 5:return(p=d[0])?(h=p,g=o&&!!h.xtapUser,v={hostAppPersonaId:r.HostAppPersonaId,aadObjectId:h.objectId,email:{Address:h.email},upn:h.userPrincipalName,userType:l.determineLPCPersonaType(h.role,h.type),displayName:h.displayName,firstName:h.givenName,lastName:h.surname,skypeId:h.skypeId,teamsMri:r.TeamsMri||h.mri,jobTitle:h.jobTitle,department:g?h.companyName:h.department,officeLocation:h.userLocation,phoneNumbersAndUrls:f.getPhoneNumbers(h)},i(v,void 0)):(t.error("getAllPeopleProfile returned no profile in LPC data callback"),i(void 0,"No profile returned")),[3,7];case 6:return m=c.sent(),t.error("getAllPeopleProfile failed in LPC data callback"),i(void 0,"Exception in profile call"),[3,7];case 7:return[2]}})})}}var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=n(85),l=n(302),f=n(2191);t.unescapeHtmlEntities=function(e){if(!e)return e;var t=document.createElement("textarea");return t.innerHTML=e,t.value};var d=function(e,t,n,r){return function(i,a){return s(void 0,void 0,void 0,function(){var s,u,f,d,p,h,g,v,m;return c(this,function(c){switch(c.label){case 0:if(s=l.deserializeHostAppPersonaId(i.HostAppPersonaId),u=s.isSharedChannel,f=s.hostTenantId,d=s.hostConversationId,p={mri:i.TeamsMri,principalName:i.Upn||i.Smtp||i.TeamsMri,displayName:i.DisplayName||"",size:n.profilePictureSizes.medium},i.DisplayName)return[3,7];h=i.TeamsMri||i.Smtp||i.Upn,c.label=1;case 1:return c.trys.push([1,6,,7]),g=void 0,u?[4,r.getAllPeopleProfileForConversation([h],d,!0,"lpc-sc-image-data-callback",void 0,u,f)]:[3,3];case 2:return g=c.sent(),[3,5];case 3:return[4,r.getAllShortPeopleProfile([h],"lpc-image-data-callback",!Boolean(i.TeamsMri))];case 4:g=c.sent(),c.label=5;case 5:return(v=g[0])&&(p=o(o({},p),{displayName:v.displayName})),[3,7];case 6:return m=c.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,7];case 7:return u&&(p=o(o({},p),{isSharedChannel:u,hostTenantId:f,conversationId:d})),t.loadImage(p,!1,!1,!1,"lpc-data-callbacks").then(function(e){var t=e&&e.imgUrl||"";a(t,{})}).catch(function(e){a(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n){var r=t.findConversationWith(n);if(r&&r.isSfC())return r.InteropConversationStatus()===e.interopConversationStatus.blocked?u.PersonaPresence.blocked:u.PersonaPresence.none};var p=function(e,n,r,i,a,o){var s=t.getSkypeConsumerChatStatus(r,i,o);if(void 0!==s)return s;if(a.isBlockedContact(o))return u.PersonaPresence.blocked;var c=e.status,l=e.flwPresence;if(n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(l===SkypeX.Services.UserFlwPresence.OffShift)return u.PersonaPresence.offline;if(l===SkypeX.Services.UserFlwPresence.OnShift)switch(c){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return u.PersonaPresence.busy;default:return u.PersonaPresence.online}}switch(c){case SkypeX.Services.UserStatus.Online:return u.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return u.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return u.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return u.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return u.PersonaPresence.dnd;default:return u.PersonaPresence.offline}},h=function(e,t,n,r,i,a,o){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),u=c.length>0?c[c.length-1]:null;u&&(t=a.instant(o.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:u}))}return a.instant(o.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},g=function(e,t,n,r,i,a,o,s,c){var u=e.status,l=e.calendarData,f=e.lastSeenAt,d=e.flwPresence,p=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(d===SkypeX.Services.UserFlwPresence.OnShift){var g=void 0,v=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(p);switch(m&&m.currentShift&&(g=c.getDate(new Date(m.currentShift.endTime),"shortTime"),v=m.currentShift.teamOlsonCode),u){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(u),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return h(y,g,v,s,c,r,a);default:var b=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return h(b,g,v,s,c,r,a)}}}var S=f&&(new Date).getTime()-f.getTime()<=i.timeInMiliseconds.year;if(l&&l.isOutOfOffice)switch(u){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(u),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?o.transformIntoTimeago(f):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(u){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?o.transformIntoTimeago(f):n.GetTranslatedStatusText(u);default:return n.GetTranslatedStatusText(u)}},v=function(e,t,n,r,i){var a="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(a=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),a},m=function(e,t,n,r,i,a){var o={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var u=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(u)}if(s){var l=r.stripHtml(i.sanitizeHtml(s)).trim(),f=v(e,0,0,r,i);l.length&&!f.length&&(o.message=l)}}return o.message&&o.publishTime?o:void 0},y=function(e,n,r,i){var a=[],o=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=JSON.parse(e.decodeHtml(i.attribs["data-itemprops"])).mri;a.push({text:t.unescapeHtmlEntities(s),hostAppPersonaId:c,mri:c})}else"text"===i.type?a.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i)),hostAppPersonaId:void 0}):"br"===i.name?a.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&o(i.children)})};return o(i),a},b=function(e,t,n,r,i,a){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var o={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var u=i.sanitizeHtml(s).trim(),l=window.htmlparser2,f=l.parseDOM("<div>"+u+"</div>"),d=y(r,n,l,f);o.message=d}if(c&&c.trim()){var p=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(p)}return o.message.length&&o.publishTime?o:void 0}},S=function(e,t,n,r,i,a,o,s,c,u,l,f,d,h){return function(y,S){var C=e.getPresence(y,S);return{presence:p(C,i,a,d,h,y),isOutOfOffice:C&&!!C.calendarData&&!!C.calendarData.isOutOfOffice,oofMessage:C&&v(C,0,0,t,n),presenceText:C&&g(C,i,o,s,a,c,u,l,f),statusNote:C&&m(C,0,0,t,n,r),statusNoteV2:C&&b(C,i,a,t,n,r)}}},C=function(e){return function(t){var n=e.findConversationWith(t);return n&&n.isInteropChat()?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS}},P=function(e,t,n,r,i,a,o,s,c,u,l,f,d,p){return function(h,g){var v=C(e);g(S(t,n,r,i,a,o,s,c,u,l,f,d,e,p)(h.TeamsMri,v(h.TeamsMri)),void 0)}},T=function(e,t,n,r,i,a,o){return function(u){return s(void 0,void 0,void 0,function(){var s,f,d,p,h,g,v,m,y,b,S,C,P,T,k,w,A,L;return c(this,function(c){switch(c.label){case 0:if(s={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1},f=o.isBlockedContact(u.TeamsMri))return[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0}];d=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),s.disableCall=!d,s.disableVideo=!d,p=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),c.label=1;case 1:return c.trys.push([1,6,,7]),h=l.deserializeHostAppPersonaId(u.HostAppPersonaId),g=h.isSharedChannel,v=h.hostTenantId,m=h.hostConversationId,y=void 0,g?[4,n.getAllPeopleProfileForConversation([u.TeamsMri],m,!1,"lpc-sc-header-action-callback",void 0,g,v)]:[3,3];case 2:return y=c.sent(),[3,5];case 3:return[4,n.getAllPeopleProfile([u.TeamsMri],"lpc-header-action-callback",!u.TeamsMri)];case 4:y=c.sent(),c.label=5;case 5:return(b=y[0])&&(S=b.featureSettings,C=b.type,P=b.userType,T=S&&S.isPrivateChatEnabled,k=C&&C.toLowerCase()===i.userTypes.person.toLowerCase(),w=P&&P.toLowerCase()===i.userTypes.guest.toLowerCase(),A=a===teamspace.services.UserTypeInTenant.Guest,s.disableChat=!1===T||!p,s.disableOrg=!(k&&!w)||A),[3,7];case 6:return L=c.sent(),r.error("Failed to fetch persona profile in LPC data callbacks"),[3,7];case 7:return[2,s]}})})}},k=function(e,t){return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:f.getPhoneNumber(t),userPrincipalName:t.userPrincipalName,email:t.email,imAddress:t.skypeId}}}},w=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},A=function(e,t){return"NotResolved"===e?w(e,t.email):k(e,t)};t.makeGetHeaderInfoAndCardTypeCallback=i,t.GetPresenceSourceFunction=C,t.GetRichPresenceFunction=S,t.LPCDataCallbackFactory=function(e,t,n,o,s,c,u,l,f,p,h,g,v,m,y,b,S,C,k,w,A){return{getAndPrefetchPersonaImageUri:d(e,b,f,o),getRichPresence:P(t,n,s,c,u,l,f,p,h,g,v,m,y,S),getHeaderActionsPolicyAsync:T(C,k,o,e,f,w,S),getPersonaInfo:a(o,e),getOrgChart:r(o,e),getHeaderInfoAndCardType:i(o,e,A)}}},2191:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getPhoneNumbers=function(e){var t=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return t.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&t.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),t},t.getPhoneNumber=function(e){if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var t=e.phones[0];return{number:t.number,type:t.type,url:"tel:"+t.number}}}},2192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2193);t.defaultTheme=r.defaultTheme;var i=n(2194);t.darkTheme=i.darkTheme;var a=n(2195);t.highContrastTheme=a.highContrastTheme},2193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},2194:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},2195:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",a={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r};t.highContrastTheme={palette:a}},2196:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,a=teamspace.components.PanelActionScenario,o=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,u=teamspace.components.WorkLoad,l=teamspace.components.SubWorkLoad,f=n(85),d=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsService=n}return e.prototype.logPanelActionEvent=function(e,t){var n,d,p,h,g,v,m=this,y=c.people,b=i.nav,S=i.nav,C=o.people,P=teamspace.PanelRegion.popover,T=u.chatContent,k=l.composeMsg;switch(e){case f.LpcCallbackTelemetryType.audioCallAction:d=r.click,p=a.navCalling,h=s.lpcAudioCall,n="AudioCallLpc";break;case f.LpcCallbackTelemetryType.chatAction:d=r.click,p=a.navChat,h=s.lpcStartChat,n="ChatLpc";break;case f.LpcCallbackTelemetryType.orgChartAction:d=r.click,p=a.orgChart,h=s.lpcOrgChart,n="OrgChartLpc";break;case f.LpcCallbackTelemetryType.quickMessageAction:d=r.click,b=i.submit,S=i.submit,p=a.quickIM,h=s.lpcQuickIM,g=s.sendButton,v=c.compose,n="QuickIMLpc";break;case f.LpcCallbackTelemetryType.videoCallAction:d=r.click,p=a.navCalling,h=s.lpcVideoCall,n="VideoCallLpc";break;default:return}var w={action:{gesture:d,outcome:b,outcomeNew:S,scenario:p?teamspace.shared.AttributeHelper.tryGetEnum(p.toString(),a,this.loggingService):null,scenarioType:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),o,this.loggingService):null,workLoad:teamspace.shared.AttributeHelper.tryGetEnum(T.toString(),u,this.loggingService),subWorkLoad:teamspace.shared.AttributeHelper.tryGetEnum(k.toString(),l,this.loggingService)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(h.toString(),s,this.loggingService),nameNew:teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),s,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),c,this.loggingService),typeNew:teamspace.shared.AttributeHelper.tryGetEnum(v.toString(),c,this.loggingService),summary:n},targetThread:this.getTargetThread(t)};this.analyticsService.getAnalyticsPanelActionEventData(w,P).then(function(e){m.analyticsService.sendPanelAction(e)})},e.prototype.getTargetThread=function(e){if(!e)return null;var t=this.conversationsService.getConversation(e);return{id:e,type:t&&t.conversationType||"OneOnOneChat"}},e}();t.LpcTelemetryHelper=d},302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n){if(n)return"Me";switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId}}},85:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.audioCallAction=0]="audioCallAction",e[e.chatAction=1]="chatAction",e[e.editMeProfileAction=2]="editMeProfileAction",e[e.orgChartAction=3]="orgChartAction",e[e.quickMessageAction=4]="quickMessageAction",e[e.videoCallAction=5]="videoCallAction",e[e.personImageCallback=6]="personImageCallback",e[e.richPresenceCallback=7]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[2186]);